% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/travel-time.R
\name{compute_travel_times}
\alias{compute_travel_times}
\title{Compute a travel-time matrix from census tract representative points to source points}
\usage{
compute_travel_times(
  tracts_sf,
  points_sf,
  network_path,
  tract_id = "id",
  point_id = "id",
  point_method = "point_on_surface",
  pop_raster = NULL,
  pop_min_area = 1,
  mode = "WALK",
  max_trip_duration = 300L,
  fill_missing = max_trip_duration,
  n_threads = 4L,
  departure_datetime = NULL,
  verbose = TRUE
)
}
\arguments{
\item{tracts_sf}{An \code{sf} object with polygon geometries. Target census
tracts.}

\item{points_sf}{An \code{sf} object with point geometries. Source points.}

\item{network_path}{Character. Path to the directory containing the
OSM \code{.pbf} file for building the r5r network.}

\item{tract_id}{Character. Name of the ID column in \code{tracts_sf}.
Default: \code{"id"}.}

\item{point_id}{Character. Name of the ID column in \code{points_sf}.
Default: \code{"id"}.}

\item{point_method}{Character. Method for computing representative points
for census tracts. One of \code{"point_on_surface"} (default),
\code{"centroid"}, or \code{"pop_weighted"}. See \code{\link[=compute_representative_points]{compute_representative_points()}}
for details.}

\item{pop_raster}{A \link[terra:SpatRaster-class]{terra::SpatRaster} object, a file path to a GeoTIFF,
or \code{NULL}. Population density raster for \code{point_method = "pop_weighted"}.
If \code{NULL}, WorldPop data is auto-downloaded. Ignored for other methods.}

\item{pop_min_area}{Numeric. Minimum tract area in kmÂ² for applying the
population-weighted method. Default: 1.}

\item{mode}{Character. Routing mode. Default: \code{"WALK"}.}

\item{max_trip_duration}{Integer. Maximum trip duration in minutes.
Default: 300.}

\item{fill_missing}{Numeric. Value to fill for unreachable
origin-destination pairs. Default: same as \code{max_trip_duration}.}

\item{n_threads}{Integer. Number of r5r routing threads. Default: 4.}

\item{departure_datetime}{POSIXct or NULL. Departure time for
transit-based routing. Required when \code{mode} includes transit
components. Default: NULL (ignored for WALK/BICYCLE modes).}

\item{verbose}{Logical. Default: TRUE.}
}
\value{
A numeric matrix [n_tracts x n_points]. Travel times in minutes.
Row names = census tract IDs, column names = point IDs. Unreachable
pairs are filled with \code{fill_missing}.
}
\description{
Builds a travel-time matrix using the r5r routing engine. Computes
travel times from representative points of target census tracts
to geolocated source points (e.g., polling locations).
}
\details{
Requires the \code{r5r} and \code{sf} packages. r5r requires exactly Java/JDK 21.
Use \code{\link[=download_r5r_data]{download_r5r_data()}} to obtain the OSM data needed for \code{network_path}.
}
\examples{
\dontrun{
tt <- compute_travel_times(
  tracts_sf = tracts, points_sf = stations,
  network_path = "path/to/osm_data",
  tract_id = "code_tract", point_id = "id"
)
}

}
\seealso{
\code{\link[=download_r5r_data]{download_r5r_data()}} to download OSM and elevation data.

Other spatial: 
\code{\link{areal_interpolate}()},
\code{\link{areal_weights}()},
\code{\link{download_r5r_data}()}
}
\concept{spatial}
