% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sinkhorn.R
\name{sinkhorn_objective}
\alias{sinkhorn_objective}
\title{Compute the per-bracket Sinkhorn-balanced interpolation objective}
\usage{
sinkhorn_objective(
  alpha,
  time_matrix,
  pop_matrix,
  source_matrix,
  row_targets,
  sk_iter = 50L
)
}
\arguments{
\item{alpha}{Numeric vector of length n. Decay parameters.}

\item{time_matrix}{Numeric matrix [n x m]. Adjusted travel times
(offset already applied). Must be strictly positive.}

\item{pop_matrix}{Numeric matrix [n x k]. Known population per zone.}

\item{source_matrix}{Numeric matrix [m x k]. Known counts at source points.}

\item{row_targets}{Numeric vector of length n. Desired row sums for
the final aggregate Sinkhorn balancing.}

\item{sk_iter}{Integer. Maximum Sinkhorn iterations per bracket and for
the final aggregate step. Default: 50.}
}
\value{
Single numeric value:
\code{sum((W_balanced \%*\% source_matrix - pop_matrix)^2)}.
}
\description{
Calculates the sum of squared errors between per-bracket Sinkhorn-balanced
IDW-interpolated values and known population. This is the R-level
version of the loss function used by \code{\link[=optimize_alpha]{optimize_alpha()}}.
}
\details{
Builds a per-bracket weight matrix: for each demographic column, runs
convergence-based Sinkhorn with bracket-specific row/column targets,
then sums contributions and applies a final aggregate Sinkhorn to
enforce overall row and column constraints. Computes the calibration
SSE against the known population.

Note: \code{time_matrix} is expected with offset already applied (i.e.,
\code{time_matrix + offset}). Do not apply offset again.
}
\seealso{
\code{\link[=optimize_alpha]{optimize_alpha()}} for the optimization wrapper,
\code{\link[=sinkhorn_weights]{sinkhorn_weights()}} for the final weight matrix.

Other Sinkhorn: 
\code{\link{sinkhorn_balance}()},
\code{\link{sinkhorn_weights}()}
}
\concept{Sinkhorn}
