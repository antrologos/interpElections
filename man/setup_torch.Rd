% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/torch-setup.R
\name{setup_torch}
\alias{setup_torch}
\title{Install and configure torch with GPU support}
\usage{
setup_torch(reinstall = FALSE, type = NULL, verbose = TRUE)
}
\arguments{
\item{reinstall}{Logical. Force re-download of libtorch/lantern binaries
even if they already exist. Use this to fix broken CUDA installations
(e.g., CPU-only lantern accidentally installed). Default: FALSE.}

\item{type}{Character or NULL. Installation type, passed to
\code{torch::install_torch()}. Common values: \code{NULL} (auto-detect),
\code{"cuda"} (force CUDA on Windows/Linux), \code{"cpu"} (force CPU-only).
Default: NULL (auto-detect based on available GPU).}

\item{verbose}{Logical. Default: TRUE.}
}
\value{
Invisibly, the result of \code{\link[=check_torch]{check_torch()}} after installation,
or a partial list with \code{needs_restart = TRUE} if R must be restarted.
}
\description{
Installs the torch R package (if missing) and downloads the
platform-appropriate libtorch + lantern binaries with GPU support.
After installation, verifies that GPU acceleration works via
\code{\link[=check_torch]{check_torch()}}.
}
\details{
The installation proceeds in stages:
\enumerate{
\item If the \code{torch} R package is not installed, it is installed from CRAN.
\item \code{torch::install_torch()} downloads libtorch and lantern binaries.
On Windows/Linux with an NVIDIA GPU and a CUDA toolkit, this
automatically selects CUDA-enabled binaries.
\item A verification step runs \code{\link[=check_torch]{check_torch()}} to confirm GPU works.
}

\strong{Important}: If the torch package was already loaded in the current R
session before calling \code{setup_torch()}, you must restart R for the new
binaries to take effect. The function detects this and warns accordingly.
}
\section{CUDA auto-detection}{

\code{torch::install_torch()} detects the CUDA version from:
\itemize{
\item The \code{CUDA} environment variable (if set, forces a version)
\item \code{CUDA_PATH} (Windows) or \code{CUDA_HOME} (Linux)
\item \code{nvcc --version} on PATH
}
}

\examples{
\dontrun{
setup_torch()                    # auto-detect GPU
setup_torch(type = "cuda")       # force CUDA
setup_torch(reinstall = TRUE)    # fix broken install
}

}
\seealso{
\code{\link[=check_torch]{check_torch()}} to diagnose the current setup,
\code{\link[=use_gpu]{use_gpu()}} to enable GPU acceleration after setup.
}
