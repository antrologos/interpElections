[{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Diagnostics and Validation","text":"Quick overview result:","code":"library(interpElections)  # Load precomputed results (2022 presidential election) result_igr  <- readRDS(\"precomputed/igrejinha_2022.rds\") result_vga  <- readRDS(\"precomputed/varginha_2022.rds\") result_vga2 <- readRDS(\"precomputed/varginha_2022_t2.rds\")  # turno 2 result_nit  <- readRDS(\"precomputed/niteroi_2022.rds\") result_bh   <- readRDS(\"precomputed/belo_horizonte_2022.rds\") #> interpElections result summary #> --------------------------------------------------  #> Municipality: VARGINHA (MG) -- IBGE: 3170701, TSE: 54135 #> Election: 2022 | Census: 2022 | Turno: 1 | Cargo: PRESIDENTE  #> Census tracts: 279 | Sources: 37 | Variables: 28 #>  #> Calibration: gender x 7 age brackets (14 pairs) #>  #> Optimization: pb_sgd_colnorm_cpu | Objective: 4742.8657 | Convergence: 0 #>   Alpha: min=1.000, Q1=1.373, median=1.564, Q3=1.839, max=11.032 #>  #> Candidates (13): #>   CAND_30                  LUIZ FELIPE CHAVES D AVILA (NOVO) total=       908  mean=     3.3  [0.1, 7.0] #>   CAND_44                  SORAYA VIEIRA THRONICKE (UNIÃO) total=       385  mean=     1.4  [0.0, 3.0] #>   CAND_12                  CIRO FERREIRA GOMES (PDT) total=      1835  mean=     6.6  [0.2, 14.6] #>   CAND_13                  LUIZ INÁCIO LULA DA SILVA (PT) total=     24380  mean=    87.4  [2.0, 189.2] #>   ... 9 more -- View(result$dictionary) #>  #> Turnout (1): #>   QT_COMPARECIMENTO        turnout                total=     71308  mean=   255.6  [6.0, 555.5] #>  #> Calibration (14): #>   vot_hom_18_19            calibration            total=       917  mean=     3.3  [0.0, 12.3] #>   vot_hom_20_24            calibration            total=      3551  mean=    12.7  [0.1, 38.1] #>   vot_hom_25_29            calibration            total=      4033  mean=    14.5  [0.6, 41.5] #>   vot_hom_30_39            calibration            total=      8291  mean=    29.7  [1.1, 66.8] #>   vot_hom_40_49            calibration            total=      8164  mean=    29.3  [0.7, 67.4] #>   vot_hom_50_59            calibration            total=      6975  mean=    25.0  [0.5, 66.8] #>   vot_hom_60_69            calibration            total=      5737  mean=    20.6  [0.3, 47.0] #>   vot_mul_18_19            calibration            total=      1189  mean=     4.3  [0.0, 10.9] #>   vot_mul_20_24            calibration            total=      3699  mean=    13.3  [0.1, 42.4] #>   vot_mul_25_29            calibration            total=      4167  mean=    14.9  [0.6, 34.4] #>   vot_mul_30_39            calibration            total=      8661  mean=    31.0  [1.2, 70.5] #>   vot_mul_40_49            calibration            total=      8960  mean=    32.1  [0.9, 71.6] #>   vot_mul_50_59            calibration            total=      7639  mean=    27.4  [0.7, 60.2] #>   vot_mul_60_69            calibration            total=      6406  mean=    23.0  [0.4, 51.5] #>  #>  #> Object size: 181.3 MB #> Neighborhoods: 387 #> interpElections result summary #> --------------------------------------------------  #> Municipality: BELO HORIZONTE (MG) -- IBGE: 3106200, TSE: 41238 #> Election: 2022 | Census: 2022 | Turno: 1 | Cargo: PRESIDENTE  #> Census tracts: 5109 | Sources: 407 | Variables: 28 #>  #> Calibration: gender x 7 age brackets (14 pairs) #>  #> Optimization: pb_sgd_colnorm_cuda | Objective: 8123.8301 | Convergence: 0 #>   Alpha: min=1.000, Q1=1.202, median=1.292, Q3=1.406, max=16.569 #>  #> Candidates (13): #>   CAND_13                  LUIZ INÁCIO LULA DA SILVA (PT) total=    603542  mean=   118.1  [2.9, 320.5] #>   CAND_27                  JOSE MARIA EYMAEL (DC) total=       209  mean=     0.0  [0.0, 0.2] #>   CAND_30                  LUIZ FELIPE CHAVES D AVILA (NOVO) total=     14496  mean=     2.8  [0.1, 8.9] #>   CAND_14                  KELMON LUIS DA SILVA SOUZA (PTB) total=       861  mean=     0.2  [0.0, 0.6] #>   ... 9 more -- View(result$dictionary) #>  #> Turnout (1): #>   QT_COMPARECIMENTO        turnout                total=   1489578  mean=   291.6  [7.1, 788.7] #>  #> Calibration (14): #>   vot_hom_18_19            calibration            total=     21044  mean=     4.1  [0.0, 12.1] #>   vot_hom_20_24            calibration            total=     73593  mean=    14.4  [0.3, 42.5] #>   vot_hom_25_29            calibration            total=     81481  mean=    15.9  [0.4, 45.2] #>   vot_hom_30_39            calibration            total=    172752  mean=    33.8  [0.8, 92.7] #>   vot_hom_40_49            calibration            total=    170766  mean=    33.4  [0.8, 91.2] #>   vot_hom_50_59            calibration            total=    138388  mean=    27.1  [0.7, 72.3] #>   vot_hom_60_69            calibration            total=    105049  mean=    20.6  [0.5, 52.4] #>   vot_mul_18_19            calibration            total=     23556  mean=     4.6  [0.0, 13.8] #>   vot_mul_20_24            calibration            total=     77657  mean=    15.2  [0.3, 44.8] #>   vot_mul_25_29            calibration            total=     88270  mean=    17.3  [0.4, 49.0] #>   vot_mul_30_39            calibration            total=    190378  mean=    37.3  [0.9, 102.8] #>   vot_mul_40_49            calibration            total=    194436  mean=    38.1  [0.9, 104.3] #>   vot_mul_50_59            calibration            total=    165447  mean=    32.4  [0.8, 87.1] #>   vot_mul_60_69            calibration            total=    137434  mean=    26.9  [0.6, 68.8] #>  #>  #> Object size: 235.5 MB #> Neighborhoods: 865"},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"intuition","dir":"Articles","previous_headings":"1. Automated Health Check: diagnostics()","what":"Intuition","title":"Diagnostics and Validation","text":"diagnostics() single-call “blood test” interpolation result. runs 8 automated checks reports PASS/WARN/FAIL . Use first step every interpolation catch problems early. checks whose outcome guaranteed construction included. Vote conservation, non-negativity, column normalization enforced design therefore omitted.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-example","dir":"Articles","previous_headings":"1. Automated Health Check: diagnostics()","what":"Applied example","title":"Diagnostics and Validation","text":"larger city: can also access check values programmatically:","code":"diagnostics(result_vga) #> interpElections diagnostics #> --------------------------------------------------  #>  [PASS] Convergence: optimizer converged (code 0) #>  [PASS] Alpha distribution: median=1.55, IQR=[1.37, 1.82], 0% > 15 #>  [PASS] Residual RMSE: 11.1614 (informational) #>  [WARN] Residual bias: max |colMeans(resid)| = 8.6344 (77.4% of RMSE) #>  [WARN] Population-voter gap: census=96829, source=78389, gap=19.0% #>  [PASS] Unreachable pairs: 0.5% of pairs near max travel time (>= 285 min) #>  [PASS] Alpha spatial variation: CV of median-alpha = 0.547 #>  [PASS] Implied turnout: 0.7% of tracts with implied turnout > 110% #> --------------------------------------------------  #> 6 PASS, 2 WARN diagnostics(result_bh) #> interpElections diagnostics #> --------------------------------------------------  #>  [PASS] Convergence: optimizer converged (code 0) #>  [PASS] Alpha distribution: median=1.29, IQR=[1.21, 1.39], 0% > 15 #>  [PASS] Residual RMSE: 7.0678 (informational) #>  [WARN] Residual bias: max |colMeans(resid)| = 1.8894 (26.7% of RMSE) #>  [PASS] Population-voter gap: census=1650864, source=1640251, gap=0.6% #>  [FAIL] Unreachable pairs: 15.1% of pairs near max travel time (>= 285 min) #>  [PASS] Alpha spatial variation: CV of median-alpha = 0.558 #>  [PASS] Implied turnout: 2.1% of tracts with implied turnout > 110% #> --------------------------------------------------  #> 6 PASS, 1 WARN, 1 FAIL d <- diagnostics(result_vga, verbose = FALSE) d$checks$convergence$value d$checks$residual_rmse$value d$checks$pop_voter_gap$value"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"interpretation","dir":"Articles","previous_headings":"1. Automated Health Check: diagnostics()","what":"Interpretation","title":"Diagnostics and Validation","text":"Convergence WARN: optimizer didn’t converge within epoch limit. Try increasing max_epochs optim_control(), check learning rate high. Alpha distribution WARN: Many tracts high α\\alpha values (>15> 15), meaning effectively use nearest station. can happen travel time data poor coverage. Pop-voter gap WARN/FAIL: total census population differs substantially total registered voters. expected degree (everyone registers, register outside residence), gaps > 20% suggest data quality issues. Unreachable pairs FAIL: Many tract-station pairs travel times ceiling. means routing engine couldn’t find paths — check OSM road network coverage. Alpha spatial CV WARN: Alpha values low variation across tracts (CV < 0.1). optimizer may adapting local conditions, possibly insufficient data poor convergence.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"intuition-1","dir":"Articles","previous_headings":"2. Optimization Convergence: plot_convergence()","what":"Intuition","title":"Diagnostics and Validation","text":"optimizer minimizes Poisson deviance adjusting decay parameters α\\alpha. plot_convergence() shows optimization trajectory: loss decreasing smoothly? gradient approaching zero? learning rate schedule used?","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"formal-definition-1","dir":"Articles","previous_headings":"2. Optimization Convergence: plot_convergence()","what":"Formal definition","title":"Diagnostics and Validation","text":"Loss: Poisson deviance =2∑,k[yiklogyikŷik−(yik−ŷik)]= 2 \\sum_{,k} \\left[ y_{ik} \\log\\frac{y_{ik}}{\\hat{y}_{ik}} - (y_{ik} - \\hat{y}_{ik}) \\right], yy = observed census population ŷ\\hat{y} = fitted population model. Gradient norm: ‖∇αL‖2\\lVert \\nabla_\\alpha L \\rVert_2, Euclidean norm gradient loss respect alpha parameters. Learning rate: Step size gradient descent. May decay epochs via cosine annealing schedules.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples","dir":"Articles","previous_headings":"2. Optimization Convergence: plot_convergence()","what":"Applied examples","title":"Diagnostics and Validation","text":"three panels (loss, gradient, learning rate):  Comparing GPU-optimized large city:  Show loss panel:  Log scale loss gradient (useful values span orders magnitude):","code":"plot_convergence(result_vga) plot_convergence(result_bh) plot_convergence(result_vga, which = \"loss\") plot_convergence(result_vga, which = c(\"loss\", \"gradient\"), log_y = TRUE)"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"interpretation-1","dir":"Articles","previous_headings":"2. Optimization Convergence: plot_convergence()","what":"Interpretation","title":"Diagnostics and Validation","text":"Good convergence: Smooth, monotonically decreasing loss plateaus. Gradient norm approaches zero. vertical dashed red line marks best epoch. Poor convergence: Oscillating loss, gradient doesn’t shrink, loss hasn’t plateaued last epoch. Consider increasing max_epochs adjusting learning rate. Learning rate: using cosine annealing, ’ll see decaying pattern. Flat LR = constant step size throughout.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"intuition-2","dir":"Articles","previous_headings":"3. Alpha Decay Parameters: plot_alpha()","what":"Intuition","title":"Diagnostics and Validation","text":"parameter αi\\alpha_i controls sharply weight station jj decays travel time tract ii. Higher α\\alpha means voters localized (sharp decay — nearby stations matter). Lower α\\alpha means voters come broader area (gradual decay — distant stations still contribute). α\\alpha matrix one row per tract one column per demographic bracket (14 brackets = 7 age groups ×\\times 2 genders). Different brackets may different decay patterns (e.g., young voters may travel farther vote).","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"formal-definition-2","dir":"Articles","previous_headings":"3. Alpha Decay Parameters: plot_alpha()","what":"Formal definition","title":"Diagnostics and Validation","text":"weight column normalization : Kij=(tij+1)−αiK_{ij} = (t_{ij} + 1)^{-\\alpha_i} tijt_{ij} travel time (minutes) tract ii station jj. final weight Wij=Kij/∑iKijW_{ij} = K_{ij} / \\sum_i K_{ij} (column-normalized station’s voters fully distributed).","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-map-mode","dir":"Articles","previous_headings":"3. Alpha Decay Parameters: plot_alpha()","what":"Applied examples: Map mode","title":"Diagnostics and Validation","text":"map mode collapses 14-bracket alpha matrix single scalar per tract using summary_fn. key visualization choice — different summaries answer different questions. Median (default) — “typical” alpha across brackets:  Mean — sensitive extreme values bracket:  Population-weighted — weights bracket tract’s population bracket:  Range (max−min\\max - \\min) — measures much α\\alpha varies across brackets within tract:  Single bracket (e.g., bracket 1 = Male 18–20):  Large city comparison (Belo Horizonte):","code":"plot_alpha(result_vga, type = \"map\", summary_fn = \"median\") plot_alpha(result_vga, type = \"map\", summary_fn = \"mean\") plot_alpha(result_vga, type = \"map\", summary_fn = \"pop_weighted\") plot_alpha(result_vga, type = \"map\", summary_fn = \"range\") plot_alpha(result_vga, type = \"map\", summary_fn = 1) plot_alpha(result_bh, type = \"map\", summary_fn = \"median\")"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-histogram-mode","dir":"Articles","previous_headings":"3. Alpha Decay Parameters: plot_alpha()","what":"Applied examples: Histogram mode","title":"Diagnostics and Validation","text":"Density plots faceted bracket. 14 brackets arranged 2$$7 grid, can compare age groups genders glance.  Select specific brackets:  Small city (narrower distributions due fewer tracts):","code":"plot_alpha(result_nit, type = \"histogram\") plot_alpha(result_nit, type = \"histogram\", brackets = c(1, 7, 8, 14)) plot_alpha(result_igr, type = \"histogram\")"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-bracket-boxplot","dir":"Articles","previous_headings":"3. Alpha Decay Parameters: plot_alpha()","what":"Applied examples: Bracket boxplot","title":"Diagnostics and Validation","text":"compact view — one boxplot per bracket single panel:  Male brackets :","code":"plot_alpha(result_bh, type = \"bracket\") plot_alpha(result_nit, type = \"bracket\", brackets = 1:7)"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"interpretation-2","dir":"Articles","previous_headings":"3. Alpha Decay Parameters: plot_alpha()","what":"Interpretation","title":"Diagnostics and Validation","text":"Urban core vs periphery: Central tracts many nearby stations tend higher α\\alpha (sharper decay). Peripheral tracts nearby stations lower α\\alpha (must draw distant stations). Age patterns: Younger brackets may show different α\\alpha distributions older ones, reflecting different mobility patterns. Range map: High range = optimizer found different decay rates different brackets tract. often occurs urban-rural boundary. α>15\\alpha > 15: Effectively nearest-station assignment. decay steep closest station non-negligible weight.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"intuition-3","dir":"Articles","previous_headings":"4. Calibration Residuals: plot_residuals() + residual_summary()","what":"Intuition","title":"Diagnostics and Validation","text":"model calibrates known census demographics (population age×\\timesgender bracket). Residuals measure well model reproduces known quantities. Small residuals mean model’s spatial allocation voters closely matches census demographics — giving confidence interpolated (unknown) electoral variables also spatially accurate.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"formal-definition-3","dir":"Articles","previous_headings":"4. Calibration Residuals: plot_residuals() + residual_summary()","what":"Formal definition","title":"Diagnostics and Validation","text":"Three types residuals available: Raw: rik=ŷik−yikr_{ik} = \\hat{y}_{ik} - y_{ik} (fitted minus observed). Scale depends population size. Pearson: rikP=(ŷik−yik)/ŷikr_{ik}^P = (\\hat{y}_{ik} - y_{ik}) / \\sqrt{\\hat{y}_{ik}}. Standardized Poisson assumption — comparable across tracts different sizes. Deviance: rikD=sign(ŷik−yik)⋅2[yiklogyikŷik−(yik−ŷik)]r_{ik}^D = \\text{sign}(\\hat{y}_{ik} - y_{ik}) \\cdot \\sqrt{2\\left[y_{ik}\\log\\frac{y_{ik}}{\\hat{y}_{ik}} - (y_{ik} - \\hat{y}_{ik})\\right]}. Individual Poisson deviance contributions.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-map-mode-1","dir":"Articles","previous_headings":"4. Calibration Residuals: plot_residuals() + residual_summary()","what":"Applied examples: Map mode","title":"Diagnostics and Validation","text":"maps, summary_fn collapses across 14 brackets single value per tract. RMSE (default) — magnitude misfit:  Mean — directional bias (positive = -prediction, negative = -prediction):  Pearson residuals (standardized):  Large city (Belo Horizonte):  Single bracket:","code":"plot_residuals(result_vga, type = \"map\", summary_fn = \"rmse\") plot_residuals(result_vga, type = \"map\", summary_fn = \"mean\") plot_residuals(result_vga, type = \"map\", residual_type = \"pearson\",                summary_fn = \"rmse\") plot_residuals(result_bh, type = \"map\", summary_fn = \"rmse\") plot_residuals(result_vga, type = \"map\", summary_fn = 1)"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-histogram-mode-1","dir":"Articles","previous_headings":"4. Calibration Residuals: plot_residuals() + residual_summary()","what":"Applied examples: Histogram mode","title":"Diagnostics and Validation","text":"Compare Pearson residuals:","code":"plot_residuals(result_nit, type = \"histogram\") plot_residuals(result_nit, type = \"histogram\", residual_type = \"pearson\")"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-bracket-boxplot-1","dir":"Articles","previous_headings":"4. Calibration Residuals: plot_residuals() + residual_summary()","what":"Applied examples: Bracket boxplot","title":"Diagnostics and Validation","text":"Deviance scale:","code":"plot_residuals(result_bh, type = \"bracket\") plot_residuals(result_bh, type = \"bracket\", residual_type = \"deviance\")"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-scatter-fitted-vs-observed","dir":"Articles","previous_headings":"4. Calibration Residuals: plot_residuals() + residual_summary()","what":"Applied examples: Scatter (fitted vs observed)","title":"Diagnostics and Validation","text":"Selected brackets:","code":"plot_residuals(result_igr, type = \"scatter\") plot_residuals(result_vga, type = \"scatter\", brackets = c(1, 14))"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"tabular-summary-residual_summary","dir":"Articles","previous_headings":"4. Calibration Residuals: plot_residuals() + residual_summary()","what":"Tabular summary: residual_summary()","title":"Diagnostics and Validation","text":"","code":"residual_summary(result_vga) #> $per_bracket #>         bracket      mean      rmse  max_abs pct_gt_2sd #> 1    Male 18-19 -2.827957  4.059031 20.53281  11.111111 #> 2    Male 20-24 -4.939067  7.797788 30.04813  11.827957 #> 3    Male 25-29 -3.688171  8.106033 51.24654   5.017921 #> 4    Male 30-39 -8.189961 17.043889 83.32305   8.243728 #> 5    Male 40-49 -6.788528 12.326740 51.39126   8.243728 #> 6    Male 50-59 -3.684587 10.199236 34.77560   6.451613 #> 7    Male 60-69 -2.093189 10.403941 33.86028   3.942652 #> 8  Female 18-19 -1.896057  3.159372 15.21720   8.243728 #> 9  Female 20-24 -4.594981  8.153665 40.75452   6.810036 #> 10 Female 25-29 -3.767024  9.090355 58.74693   4.659498 #> 11 Female 30-39 -8.634405 18.301023 76.87199   8.960573 #> 12 Female 40-49 -7.537631 13.143567 49.36128  10.752688 #> 13 Female 50-59 -4.498207 10.945480 35.17879   7.526882 #> 14 Female 60-69 -2.953404 12.640834 43.72819   3.584229 #>  #> $per_tract #>            tract_id          mean      rmse worst_bracket #> 1   317070105000001  -4.559499105  8.042145    Male 30-39 #> 2   317070105000008  -5.817392760  6.508973  Female 30-39 #> 3   317070105000009  -6.525675945  9.452732  Female 50-59 #> 4   317070105000010  -4.178874830  8.154544  Female 60-69 #> 5   317070105000013  -5.931557880  7.924279    Male 50-59 #> 6   317070105000014  -4.797042481  6.637974  Female 60-69 #> 7   317070105000015  -3.279786993  4.869772  Female 60-69 #> 8   317070105000016  -3.730706410  5.979425    Male 40-49 #> 9   317070105000017  -8.153168938 10.445935  Female 30-39 #> 10  317070105000019  -3.441251999  5.645363    Male 60-69 #> 11  317070105000021  -5.159772519  7.363183    Male 40-49 #> 12  317070105000022  -2.972061822  5.124712  Female 25-29 #> 13  317070105000023  -4.791757836  7.658873    Male 30-39 #> 14  317070105000024  -4.737669076  7.037065    Male 25-29 #> 15  317070105000025  -3.621190773  7.397953  Female 50-59 #> 16  317070105000026  -2.616823935  4.447516  Female 30-39 #> 17  317070105000028  -7.987001155 15.477373  Female 30-39 #> 18  317070105000029  -5.503456559  7.982523  Female 40-49 #> 19  317070105000031  -3.967276747  5.486863  Female 60-69 #> 20  317070105000032  -5.376395712  8.290350    Male 20-24 #> 21  317070105000033  -3.879079089  6.010987    Male 60-69 #> 22  317070105000035  -4.305278323  6.026978  Female 30-39 #> 23  317070105000036  -5.348486587  9.068216    Male 30-39 #> 24  317070105000037  -3.768021776  5.766189  Female 60-69 #> 25  317070105000039  -5.277827758  7.210824    Male 40-49 #> 26  317070105000040  -5.646144655 14.743876    Male 50-59 #> 27  317070105000041  -4.455607134  8.435646  Female 50-59 #> 28  317070105000043  -2.993832041  5.159039    Male 40-49 #> 29  317070105000044  -5.014125006 14.135927    Male 40-49 #> 30  317070105000045  -5.647897544  9.526189  Female 40-49 #> 31  317070105000047  -6.999989265 12.008012  Female 50-59 #> 32  317070105000048  -4.209556734  7.569161    Male 30-39 #> 33  317070105000049  -3.941751954  5.488531  Female 30-39 #> 34  317070105000050  -5.176019395  8.946001  Female 60-69 #> 35  317070105000051  -3.227461851  4.572083  Female 40-49 #> 36  317070105000052  -5.075770996  7.014303  Female 40-49 #> 37  317070105000054  -4.442495164  7.946705  Female 60-69 #> 38  317070105000055  -4.390435462 10.719426  Female 50-59 #> 39  317070105000056  -2.711726977  5.726792  Female 60-69 #> 40  317070105000057  -3.616608517  7.121060  Female 60-69 #> 41  317070105000059  -5.651705104  7.889638  Female 40-49 #> 42  317070105000060  -5.790153105  7.271156    Male 50-59 #> 43  317070105000061  -4.641782043  6.681543  Female 50-59 #> 44  317070105000063  -4.383467078  8.409008  Female 60-69 #> 45  317070105000065  -6.603790275  9.260719    Male 60-69 #> 46  317070105000066  -5.740852701 11.129849    Male 60-69 #> 47  317070105000067  -3.784408463  7.293882  Female 50-59 #> 48  317070105000069  -7.222193384  9.665045    Male 30-39 #> 49  317070105000070  -5.224082199  8.418305  Female 50-59 #> 50  317070105000071  -5.103918010  8.003257  Female 60-69 #> 51  317070105000074  -4.713231324  7.626746  Female 60-69 #> 52  317070105000077  -4.014451494  9.175202  Female 60-69 #> 53  317070105000078  -5.372129372  8.978801  Female 60-69 #> 54  317070105000079  -5.519995512  8.232696  Female 40-49 #> 55  317070105000082  -5.768358792  8.797538    Male 60-69 #> 56  317070105000083  -4.762651150  8.180109  Female 50-59 #> 57  317070105000086  -5.901150768  9.075647    Male 40-49 #> 58  317070105000087  -5.426857241  8.490484  Female 50-59 #> 59  317070105000089  -7.601965474 10.792977  Female 40-49 #> 60  317070105000091  -5.986561842  8.902330  Female 60-69 #> 61  317070105000094  -7.047298836  9.425062  Female 60-69 #> 62  317070105000095  -7.177295583  9.361397    Male 40-49 #> 63  317070105000096  -6.985742597 10.537407  Female 40-49 #> 64  317070105000100 -10.100013077 15.473248  Female 40-49 #> 65  317070105000101  -4.805998429  8.572757    Male 50-59 #> 66  317070105000102  -9.600321553 14.281835  Female 50-59 #> 67  317070105000103  -3.485435366  6.780881  Female 60-69 #> 68  317070105000104  -5.146516573 10.326812  Female 60-69 #> 69  317070105000105  -6.752081376 10.766817  Female 60-69 #> 70  317070105000106  -4.824688452  7.758505  Female 60-69 #> 71  317070105000107  -5.122550583  9.334595  Female 60-69 #> 72  317070105000108  -4.594410447 10.428848  Female 60-69 #> 73  317070105000112 -10.783400289 19.169802  Female 40-49 #> 74  317070105000114  -7.540679964 12.078729  Female 50-59 #> 75  317070105000115  -7.767283852 11.974748  Female 50-59 #> 76  317070105000116  -5.109025610 10.132901    Male 50-59 #> 77  317070105000117  -6.005351610  9.535741  Female 40-49 #> 78  317070105000120  -4.976812928 14.786015  Female 30-39 #> 79  317070105000121  -1.474780697  5.321110    Male 50-59 #> 80  317070105000124  -9.454155052 12.625417  Female 30-39 #> 81  317070105000125  -7.963680534 10.068015  Female 40-49 #> 82  317070105000126  -4.357447510  6.378833  Female 60-69 #> 83  317070105000127  -4.858176667  7.489459  Female 50-59 #> 84  317070105000128  -6.625455365  9.590299    Male 60-69 #> 85  317070105000129  -6.010697106  8.874241  Female 50-59 #> 86  317070105000130  -5.749168601  6.748761    Male 20-24 #> 87  317070105000131  -6.874421785 11.497939  Female 60-69 #> 88  317070105000133  -6.152771191 13.877509  Female 60-69 #> 89  317070105000134  -3.144991738  7.000318  Female 50-59 #> 90  317070105000135  -4.986783383  8.782297  Female 60-69 #> 91  317070105000136  -1.889998347  5.609723  Female 30-39 #> 92  317070105000138  -1.812816386  3.358284  Female 60-69 #> 93  317070105000139  -2.892750619  7.005628    Male 50-59 #> 94  317070105000140  -1.702602786  4.920442    Male 50-59 #> 95  317070105000141  -1.964337987  5.143543    Male 50-59 #> 96  317070105000142  -1.908293409  3.862864    Male 40-49 #> 97  317070105000143  -2.027490158  3.780440    Male 50-59 #> 98  317070105000144  -4.366981808  6.967249    Male 40-49 #> 99  317070105000147  -4.529938153 11.733861    Male 40-49 #> 100 317070105000148  -7.074702612  9.785243  Female 40-49 #> 101 317070105000149  -4.127573226  9.515252  Female 50-59 #> 102 317070105000150  -0.101504033  2.484096  Female 60-69 #> 103 317070105000151  -9.578011582 14.932277    Male 50-59 #> 104 317070105000152  -4.137780659  9.054076  Female 60-69 #> 105 317070105000153  -5.226112858  7.297822    Male 40-49 #> 106 317070105000154  -6.081579275  7.714759  Female 50-59 #> 107 317070105000155  -4.490538487  5.945292  Female 50-59 #> 108 317070105000156  -3.447380184  6.443840  Female 60-69 #> 109 317070105000157  -7.508003735 14.036262  Female 40-49 #> 110 317070105000158  -4.596145022  6.139220    Male 60-69 #> 111 317070105000159  -6.659892214 15.049241  Female 40-49 #> 112 317070105000160  -5.930079966 10.937638  Female 50-59 #> 113 317070105000161  -8.501208114 12.990829  Female 50-59 #> 114 317070105000162  -6.506503868 12.028199    Male 50-59 #> 115 317070105000164  -2.335947999  8.553090  Female 30-39 #> 116 317070105000165   0.219658119  1.100615  Female 25-29 #> 117 317070105000166  -6.911469577  9.260399  Female 50-59 #> 118 317070105000168  -7.684448430 10.094578  Female 40-49 #> 119 317070105000169  -6.286034136  8.366596  Female 60-69 #> 120 317070105000171  -5.754687079 14.031668  Female 40-49 #> 121 317070105000172  -5.408751298 16.282554    Male 40-49 #> 122 317070105000174  -4.796378155 16.399113    Male 30-39 #> 123 317070105000175  -2.760672767 10.383235  Female 30-39 #> 124 317070105000176  -1.610918456  3.598584  Female 30-39 #> 125 317070105000177   1.719798967  7.178287  Female 30-39 #> 126 317070105000178  -4.618270361 14.223881  Female 30-39 #> 127 317070105000179  -4.125619406  6.772092  Female 60-69 #> 128 317070105000180  -3.830638937  6.557574  Female 60-69 #> 129 317070105000181  -3.116283671  6.689733    Male 60-69 #> 130 317070105000182  -6.237384966 19.645876  Female 30-39 #> 131 317070105000183  -9.476729870 19.482365  Female 40-49 #> 132 317070105000185  -4.436989940  6.514733  Female 50-59 #> 133 317070105000186  -4.346734596  8.910282  Female 60-69 #> 134 317070105000188  -7.218671765 10.369760  Female 40-49 #> 135 317070105000189  -4.560795227  7.906853  Female 60-69 #> 136 317070105000190  -3.525752309  5.011938  Female 40-49 #> 137 317070105000191  -2.209252730  5.407580  Female 60-69 #> 138 317070105000192  -4.021250599  7.303359  Female 30-39 #> 139 317070105000193  -3.466915262  8.664347    Male 30-39 #> 140 317070105000194  -5.993749024  9.652451    Male 20-24 #> 141 317070105000196  -7.729417560 23.369906  Female 30-39 #> 142 317070105000197   0.079699282  1.605916    Male 30-39 #> 143 317070105000198  -0.530342426  1.694565    Male 60-69 #> 144 317070105000199  -5.773685460  9.795838  Female 40-49 #> 145 317070105000200  -7.451537815 14.007476    Male 40-49 #> 146 317070105000201  -7.221924585 11.987679  Female 50-59 #> 147 317070105000205  -7.478312723 20.081069  Female 40-49 #> 148 317070105000206  -7.583998902 18.684539  Female 40-49 #> 149 317070105000207  -2.226276622  6.781661    Male 20-24 #> 150 317070105000208  -5.825423247 15.240798  Female 30-39 #> 151 317070105000209  -7.385281010 18.344320  Female 30-39 #> 152 317070105000210  -5.258293422 12.681091  Female 40-49 #> 153 317070105000211  -3.815364124 11.312495  Female 40-49 #> 154 317070105000212  -4.697426602 11.476398  Female 40-49 #> 155 317070105000213  -5.251402772 13.371039  Female 30-39 #> 156 317070105000214  -9.017900202 26.055061  Female 30-39 #> 157 317070105000216  -6.704923700 20.839160    Male 30-39 #> 158 317070105000217  -3.029136859 11.525926  Female 30-39 #> 159 317070105000219 -10.209721796 30.462281    Male 30-39 #> 160 317070105000220  -2.285550735  6.190082    Male 20-24 #> 161 317070105000221  -3.499971865  6.079196  Female 60-69 #> 162 317070105000222  -2.160133191  4.576107    Male 60-69 #> 163 317070105000223  -1.589892376  4.406073  Female 60-69 #> 164 317070105000224  -2.621427865  7.123151  Female 25-29 #> 165 317070105000225  -2.123928507  5.206267    Male 60-69 #> 166 317070105000226  -2.080119928  4.495681    Male 25-29 #> 167 317070105000227  -4.030275763  7.158562    Male 30-39 #> 168 317070105000228  -2.961436752  4.854407  Female 20-24 #> 169 317070105000229  -3.762827911  6.148631  Female 60-69 #> 170 317070105000230  -3.458054684  5.073844  Female 60-69 #> 171 317070105000231  -3.920216966  6.135808    Male 30-39 #> 172 317070105000232  -2.912997333  4.337222    Male 60-69 #> 173 317070105000233  -2.658217242  3.910833    Male 30-39 #> 174 317070105000234  -2.084527396  4.714393    Male 20-24 #> 175 317070105000235  -3.994848607  6.580694  Female 30-39 #> 176 317070105000236  -2.338782057  4.753211  Female 20-24 #> 177 317070105000237  -5.148975144  8.889681  Female 40-49 #> 178 317070105000238  -3.169750616  6.891712  Female 60-69 #> 179 317070105000239  -2.638798003  4.943243  Female 50-59 #> 180 317070105000240  -2.605970815  4.815049  Female 60-69 #> 181 317070105000241  -3.373292463  9.865236  Female 50-59 #> 182 317070105000242  -5.582670609  9.020344    Male 30-39 #> 183 317070105000243  -3.011605312  5.024262    Male 30-39 #> 184 317070105000244  -2.996765407  5.868940    Male 20-24 #> 185 317070105000245  -6.217101274  8.017804  Female 40-49 #> 186 317070105000246  -4.886043894 14.355249  Female 30-39 #> 187 317070105000247  -3.955582045  5.279757    Male 25-29 #> 188 317070105000248  -3.719277711  6.311721  Female 60-69 #> 189 317070105000249  -2.771875681  5.218794  Female 60-69 #> 190 317070105000250  -2.199008645  6.274830    Male 40-49 #> 191 317070105000251  -5.956430160 13.224822  Female 30-39 #> 192 317070105000252  -6.237168100  9.470165  Female 40-49 #> 193 317070105000253  -5.715401678 11.893279  Female 30-39 #> 194 317070105000254  -4.526958652  7.297146    Male 50-59 #> 195 317070105000255  -5.275423051  6.918454  Female 50-59 #> 196 317070105000256  -3.612772112  7.024843    Male 40-49 #> 197 317070105000257  -4.656291228  6.602483  Female 40-49 #> 198 317070105000258  -3.647852724  6.576518  Female 40-49 #> 199 317070105000259  -3.825448740 10.505665  Female 60-69 #> 200 317070105000260  -2.731550595  6.119313  Female 60-69 #> 201 317070105000261  -4.619740715  8.194501    Male 60-69 #> 202 317070105000262  -2.920902247  6.721618    Male 60-69 #> 203 317070105000263  -5.044023319  6.759129    Male 40-49 #> 204 317070105000264  -3.482541180  7.359363    Male 60-69 #> 205 317070105000265  -3.660105481  5.549348  Female 50-59 #> 206 317070105000266  -3.154622939  5.333756  Female 60-69 #> 207 317070105000267  -2.881227788  5.069382    Male 40-49 #> 208 317070105000268  -3.454984991  4.729498    Male 30-39 #> 209 317070105000269  -5.932591908  8.715663  Female 60-69 #> 210 317070105000270  -2.632622073  7.343952  Female 40-49 #> 211 317070105000271  -6.974226857 10.263487    Male 40-49 #> 212 317070105000272  -3.039229532  6.055542    Male 20-24 #> 213 317070105000273  -7.491179776 11.615983  Female 40-49 #> 214 317070105000274  -3.613668886  7.091210    Male 40-49 #> 215 317070105000275  -3.644286051  7.565706  Female 50-59 #> 216 317070105000276  -1.175212613  2.253284    Male 50-59 #> 217 317070105000277  -4.900492426 11.581359  Female 50-59 #> 218 317070105000278  -3.523019213  8.271168  Female 60-69 #> 219 317070105000279 -11.481031596 23.106166  Female 30-39 #> 220 317070105000281  -6.576763531  8.454906    Male 30-39 #> 221 317070105000282  -8.458377586 21.495595    Male 40-49 #> 222 317070105000283  -4.379311424  6.925351  Female 60-69 #> 223 317070105000284  -3.658112460  7.679305  Female 60-69 #> 224 317070105000285  -0.526046462  2.498439    Male 50-59 #> 225 317070105000286  -1.784384342  3.215404    Male 60-69 #> 226 317070105000287  -4.332851166  8.304033    Male 50-59 #> 227 317070105000288  -6.028301666 11.274869    Male 50-59 #> 228 317070105000289  -3.985582181  4.990903  Female 40-49 #> 229 317070105000290  -7.673251480 23.492149    Male 30-39 #> 230 317070105000291  -4.319334689 12.754558  Female 30-39 #> 231 317070105000292  -7.331603258 29.552802  Female 30-39 #> 232 317070105000293  -6.835327075 25.357930    Male 30-39 #> 233 317070105000294  -3.509332555 13.543536  Female 40-49 #> 234 317070105000295  -6.895382517 15.077349  Female 30-39 #> 235 317070105000296  -4.170449647  8.022644    Male 60-69 #> 236 317070105000297  -4.176608168  5.105153    Male 20-24 #> 237 317070105000298  -6.267813116 14.369969  Female 30-39 #> 238 317070105000299  -4.432795031 13.130784  Female 30-39 #> 239 317070105000300  -8.894887463 19.627627    Male 30-39 #> 240 317070105000301  -7.220276832 20.302309  Female 30-39 #> 241 317070105000302  -9.324472048 30.102949  Female 30-39 #> 242 317070105000303  -9.980109554 28.480730    Male 30-39 #> 243 317070105000304  -5.158310003 20.597483  Female 30-39 #> 244 317070105000305  -3.653094690 11.340652  Female 30-39 #> 245 317070105000307  -7.422074989 27.872345  Female 30-39 #> 246 317070105000308  -7.826705440 23.418095  Female 25-29 #> 247 317070105000309  -4.041079629 15.869342    Male 30-39 #> 248 317070105000310  -6.213428914 21.444799  Female 25-29 #> 249 317070105000311  -1.621793070  2.921288  Female 60-69 #> 250 317070105000312  -5.612424546  9.680878  Female 40-49 #> 251 317070105000313  -5.938483465 12.798353  Female 40-49 #> 252 317070105000314  -2.920277439  4.243816  Female 30-39 #> 253 317070105000315  -1.403449935  3.510497  Female 50-59 #> 254 317070105000316  -1.259709176  4.502293    Male 40-49 #> 255 317070105000317   0.007519648  2.166268    Male 50-59 #> 256 317070105000318  -0.645777131  3.036960  Female 50-59 #> 257 317070105000319 -10.903202863 34.911173  Female 25-29 #> 258 317070105000320  -7.178136535 25.853881    Male 30-39 #> 259 317070105000321  -2.589425279  4.368163  Female 60-69 #> 260 317070105000322   0.084782532  1.464751    Male 20-24 #> 261 317070105000323  -2.386502712  4.753391  Female 20-24 #> 262 317070105000324  -4.180621087  7.458454  Female 40-49 #> 263 317070105000325  -1.209934297  5.631450  Female 60-69 #> 264 317070105000326  -0.748309305  3.530488  Female 50-59 #> 265 317070105000327  -1.656007806  4.123553  Female 40-49 #> 266 317070105000328  -1.167363189  3.907636  Female 50-59 #> 267 317070105000329  -4.752467183  7.332858    Male 20-24 #> 268 317070105000330  -5.473691091  8.484049    Male 20-24 #> 269 317070105000331  -2.822873680  3.945492  Female 25-29 #> 270 317070105000332  -2.585965004  4.624353    Male 50-59 #> 271 317070105000333  -8.139100229 16.031355    Male 40-49 #> 272 317070105000334  -4.886458621  8.283490  Female 40-49 #> 273 317070105000335  -4.640303917 15.987679    Male 30-39 #> 274 317070105000336  -6.624475403 23.739846  Female 30-39 #> 275 317070105000337  -0.804551760  2.989844    Male 60-69 #> 276 317070105000338  -6.009582627 17.871760  Female 25-29 #> 277 317070105000339  -7.871425957 14.466566  Female 40-49 #> 278 317070105000340  -3.530530272  6.090355    Male 60-69 #> 279 317070105000342  -3.089515660  6.128272    Male 50-59 #>  #> $overall #> $overall$rmse #> [1] 11.16139 #>  #> $overall$mean_bias #> [1] -4.720941 #>  #> $overall$total_deviance #> [1] 16164.46"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"interpretation-3","dir":"Articles","previous_headings":"4. Calibration Residuals: plot_residuals() + residual_summary()","what":"Interpretation","title":"Diagnostics and Validation","text":"Raw residuals: Scale depends tract population. residual 10 means different things tract 50 people vs 5,000. Use Pearson deviance fair comparison. Pearson residuals: Standardized — values around ±2\\pm 2 typical. Values >3> 3 outliers Poisson assumption. Bracket comparison: one bracket consistently larger residuals, model may trouble demographic group — check whether census data bracket reliable. Scatter plot: Points cluster tightly around 45-degree line. Systematic departures indicate bias.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"intuition-4","dir":"Articles","previous_headings":"5. Weight Structure","what":"Intuition","title":"Diagnostics and Validation","text":"weight matrix WW (dimensions n×mn \\times m, tracts ×\\times sources) heart interpolation. determines voters station allocated tract. Understanding structure WW reveals: Catchment areas: stations serve tracts Concentration: tract depend one station many? Fragility: tracts dependent single station sensitive station’s data","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"formal-definition-4","dir":"Articles","previous_headings":"5. Weight Structure","what":"Formal definition","title":"Diagnostics and Validation","text":"Since WW column-normalized (∑iWij=1\\sum_i W_{ij} = 1), row sums 1. concentration measures, row-normalize: pij=Wij/∑jWijp_{ij} = W_{ij} / \\sum_j W_{ij}. Shannon entropy: Hi=−∑jpijlnpijH_i = -\\sum_j p_{ij} \\ln p_{ij} Effective number sources: exp(Hi)\\exp(H_i) — equivalent number equal-weight stations Herfindahl-Hirschman Index: HHIi=∑jpij2\\text{HHI}_i = \\sum_j p_{ij}^2 — ranges 1/m1/m (perfect equality) 1 (monopoly one station)","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"tabular-summary-weight_summary","dir":"Articles","previous_headings":"5. Weight Structure","what":"Tabular summary: weight_summary()","title":"Diagnostics and Validation","text":"","code":"head(weight_summary(result_vga), 15) #>                        tract_id dominant_source dominant_weight top3_weight #> 317070105000001 317070105000001              26     0.113710351  0.12612049 #> 317070105000008 317070105000008              26     0.035960075  0.07200471 #> 317070105000009 317070105000009              14     0.020939918  0.04571853 #> 317070105000010 317070105000010              14     0.032840371  0.05289709 #> 317070105000013 317070105000013              14     0.020836243  0.05527316 #> 317070105000014 317070105000014              14     0.024706738  0.04238994 #> 317070105000015 317070105000015              10     0.040361520  0.04864066 #> 317070105000016 317070105000016              10     0.011528280  0.02630788 #> 317070105000017 317070105000017              10     0.020663628  0.05037505 #> 317070105000019 317070105000019               9     0.009757796  0.02103461 #> 317070105000021 317070105000021               9     0.014567442  0.02916011 #> 317070105000022 317070105000022              12     0.008976594  0.02271826 #> 317070105000023 317070105000023              12     0.021697788  0.05338061 #> 317070105000024 317070105000024              15     0.014425963  0.04110649 #> 317070105000025 317070105000025               9     0.044096258  0.05680156 #>                   entropy effective_n_sources herfindahl #> 317070105000001 0.7273602            2.069610 0.73383488 #> 317070105000008 3.0339539           20.779228 0.08094583 #> 317070105000009 3.3561843           28.679550 0.04519548 #> 317070105000010 2.8815606           17.842096 0.11191140 #> 317070105000013 3.1993921           24.517621 0.05541503 #> 317070105000014 3.1961708           24.438771 0.06344365 #> 317070105000015 1.9450532            6.994004 0.35883469 #> 317070105000016 3.3320708           27.996255 0.04656403 #> 317070105000017 3.4162950           30.456364 0.04057307 #> 317070105000019 3.4676934           32.062700 0.03637372 #> 317070105000021 3.4604435           31.831091 0.03672944 #> 317070105000022 3.3544168           28.628903 0.04327622 #> 317070105000023 3.1026232           22.256257 0.06090369 #> 317070105000024 3.2173313           24.961417 0.05158218 #> 317070105000025 2.4817967           11.962738 0.19984869 #>                 mean_travel_time_weighted #> 317070105000001                 0.3126993 #> 317070105000008                 3.2039284 #> 317070105000009                 4.6225923 #> 317070105000010                 2.0331058 #> 317070105000013                 3.2192116 #> 317070105000014                 2.8360734 #> 317070105000015                 0.7293393 #> 317070105000016                 2.5934512 #> 317070105000017                 6.4391421 #> 317070105000019                 4.3478902 #> 317070105000021                 6.3769464 #> 317070105000022                 3.3738270 #> 317070105000023                 3.6591524 #> 317070105000024                 3.9138005 #> 317070105000025                 1.5455184 #>  #> ... (279 rows total)"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"entropy-map-plot_weightstype-entropy","dir":"Articles","previous_headings":"5. Weight Structure","what":"Entropy map: plot_weights(type = \"entropy\")","title":"Diagnostics and Validation","text":"Large city comparison:","code":"plot_weights(result_vga, type = \"entropy\") plot_weights(result_bh, type = \"entropy\")"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"dominant-station-map-plot_weightstype-dominant","dir":"Articles","previous_headings":"5. Weight Structure","what":"Dominant station map: plot_weights(type = \"dominant\")","title":"Diagnostics and Validation","text":"","code":"plot_weights(result_vga, type = \"dominant\") plot_weights(result_nit, type = \"dominant\")"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"catchment-mode-plot_weightstype-catchment","dir":"Articles","previous_headings":"5. Weight Structure","what":"Catchment mode: plot_weights(type = \"catchment\")","title":"Diagnostics and Validation","text":"Auto-selects tract highest effective number sources:  Filtered view top_k threshold:","code":"plot_weights(result_vga, type = \"catchment\") plot_weights(result_vga, type = \"catchment\", tract = 1,              top_k = 3, threshold = 0.05)"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"connections-plot_connections","dir":"Articles","previous_headings":"5. Weight Structure","what":"Connections: plot_connections()","title":"Diagnostics and Validation","text":"Overview — one spoke per tract dominant station:  Large city:  Detail specific tract:","code":"plot_connections(result_vga) plot_connections(result_bh) plot_connections(result_vga, tract = 1)"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"interpretation-4","dir":"Articles","previous_headings":"5. Weight Structure","what":"Interpretation","title":"Diagnostics and Validation","text":"Low entropy tracts (effective N close 1): interpolation tract depends almost entirely single station. station’s data atypical, interpolated values may unreliable. Dominant station map: Produces Voronoi-like partition. catchment areas don’t match geographic intuition, check travel time matrix. Connections: spoke pattern make geographic sense — tracts connect nearby stations. Long-distance connections suggest routing issues.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"intuition-5","dir":"Articles","previous_headings":"6. Travel Time Data Quality: plot_travel_times()","what":"Intuition","title":"Diagnostics and Validation","text":"travel time matrix input drives everything: α\\alpha optimization, weight computation, ultimately spatial allocation voters. Poor travel time data (unreachable pairs, disconnected road networks) directly degrades interpolation quality.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-1","dir":"Articles","previous_headings":"6. Travel Time Data Quality: plot_travel_times()","what":"Applied examples","title":"Diagnostics and Validation","text":"Histogram — distribution n×mn \\times m travel times:  Large city:  Heatmap — rows = tracts (ordered latitude), columns = stations. Block-diagonal structure reveals spatial locality:  Map — station points colored travel time specific tract:","code":"plot_travel_times(result_vga, type = \"histogram\") plot_travel_times(result_bh, type = \"histogram\") plot_travel_times(result_vga, type = \"heatmap\") plot_travel_times(result_vga, type = \"map\", tract = 1)"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"interpretation-5","dir":"Articles","previous_headings":"6. Travel Time Data Quality: plot_travel_times()","what":"Interpretation","title":"Diagnostics and Validation","text":"Spike maximum value: “fill” values unreachable pairs. large spike means routing engine couldn’t find paths many pairs. Bimodal distribution: May indicate disconnected graph components (e.g., separated river without bridge OSM network). Block-diagonal heatmap: Expected — nearby tracts similar travel times stations. Absence block structure suggests travel times lack spatial coherence.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"intuition-6","dir":"Articles","previous_headings":"7. Spatial Autocorrelation: plot_residual_autocorrelation() + plot_moran()","what":"Intuition","title":"Diagnostics and Validation","text":"Residual autocorrelation: residuals spatially clustered (nearby tracts similar residuals), model missing spatial structure — misspecification signal. Moran’s interpolated variables: interpolated vote shares show expected spatial concentration (e.g., PT strongholds low-income areas), method preserving realistic political geography.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"formal-definition-5","dir":"Articles","previous_headings":"7. Spatial Autocorrelation: plot_residual_autocorrelation() + plot_moran()","what":"Formal definition","title":"Diagnostics and Validation","text":"Global Moran’s : =n∑,jwij⋅∑,jwij(xi−x‾)(xj−x‾)∑(xi−x‾)2I = \\frac{n}{\\sum_{,j} w_{ij}} \\cdot \\frac{\\sum_{,j} w_{ij}(x_i - \\bar{x})(x_j - \\bar{x})}{\\sum_i (x_i - \\bar{x})^2} wijw_{ij} spatial weights (queen contiguity). Range: [−1,+1][-1, +1]. Positive = clustering, ≈0\\approx 0 = random, negative = dispersion. LISA (Local Moran’s ): Ii=(xi−x‾)s2∑jwij(xj−x‾)I_i = \\frac{(x_i - \\bar{x})}{s^2} \\sum_j w_{ij}(x_j - \\bar{x}). Classification: HH (high-high cluster), LL (low-low), HL (high surrounded low), LH (low surrounded high).","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-residual-autocorrelation","dir":"Articles","previous_headings":"7. Spatial Autocorrelation: plot_residual_autocorrelation() + plot_moran()","what":"Applied examples: Residual autocorrelation","title":"Diagnostics and Validation","text":"Pearson residuals:","code":"plot_residual_autocorrelation(result_vga) plot_residual_autocorrelation(result_vga, residual_type = \"pearson\")"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-lisa-cluster-maps","dir":"Articles","previous_headings":"7. Spatial Autocorrelation: plot_residual_autocorrelation() + plot_moran()","what":"Applied examples: LISA cluster maps","title":"Diagnostics and Validation","text":"Moran scatterplot:  Large city:  party:","code":"plot_moran(result_vga, variable = \"Lula\", type = \"lisa\") plot_moran(result_vga, variable = \"Lula\", type = \"moran\") plot_moran(result_bh, variable = \"Lula\", type = \"lisa\") plot_moran(result_nit, variable = \"PT\", type = \"lisa\")"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"interpretation-6","dir":"Articles","previous_headings":"7. Spatial Autocorrelation: plot_residual_autocorrelation() + plot_moran()","what":"Interpretation","title":"Diagnostics and Validation","text":"Significant Moran’s residuals (p < 0.05): model spatially structured error. Consider whether travel time data systematic problems certain areas. HH clusters Lula votes: Expected low-income neighborhoods (PT strongholds). presence validates interpolation preserves known political geography. HL/LH clusters: Spatial outliers — tracts high vote share surrounded low (vice versa). May indicate local effects data irregularities.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"intuition-7","dir":"Articles","previous_headings":"8. Baseline Comparisons: compare_baselines() + leave_one_out()","what":"Intuition","title":"Diagnostics and Validation","text":"optimized IDW actually better simpler alternatives? robust interpolation removing individual stations?","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"formal-definition-6","dir":"Articles","previous_headings":"8. Baseline Comparisons: compare_baselines() + leave_one_out()","what":"Formal definition","title":"Diagnostics and Validation","text":"Baselines: - Nearest: Wij*=1W_{ij^*} = 1 j*=argminjtijj^* = \\arg\\min_j t_{ij}, Wij=0W_{ij} = 0 otherwise (binary assignment closest station) - Uniform: Wij=1/mW_{ij} = 1/m (equal weight stations, column-normalized) - Areal: WW based spatial intersection areas tract station Voronoi cells Leave-one-: Remove station jj, predict demographics using remaining m−1m-1 stations full-model alpha values. Compare predicted vs actual. form --sample validation possible (tract-level ground truth).","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-compare_baselines","dir":"Articles","previous_headings":"8. Baseline Comparisons: compare_baselines() + leave_one_out()","what":"Applied examples: compare_baselines()","title":"Diagnostics and Validation","text":"","code":"compare_baselines(result_vga) #> Baseline comparison #> ----------------------------------------------------------------------  #>   Optimized IDW          RMSE=11.16  Deviance=16164.46 #>   Nearest station        RMSE=36.79  Deviance=157454.96  (IDW 70% better) #>   Uniform weights        RMSE=15.81  Deviance=34553.92  (IDW 29% better) #> ---------------------------------------------------------------------- compare_baselines(result_bh, methods = c(\"nearest\", \"uniform\")) #> Baseline comparison #> ----------------------------------------------------------------------  #>   Optimized IDW          RMSE=7.07  Deviance=143495.36 #>   Nearest station        RMSE=27.00  Deviance=1393922.64  (IDW 74% better) #>   Uniform weights        RMSE=12.96  Deviance=477898.82  (IDW 45% better) #> ----------------------------------------------------------------------"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-leave_one_out","dir":"Articles","previous_headings":"8. Baseline Comparisons: compare_baselines() + leave_one_out()","what":"Applied examples: leave_one_out()","title":"Diagnostics and Validation","text":"","code":"leave_one_out(result_igr) #>  #>   LOO: station 1 / 17 #>   LOO: station 2 / 17 #>   LOO: station 3 / 17 #>   LOO: station 4 / 17 #>   LOO: station 5 / 17 #>   LOO: station 6 / 17 #>   LOO: station 7 / 17 #>   LOO: station 8 / 17 #>   LOO: station 9 / 17 #>   LOO: station 10 / 17 #>   LOO: station 11 / 17 #>   LOO: station 12 / 17 #>   LOO: station 13 / 17 #>   LOO: station 14 / 17 #>   LOO: station 15 / 17 #>   LOO: station 16 / 17 #>   LOO: station 17 / 17 #> Leave-one-out RMSE: 7.2895 (mean), 7.1405 (median) #> Full model RMSE:    6.7769 #> LOO degradation:    7.6% leave_one_out(result_vga) #>  #>   LOO: station 1 / 30 #>   LOO: station 2 / 30 #>   LOO: station 3 / 30 #>   LOO: station 4 / 30 #>   LOO: station 5 / 30 #>   LOO: station 6 / 30 #>   LOO: station 7 / 30 #>   LOO: station 8 / 30 #>   LOO: station 9 / 30 #>   LOO: station 10 / 30 #>   LOO: station 11 / 30 #>   LOO: station 12 / 30 #>   LOO: station 13 / 30 #>   LOO: station 14 / 30 #>   LOO: station 15 / 30 #>   LOO: station 16 / 30 #>   LOO: station 17 / 30 #>   LOO: station 18 / 30 #>   LOO: station 19 / 30 #>   LOO: station 20 / 30 #>   LOO: station 21 / 30 #>   LOO: station 22 / 30 #>   LOO: station 23 / 30 #>   LOO: station 24 / 30 #>   LOO: station 25 / 30 #>   LOO: station 26 / 30 #>   LOO: station 27 / 30 #>   LOO: station 28 / 30 #>   LOO: station 29 / 30 #>   LOO: station 30 / 30 #> Leave-one-out RMSE: 12.1146 (mean), 12.0922 (median) #> Full model RMSE:    11.1614 #> LOO degradation:    8.5%"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"interpretation-7","dir":"Articles","previous_headings":"8. Baseline Comparisons: compare_baselines() + leave_one_out()","what":"Interpretation","title":"Diagnostics and Validation","text":"Positive improvement %: optimized IDW lower RMSE/deviance baseline. optimization adds value. Negative improvement %: happen. , optimization may overfitted data issues. LOO degradation: LOO RMSE comparable full-model RMSE. LOO RMSE much larger, model may overfitting specific station configurations.","code":""},{"path":[]},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"intuition-8","dir":"Articles","previous_headings":"9. Ecological Validation > 9a. Implied Turnout Rates: plot_turnout_rates()","what":"Intuition","title":"Diagnostics and Validation","text":"tract demographic bracket, implied turnout rate : ratei,b=fitted votersi,bcensus populationi,b\\text{rate}_{,b} = \\frac{\\text{fitted voters}_{,b}}{\\text{census population}_{,b}} Brazil, voting compulsory ages 18–69, expected turnout ~75–85%. 16–17 70+, voting optional rates lower. Rates exceeding 100% indicate tracts model allocates voters residents — signaling boundary effects registration mismatches.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-2","dir":"Articles","previous_headings":"9. Ecological Validation > 9a. Implied Turnout Rates: plot_turnout_rates()","what":"Applied examples","title":"Diagnostics and Validation","text":"Bracket boxplot:   Spatial pattern:  Faceted histogram:","code":"plot_turnout_rates(result_vga, type = \"bracket\") plot_turnout_rates(result_nit, type = \"bracket\") plot_turnout_rates(result_bh, type = \"map\") plot_turnout_rates(result_vga, type = \"histogram\")"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"interpretation-8","dir":"Articles","previous_headings":"9. Ecological Validation > 9a. Implied Turnout Rates: plot_turnout_rates()","what":"Interpretation","title":"Diagnostics and Validation","text":"Compulsory brackets clustering around 80%: Expected ages 18–69. Optional brackets lower: 16–17 70+ show lower turnout. Rates > 100%: Voters registered one municipality may actually reside another (commuters, students). boundary effects known limitation model.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"intuition-9","dir":"Articles","previous_headings":"9. Ecological Validation > 9b. Income-Vote Correlation: plot_income()","what":"Intuition","title":"Diagnostics and Validation","text":"negative correlation PT vote share income one best-documented patterns Brazilian political science (“PT-income gradient”). interpolation preserves gradient, builds confidence spatial allocation votes realistic. destroys , something wrong. Income data comes censobr (Census Bureau microdata), provides mean household head income tract. deflation applied — within single census year, correlation scale-invariant.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-3","dir":"Articles","previous_headings":"9. Ecological Validation > 9b. Income-Vote Correlation: plot_income()","what":"Applied examples","title":"Diagnostics and Validation","text":"Lula (PT) vs income — expect negative correlation:  Bolsonaro (PL) vs income — expect positive correlation:  Larger city:  Side--side maps:","code":"plot_income(result_vga, variable = \"Lula\", type = \"scatter\") plot_income(result_vga, variable = 22, type = \"scatter\") plot_income(result_bh, variable = \"Lula\", type = \"scatter\") plot_income(result_nit, variable = \"Lula\", type = \"map\")"},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"intuition-10","dir":"Articles","previous_headings":"9. Ecological Validation > 9c. Cross-Round Consistency: plot_ecological()","what":"Intuition","title":"Diagnostics and Validation","text":"Political geography sticky. Neighborhoods vote strongly candidate round 1 vote even strongly round 2 (2 candidates remain). high correlation turno 1 turno 2 tract-level vote shares validates interpolation preserves spatial patterns.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"applied-examples-4","dir":"Articles","previous_headings":"9. Ecological Validation > 9c. Cross-Round Consistency: plot_ecological()","what":"Applied examples","title":"Diagnostics and Validation","text":"Side--side maps:","code":"plot_ecological(result_vga, result_vga2,                 variable = \"Lula\", type = \"scatter\") plot_ecological(result_vga, result_vga2,                 variable = \"Lula\", type = \"map\")"},{"path":"https://antrologos.github.io/interpElections/articles/diagnostics.html","id":"interpretation-9","dir":"Articles","previous_headings":"9. Ecological Validation > 9c. Cross-Round Consistency: plot_ecological()","what":"Interpretation","title":"Diagnostics and Validation","text":"Strong positive correlation rounds: spatial patterns consistent, expected. method recovering stable partisan geography. Weak correlation: interpolation may injecting noise rather recovering signal. Investigate whether travel time data optimization causing problems.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/get-started.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Get Started with interpElections","text":"interpElections interpolates data source points (polling stations, schools, hospitals) target polygons (census tracts, districts, neighborhoods) using travel-time-based inverse distance weighting column-normalized weights. decay parameter zone calibrated known demographic totals, ensuring source totals conserved. start, install optional dependencies:","code":"setup_torch()     # GPU optimization (CUDA, MPS, or CPU fallback) setup_java()      # Java 21 for r5r travel-time routing"},{"path":"https://antrologos.github.io/interpElections/articles/get-started.html","id":"example-1-varginha-mg","dir":"Articles","previous_headings":"","what":"Example 1: Varginha (MG)","title":"Get Started with interpElections","text":"simplest way use interpElections Brazilian data interpolate_election_br() wrapper. downloads census data, electoral results, road networks automatically. console output shows progress: Three lines downloaded data, computed travel times, optimized parameters, interpolated vote counts 279 census tracts.  Compare two candidates side side:","code":"result_vga <- interpolate_election_br(   \"Varginha\", year = 2022,   cargo = \"presidente\",   what = c(\"candidates\", \"turnout\"),   keep = \"electoral_sf\" ) [1/9] Resolving municipality identifiers...   VARGINHA (MG) - IBGE: 3170701, TSE: 54135   Census year: 2022 (election 2022) [2/9] Preparing census population data... [3/9] Preparing census tract geometries... [4/9] Preparing electoral data... [5/9] Matching calibration brackets... [6/9] Downloading OSM road network... [7/9] Computing travel times... [8/9] Optimizing alpha...   PB-SGD colnorm (cpu, float32): full-data gradient, max 200 epochs   Completed 85 epochs (52.3s), objective=502,361 (converged) [9/9] Interpolating...   Interpolated 42 variables into 279 census tracts Done. result_vga interpElections result -- Brazilian election   Municipality: VARGINHA (MG)   IBGE: 3170701 | TSE: 54135 | Election: 2022 | Census: 2022   Census tracts: 279 | Sources: 37    Variables: 42     Candidates:    13 (CAND_30, CAND_44, CAND_12, CAND_13, ...)     Turnout:       1 (QT_COMPARECIMENTO)     Calibration:   gender x 7 age brackets    Optimizer: pb_sgd_colnorm_cpu (obj = 502361.44)   Alpha:     279 x 14 matrix [0.010, 20.000] (mean 3.027)    Contents:     result$tracts_sf       sf with census tracts + interpolated columns     result$interpolated    numeric matrix [279 x 42]     ... plot(result_vga, variable = \"Lula\") plot(result_vga, variable = c(\"Lula\", \"Bolsonaro\"), type = \"pct_tract\")"},{"path":"https://antrologos.github.io/interpElections/articles/get-started.html","id":"example-2-igrejinha-rs","dir":"Articles","previous_headings":"","what":"Example 2: Igrejinha (RS)","title":"Get Started with interpElections","text":"smaller city, workflow:  Different city, different spatial patterns, three-line workflow.","code":"result_igr <- interpolate_election_br(   \"Igrejinha\", year = 2022,   cargo = \"presidente\",   what = c(\"candidates\", \"turnout\") ) result_igr interpElections result -- Brazilian election   Municipality: IGREJINHA (RS)   IBGE: 4310108 | TSE: 87033 | Election: 2022 | Census: 2022   Census tracts: 85 | Sources: 17    Variables: 42     Candidates:    13 (CAND_13, CAND_12, CAND_30, CAND_22, ...)     Turnout:       1 (QT_COMPARECIMENTO)     Calibration:   gender x 7 age brackets    Optimizer: pb_sgd_colnorm_cpu (obj = 248107.37)   Alpha:     85 x 14 matrix [0.010, 15.682] (mean 4.089) plot(result_igr, variable = \"Lula\")"},{"path":"https://antrologos.github.io/interpElections/articles/get-started.html","id":"exploring-the-results","dir":"Articles","previous_headings":"","what":"Exploring the Results","title":"Get Started with interpElections","text":"result object several S3 methods inspection: See vignette(\"working--results\") full reference S3 methods, plot types, residual analysis, areal aggregation.","code":"# Detailed summary with per-variable statistics summary(result_vga)  # Alpha decay parameters (n x k matrix: tracts x brackets) head(coef(result_vga))  # Export as plain data frame (drops geometry) df <- as.data.frame(result_vga) head(df[, 1:5])  # Interactive map (opens in browser) plot_interactive(result_vga, variable = \"Lula\")"},{"path":"https://antrologos.github.io/interpElections/articles/get-started.html","id":"controlling-what-gets-interpolated","dir":"Articles","previous_headings":"","what":"Controlling What Gets Interpolated","title":"Get Started with interpElections","text":"parameter controls variables interpolated: Filter specific candidates parties: useful parameters: cargo: \"presidente\", \"governador\", \"senador\", \"deputado_federal\", \"deputado_estadual\", \"prefeito\", \"vereador\" turno: 1 (first round, default) 2 (runoff) census_year: auto-selected election year, override manually data(muni_crosswalk): lookup table 5,710 municipalities","code":"# Just candidates (default) result <- interpolate_election_br(\"Varginha\", year = 2022,   what = \"candidates\")  # Parties (aggregated by party abbreviation) result <- interpolate_election_br(\"Varginha\", year = 2022,   what = \"parties\")  # Turnout and abstention result <- interpolate_election_br(\"Varginha\", year = 2022,   what = \"turnout\")  # Voter demographics (gender, education) result <- interpolate_election_br(\"Varginha\", year = 2022,   what = \"demographics\")  # Everything at once result <- interpolate_election_br(\"Varginha\", year = 2022,   what = c(\"candidates\", \"parties\", \"turnout\", \"demographics\")) # By ballot number result <- interpolate_election_br(\"Varginha\", year = 2022,   cargo = \"presidente\", candidates = c(13, 22))  # By name (accent-insensitive substring matching) result <- interpolate_election_br(\"Varginha\", year = 2022,   cargo = \"presidente\", candidates = \"LULA\")  # Specific parties result <- interpolate_election_br(\"Varginha\", year = 2022,   what = \"parties\", parties = c(\"PT\", \"PL\"))"},{"path":"https://antrologos.github.io/interpElections/articles/get-started.html","id":"whats-happening-under-the-hood","dir":"Articles","previous_headings":"","what":"What’s Happening Under the Hood","title":"Get Started with interpElections","text":"wrapper interpolate_election_br() calls internal steps sequence (don’t need call directly): See vignette(\"methodology\") full technical treatment equations, visualizations, worked examples using real data.","code":"# 1. Census population by age bracket (internal) pop_data <- interpElections:::br_prepare_population(\"Varginha\", year = 2022)  # 2. Census tract geometries with population columns (internal) tracts_sf <- interpElections:::br_prepare_tracts(3170701, pop_data)  # 3. Electoral data at polling stations (internal) electoral <- interpElections:::br_prepare_electoral(   code_muni_ibge = \"3170701\", code_muni_tse = \"54135\",   uf = \"MG\", year = 2022, cargo = \"presidente\",   what = c(\"candidates\", \"turnout\") )  # 4. Travel times via r5r walking routes time_matrix <- compute_travel_times(tracts_sf, electoral_sf)  # 5. Optimize per-tract decay parameters optim_result <- optimize_alpha(time_matrix, pop_matrix, source_matrix)  # 6. Use weight matrix from optimization and interpolate W <- optim_result$W interpolated <- W %*% electoral_data"},{"path":"https://antrologos.github.io/interpElections/articles/get-started.html","id":"custom-data-any-point-to-polygon-problem","dir":"Articles","previous_headings":"","what":"Custom Data: Any Point-to-Polygon Problem","title":"Get Started with interpElections","text":"interpElections works point--polygon disaggregation, just Brazilian elections. synthetic example: Conservation: interpolated total matches source total exactly.","code":"library(interpElections)  # Synthetic data: 5 zones, 3 sources, 2 calibration variables set.seed(42) tt <- matrix(   c(5, 15, 30, 25, 40,     20, 8, 12, 35, 45,     35, 30, 18, 10, 7),   nrow = 5, ncol = 3,   dimnames = list(paste0(\"zone_\", 1:5), paste0(\"src_\", 1:3)) )  # Calibration: population counts known at both levels pop_matrix <- matrix(   c(100, 300, 150, 200, 250,   # young population per zone     80, 250, 120, 180, 220),   # old population per zone   nrow = 5, ncol = 2,   dimnames = list(NULL, c(\"pop_young\", \"pop_old\")) )  source_matrix <- matrix(   c(250, 400, 350,    # young counts at sources     210, 350, 290),   # old counts at sources   nrow = 3, ncol = 2,   dimnames = list(NULL, c(\"count_young\", \"count_old\")) )  # Optimize alpha (uses per-bracket SGD) optim_result <- optimize_alpha(   time_matrix = tt + 1,   # offset already applied   pop_matrix = pop_matrix,   source_matrix = source_matrix,   offset = 0,             # offset already in tt   verbose = FALSE )  cat(\"Optimized alpha (5 x 2 matrix):\\n\") #> Optimized alpha (5 x 2 matrix): print(round(optim_result$alpha, 2)) #>      [,1] [,2] #> [1,] 2.69 2.62 #> [2,] 1.89 1.85 #> [3,] 1.90 1.88 #> [4,] 1.68 1.59 #> [5,] 1.66 1.57  # Use weight matrix from optimization W <- optim_result$W  # Interpolate a variable measured at sources revenue <- c(5000, 8000, 6500) interpolated_revenue <- as.numeric(W %*% revenue)  cat(\"Source total:\", sum(revenue), \"\\n\") #> Source total: 19500 cat(\"Interpolated total:\", round(sum(interpolated_revenue)), \"\\n\") #> Interpolated total: 19500 cat(\"Per-zone:\", round(interpolated_revenue), \"\\n\") #> Per-zone: 1965 5867 2865 3969 4835"},{"path":"https://antrologos.github.io/interpElections/articles/get-started.html","id":"core-functions-maximum-flexibility","dir":"Articles","previous_headings":"","what":"Core Functions: Maximum Flexibility","title":"Get Started with interpElections","text":"full control, use core functions directly:","code":"# Load bundled example data tt  <- readRDS(system.file(\"extdata/example_tt_matrix.rds\",                             package = \"interpElections\")) pop <- readRDS(system.file(\"extdata/example_pop_matrix.rds\",                             package = \"interpElections\")) src <- readRDS(system.file(\"extdata/example_source_matrix.rds\",                             package = \"interpElections\"))  # Optimize result <- optimize_alpha(tt, pop, src, verbose = FALSE) result #> interpElections optimization result #>   Method:      pb_sgd_colnorm_cpu #>   Loss fn:     poisson #>   Objective:   11.5241 #>   Convergence: 0 #>   Alpha:       20 x 3 matrix (tracts x brackets) #>   Alpha range: [1.308, 3.763] #>   Epochs:      1252 #>   Elapsed:     9.6 secs  # Weight matrix is returned from optimization W <- result$W  # Verify conservation cat(\"Column sums (should be ~1):\", round(colSums(W), 4), \"\\n\") #> Column sums (should be ~1): 1 1 1 1 1 1 1 1 cat(\"Row sum range:\", round(range(rowSums(W)), 4), \"\\n\") #> Row sum range: 0.3503 0.4517"},{"path":"https://antrologos.github.io/interpElections/articles/get-started.html","id":"next-steps","dir":"Articles","previous_headings":"","what":"Next Steps","title":"Get Started with interpElections","text":"vignette(\"methodology\"): full pipeline walkthrough equations, visualizations, real-data examples Varginha (MG) vignette(\"working--results\"): S3 methods, plot types, residual analysis, areal aggregation Niteroi Belo Horizonte examples","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"why-sub-municipal-electoral-geography-matters","dir":"Articles","previous_headings":"Part I: Motivation and Pipeline Overview","what":"1. Why Sub-Municipal Electoral Geography Matters","title":"Methodology","text":"Electoral analysis Brazil faces fundamental data gap. Votes counted polling stations — points map, geographic zones. Superior Electoral Court (TSE) publishes detailed results per station: many votes candidate received, turnout statistics, age gender composition registered voters. polling stations defined geographic boundaries. voter lives tract walks past tract B may vote station located tract C. Meanwhile, Census Bureau (IBGE) organizes demographic data census tracts — small geographic polygons known population counts age, gender, education, income. tracts finest spatial unit demographic data available. question : neighborhood vote? answer , need bridge two incompatible data systems: point-level electoral data polygon-level census data. package .","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"age-structure-as-a-proxy-for-socioeconomic-status","dir":"Articles","previous_headings":"Part I: Motivation and Pipeline Overview > 1. Why Sub-Municipal Electoral Geography Matters","what":"Age structure as a proxy for socioeconomic status","title":"Methodology","text":"bridge two systems age structure population. Age brackets observed levels: census records many people age live tract, TSE records many voters age voted station. age structure useful? encodes far just demographics. Brazilian cities, age composition neighborhood strongly correlated socioeconomic profile. Consider two neighborhoods Rio de Janeiro:   Rocinha, one Brazil’s largest favelas, young population: large cohorts 18–29 age range, tapering sharply 50. Copacabana, one Rio’s wealthiest neighborhoods, shows opposite pattern: narrower base young adults large proportion residents 50. difference reflects fertility rates, life expectancy, migration patterns tightly linked income, education, living conditions. Census tract codes. Neighborhoods defined aggregating IBGE 2022 census tracts whose centroids fall within 2010 neighborhood boundaries (via geobr::read_neighborhood()). Rocinha comprises 115 tracts (codes starting 330455705330, subdistrict 0533); Copacabana comprises 420 tracts (codes starting 330455705100, subdistrict 0510). Tracts shown green map zero population excluded interpolation. age signatures differ systematically across neighborhoods, carry information socioeconomic composition — , extension, voting behavior. method describe exploits : finds weights reproduce census age structure tract applied station-level voter data. weights correct demographics, also produce good estimates vote counts.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-problem-many-to-many-spatial-disaggregation","dir":"Articles","previous_headings":"Part I: Motivation and Pipeline Overview","what":"2. The Problem: Many-to-Many Spatial Disaggregation","title":"Methodology","text":"Imagine researcher wants know Copacabana voted 2022 presidential election. TSE can tell polling station area voted. several things make harder seems: One station, many neighborhoods: school Botafogo may receive voters Botafogo, Laranjeiras, even Santa Marta favela hill. station’s vote total mix populations. One neighborhood, many stations: Copacabana voters may assigned polling stations Copacabana , neighboring Ipanema, Leme. neighborhood’s voters split across multiple stations. lookup table: unlike countries, official mapping residential addresses polling stations. relationship many--many, administrative data resolve . standard areal interpolation problem. areal interpolation, source target polygons, overlap area provides natural weights. , sources points (stations), polygons. Area-weighted interpolation apply. simple point--polygon assignment: since mapping many--many, assigning tract nearest station (Voronoi) lose information produce poor estimates (demonstrate Section 17).","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-approach-estimating-the-association-structure","dir":"Articles","previous_headings":"Part I: Motivation and Pipeline Overview > 2. The Problem: Many-to-Many Spatial Disaggregation","what":"The approach: estimating the association structure","title":"Methodology","text":"solution estimates association structure tracts stations — weight matrix WW dimension [N×M][N \\times M] entry WijW_{ij} captures much station jj “serves” tract ii. Two fundamental properties enforced: Source conservation (column constraint): station distributes exactly 100% data. total votes municipality preserved exactly: ∑iWij=1\\sum_i W_{ij} = 1 jj. Population proportionality (row constraint): tract receives total weight proportional population share: ∑jWij∝popi\\sum_j W_{ij} \\propto \\text{pop}_i. method assume fixed assignment voters stations. Instead, estimates smooth probabilistic mapping, calibrated known demographic data.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"walking-to-vote-a-behavioral-assumption","dir":"Articles","previous_headings":"Part I: Motivation and Pipeline Overview > 2. The Problem: Many-to-Many Spatial Disaggregation","what":"Walking to vote: a behavioral assumption","title":"Methodology","text":"key behavioral assumption voters walk polling stations. grounds spatial model: closer stations receive weight voters likely walk . assumption supported empirical evidence. Pereira et al. (2023) studied effect free public transit election day Brazilian cities, finding increased turnout — implying transportation costs (including walking distance) meaningful barrier. Brazilian electoral law requires voters assigned polling stations near registered address, reinforcing spatial proximity assumption. Pereira, R. H. M., Braga, C. K. V., Serra, B., & Nadalin, V. (2023). “Free public transit voter turnout.” Available : https://www.urbandemographics.org/files/2023_Pereira_et_al_free_public_transit_voter_turnout.pdf second important assumption voters reside municipality registered vote, municipality captured census. residential assumption allows us use census population data target distribution: age structure voters polling station reflect age structure surrounding population. Without assumption, calibration step valid. use realistic walking travel times computed OpenStreetMap road network, straight-line distances. Mountains, rivers, street layout affect actual travel time captured routing engine (see Section 9).","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"pipeline-overview","dir":"Articles","previous_headings":"Part I: Motivation and Pipeline Overview","what":"3. Pipeline Overview","title":"Methodology","text":"full interpolation pipeline six steps: Census data: population counts age bracket per tract (br_prepare_population()) Tract geometries: census tract polygons IBGE (br_prepare_tracts()) Electoral data: votes, turnout, voter demographics per station (br_prepare_electoral()) Travel times: walking routes tract representative points stations (compute_travel_times()) Optimization: find per-tract decay parameters α\\alpha minimize demographic mismatch (optimize_alpha()) Interpolation: use column-normalized weight matrix optimization (rebuild compute_weight_matrix()) apply station-level variable (X̂=W×V\\hat{X} = W \\times V) convenience function interpolate_election_br() wraps six steps single call Brazilian municipalities, handling data downloads, geocoding, default parameter selection automatically.  figure illustrates spatial data layers involved. Starting bottom: municipality boundary, census tracts colored population, polling station locations, final interpolated results tract level.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"census-population-data","dir":"Articles","previous_headings":"Part II: Data","what":"4. Census Population Data","title":"Methodology","text":"data frame also includes calibration columns cross gender (male/female) × 7 age brackets. calibration variables bridge census tracts polling stations. 7 brackets built. TSE voter profile data records voters 12 finer age bins (18, 19, 20, 21–24, 25–29, 30–34, 35–39, 40–44, 45–49, 50–54, 55–59, 60–64, 65–69). br_prepare_electoral() aggregates 7 groups align census age brackets. 2022 Census — reports 15–19 group instead 18–20 — package applies 2/52/5 proxy approximate 18–19 voting-age share. 7 matched brackets key insight: observed levels (census tracts polling stations), enabling calibration. calibration crosses gender × 7 age groups (14 brackets), providing strong spatial signal optimizer must simultaneously match spatial distribution gender–age subgroup.","code":"pop_data <- br_prepare_population(\"3170701\", year = 2022) head(pop_data[, 1:10]) code_tract    code_muni pop_00_04 pop_05_09 pop_10_14 pop_15_19 pop_20_24 pop_25_29 pop_30_39 pop_40_49 1 3170701xxxxx  3170701      68        68        62        88        68        58       144       129 2 3170701xxxxx  3170701      37        36        47        38        47        44        83        95 ..."},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"census-tract-geometries","dir":"Articles","previous_headings":"Part II: Data","what":"5. Census Tract Geometries","title":"Methodology","text":"downloads tract geometries geobr, removes green areas (parks, water bodies zero population), transforms EPSG:5880 (equal-area projection accurate spatial operations), joins population columns.  Note urban-rural gradient: small, densely populated tracts city center; large, sparsely populated tracts periphery.","code":"tracts_sf <- br_prepare_tracts(3170701, pop_data)"},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"electoral-data-at-polling-stations","dir":"Articles","previous_headings":"Part II: Data","what":"6. Electoral Data at Polling Stations","title":"Methodology","text":"result contains one row per polling station : Vote columns (CAND_13, CAND_22, …): votes per candidate (ballot number suffix; 95 = blank, 96 = null) Turnout (QT_COMPARECIMENTO): total voters showed Voter age profiles (votantes_18_20, …, votantes_65_69): TSE’s fine-grained age registration brackets, aggregated match 7 census brackets Coordinates (lat, long): geocoded polling station locations Column dictionary: attr(electoral, \"column_dictionary\") contains metadata column (type, cargo, candidate name, party) parameter controls gets included: \"candidates\": one column per candidate \"parties\": aggregated party (PARTY_PT, PARTY_PL, …) \"turnout\": QT_COMPARECIMENTO, QT_APTOS, QT_ABSTENCOES \"demographics\": GENERO_* EDUC_* columns","code":"electoral <- br_prepare_electoral(   code_muni_ibge = \"3170701\",   code_muni_tse  = \"54135\",   uf = \"MG\", year = 2022,   cargo = \"presidente\", turno = 1,   what = c(\"candidates\", \"turnout\") )"},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"calibration-variables-comparing-source-and-target","dir":"Articles","previous_headings":"Part II: Data","what":"7. Calibration Variables: Comparing Source and Target","title":"Methodology","text":"calibration variables bridge census tracts polling stations. age brackets observed levels: Census: “many people aged 18–20 live tract?” (IBGE) Electoral: “many registered voters aged 18–20 voted station?” (TSE) age brackets saw distinguishing Rocinha Copacabana Section 1. demographic signature varies across neighborhoods precisely method uses calibrate weights.  shapes similar totals differ: census counts residents, TSE counts registered voters. everyone voting age registered, registration rates vary age bracket. optimization finds alpha values interpolated voter age profiles match census age profiles tract. weights correct demographics, also correct vote counts.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"representative-points-from-tracts-to-routable-origins","dir":"Articles","previous_headings":"Part III: Geography","what":"8. Representative Points: From Tracts to Routable Origins","title":"Methodology","text":"Routing engines need point--point queries, tracts polygons. need single representative point per tract. Three methods available: choice representative point matters large, irregularly shaped tracts rural peri-urban areas. Consider southern periphery São Paulo, census tracts extend several square kilometers mixed urban forested land:  three-panel comparison shows set large tracts south São Paulo. red dots (centroids) frequently fall uninhabited areas — middle Mata Atlântica forest empty fields. blue dots (point surface) guaranteed inside polygon, may still far people actually live. green dots (pop-weighted) use WorldPop population raster find densely populated cell within tract, placing representative point residents actually .  Zooming largest tract, centroid falls dense forest pop-weighted point correctly identifies settlement area. difference can affect travel time calculations tens minutes. pop_weighted method downloads WorldPop Brazil Constrained 2020 raster (~48 MB, cached) finds raster cell highest population density within tract. min_area_for_pop_weight parameter (default: 1 km²) controls threshold: tracts smaller use point_on_surface regardless chosen method, since small urban tracts dense enough interior point reasonable proxy.","code":"pts_pos <- compute_representative_points(tracts_sf,   method = \"point_on_surface\") pts_pop <- compute_representative_points(tracts_sf,   method = \"pop_weighted\")"},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"why-walking-travel-time","dir":"Articles","previous_headings":"Part III: Geography > 9. Travel Times: Building the Distance Matrix","what":"9.1 Why walking travel time?","title":"Methodology","text":"Brazil, voters assigned polling stations near registered address. election day, voters walk polling station. merely assumption convenience — grounded geographic design Brazilian electoral system empirical evidence. Pereira et al. (2023) studied introduction free public transit election days Brazilian cities. finding free transit significantly increased turnout implies cost getting polls — primarily walking distance — real barrier affects participation. distance matters whether people vote , certainly matters vote. therefore use realistic walking travel times computed OpenStreetMap road network, Euclidean (straight-line) distances. routing engine (r5r) accounts actual street layout, elevation, one-way streets, pedestrian paths, physical barriers.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"euclidean-distance-vs--walking-routes","dir":"Articles","previous_headings":"Part III: Geography > 9. Travel Times: Building the Distance Matrix","what":"9.2 Euclidean distance vs. walking routes","title":"Methodology","text":"just use straight-line distance? geography creates dramatic discrepancies Euclidean distance actual walking time. Two examples: Example 1: Mountain barrier (Rio de Janeiro) point Botafogo neighborhood lies base Corcovado/Sumaré hills. polling station Laranjeiras sits side. straight line, distance modest — walking route must navigate around steep terrain:  solid blue line shows actual walking route computed r5r OSM road network. dotted red line shows straight-line distance. mountainous terrain, can differ factor 3–5x. Example 2: Water barrier (Recife) point Boa Vista neighborhood destination Brasília Teimosa peninsula separated Recife’s waterways. walking route must navigate around estuary cross bridges, adding significant distance compared straight line.  Example 3: Water barrier (Florianópolis) Florianópolis, capital Santa Catarina, split mainland island Atlantic. point Coqueiros (mainland) destination Costeira Pirajubaé (island) separated bay. walking route must detour one bridges connecting two sides:  examples illustrate Euclidean distance poor proxy actual accessibility — routing engine matters.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"building-the-travel-time-matrix","dir":"Articles","previous_headings":"Part III: Geography > 9. Travel Times: Building the Distance Matrix","what":"9.3 Building the travel time matrix","title":"Methodology","text":"builds [N tracts × M stations] matrix walking travel times minutes, using r5r routing engine OpenStreetMap data. Origins: representative points (Section 8) Destinations: polling station coordinates Mode: walking (default), configurable Max trip duration: 300 minutes; unreachable pairs get value OSM data downloaded via download_r5r_data(), fetches state-level .pbf files clips municipality bounding box using osmium.  heatmap shows spatial structure: block-diagonal pattern nearby tract-station pairs short travel times.  Tracts center short travel times nearest station; peripheral tracts farther away. offset: applying IDW kernel, add 1 travel times (time_matrix + 1) avoid singularity t=0t = 0.","code":"time_matrix <- compute_travel_times(   tracts_sf = tracts_sf,   points_sf = electoral_sf,   network_path = network_path,   tract_id = \"id\",   point_id = \"id\" )"},{"path":[]},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"intuition-gravitational-pull","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 10. The IDW Kernel: Turning Distance into Influence","what":"Intuition: gravitational pull","title":"Methodology","text":"Think polling station exerting “gravitational pull” nearby tracts. Closer stations pull harder. IDW (Inverse Distance Weighting) kernel translates intuition numbers: given travel time tract station, produces weight decreases distance.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"a-concrete-example","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 10. The IDW Kernel: Turning Distance into Influence","what":"A concrete example","title":"Methodology","text":"Suppose tract three nearby stations 5, 12, 30 minutes walking distance. much station contribute tract’s estimate? decay parameter α=2\\alpha = 2: nearest station (5 min) gets lion’s share weight. 30-minute station contributes little.","code":"tt <- c(5, 12, 30)  # travel times in minutes alpha <- 2 raw_weights <- (tt + 1)^(-alpha) normalized <- raw_weights / sum(raw_weights) cat(\"Travel times:\", tt, \"minutes\\n\") #> Travel times: 5 12 30 minutes cat(\"Raw weights: \", round(raw_weights, 5), \"\\n\") #> Raw weights:  0.02778 0.00592 0.00104 cat(\"Normalized:  \", round(normalized, 3), \"\\n\") #> Normalized:   0.8 0.17 0.03 cat(\"The 5-min station gets\", round(normalized[1] * 100),     \"% of this tract's weight\\n\") #> The 5-min station gets 80 % of this tract's weight"},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-formula","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 10. The IDW Kernel: Turning Distance into Influence","what":"The formula","title":"Methodology","text":"raw weight tract ii station jj: Wijraw=(tij+1)−αiW^{\\text{raw}}_{ij} = (t_{ij} + 1)^{-\\alpha_i} : tijt_{ij}: travel time tract ii station jj (minutes) αi\\alpha_i: decay parameter tract ii (optimized)","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"how-alpha-controls-the-decay","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 10. The IDW Kernel: Turning Distance into Influence","what":"How alpha controls the decay","title":"Methodology","text":"α=0.5\\alpha = 0.5: nearly flat — stations contribute almost equally α=2\\alpha = 2: moderate — stations within 10 minutes dominate α=10\\alpha = 10: steep cliff — nearest station matters","code":"tt_range <- 0:60 alphas <- c(0.5, 1, 2, 5, 10) decay_df <- do.call(rbind, lapply(alphas, function(a) {   data.frame(time = tt_range, weight = (tt_range + 1)^(-a),              alpha = paste0(\"alpha = \", a)) })) decay_df$alpha <- factor(decay_df$alpha,                           levels = paste0(\"alpha = \", alphas))  library(ggplot2) ggplot(decay_df, aes(x = time, y = weight, color = alpha)) +   geom_line(linewidth = 0.8) +   scale_y_log10() +   labs(title = \"Weight Decay Curves\",        subtitle = \"Higher alpha = steeper decay = more concentrated weights\",        x = \"Travel time (minutes)\", y = \"Weight (log scale)\",        color = \"\") +   theme_minimal() +   theme(plot.title = element_text(face = \"bold\"),         legend.position = \"right\")"},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"why-per-tract-alpha","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 10. The IDW Kernel: Turning Distance into Influence","what":"Why per-tract alpha?","title":"Methodology","text":"single global α\\alpha capture heterogeneity urban geography. Urban centers many overlapping station catchments — tracts need low α\\alpha spread weight across several stations. Isolated peripheral tracts one nearby station need high α\\alpha concentrate weight. optimizer finds best α\\alpha tract independently.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"why-single-sided-standardization-fails","dir":"Articles","previous_headings":"Part IV: The Weight Matrix","what":"11. Why Single-Sided Standardization Fails","title":"Methodology","text":"describing column normalization approach used package, let us understand simpler row-based approaches work. need normalize raw weight matrix weights sum meaningful quantities. two natural choices — column normalization provides guarantee need.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"column-only-standardization","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 11. Why Single-Sided Standardization Fails","what":"11.1 Column-only standardization","title":"Methodology","text":"first approach: divide column sum station distributes 100% data: Wijcol=Wijraw∑iWijrawW^{\\text{col}}_{ij} = \\frac{W^{\\text{raw}}_{ij}}{\\sum_i W^{\\text{raw}}_{ij}} Column sums = 1 (source conservation: every vote distributed exactly ). constraint row sums. Tract 1 10% population receives disproportionate share close station 1. Municipal totals preserved, distribution across tracts wrong.","code":"# Toy example: 5 tracts, 3 stations tt_toy <- matrix(   c(2,  10, 25, 30, 50,   # station 1: close to tract 1     15,  3, 12, 28, 45,   # station 2: close to tract 2     40, 35, 20,  5,  8),  # station 3: close to tracts 4-5   nrow = 5, ncol = 3 ) pop_toy <- c(100, 300, 150, 200, 250)  # population per tract  alpha_toy <- rep(2, 5) W_raw <- (tt_toy + 1)^(-alpha_toy)  # Column standardize W_col <- t(t(W_raw) / colSums(W_raw))  cat(\"Column sums (should be 1 — OK):\\n\") #> Column sums (should be 1 — OK): round(colSums(W_col), 4) #> [1] 1 1 1  cat(\"\\nRow sums (uncontrolled — BAD):\\n\") #>  #> Row sums (uncontrolled — BAD): round(rowSums(W_col), 4) #> [1] 0.9751 0.9300 0.1439 0.6594 0.2917  cat(\"\\nPopulation shares (what rows should look like):\\n\") #>  #> Population shares (what rows should look like): round(pop_toy / sum(pop_toy) * 3, 4) #> [1] 0.30 0.90 0.45 0.60 0.75"},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"row-only-standardization","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 11. Why Single-Sided Standardization Fails","what":"11.2 Row-only standardization","title":"Methodology","text":"opposite approach: normalize rows match population shares. Now rows correct, column sums wrong. stations “distribute” 100% votes, others less 100%. municipal total longer conserved: multiply weights vote counts, get (fewer) total votes actually existed.","code":"# Row standardize to population-proportional targets m <- ncol(tt_toy) row_targets_toy <- pop_toy / sum(pop_toy) * m  W_row <- W_raw * (row_targets_toy / rowSums(W_raw))  cat(\"Row sums (should match population targets — OK):\\n\") #> Row sums (should match population targets — OK): round(rowSums(W_row), 4) #> [1] 0.30 0.90 0.45 0.60 0.75  cat(\"\\nColumn sums (should be 1 — BAD):\\n\") #>  #> Column sums (should be 1 — BAD): round(colSums(W_row), 4) #> [1] 0.5038 1.1226 1.3736"},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-choice-column-normalization","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 11. Why Single-Sided Standardization Fails","what":"The choice: column normalization","title":"Methodology","text":"Column-: preserves totals (source conservation) — every vote distributed exactly . spatial distribution across tracts governed optimized alpha parameters, calibrated census demographics. Row-: distributes correctly preserve totals. Column normalization right choice source conservation non-negotiable constraint: must create destroy votes. alpha optimization (Section 13) takes care making row-side distribution match census demographics closely possible.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-idea-preserving-station-totals","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 12. Column Normalization: Source Conservation","what":"12.1 The idea: preserving station totals","title":"Methodology","text":"core constraint source conservation: polling station must distribute exactly 100% data. station recorded 500 votes, interpolation must assign exactly 500 votes across tracts — , less. Column normalization enforces directly: divide column raw weight matrix sum station’s weights sum 1. Wij=Kij∑iKijW_{ij} = \\frac{K_{ij}}{\\sum_i K_{ij}} Kij=(tij+1)−αiK_{ij} = (t_{ij} + 1)^{-\\alpha_i} IDW kernel Section 10.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"worked-example","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 12. Column Normalization: Source Conservation","what":"12.2 Worked example","title":"Methodology","text":"station distributes exactly 100% data. distribution across tracts determined IDW kernel: tracts closer station receive weight. alpha optimization (Section 13) adjusts decay parameters resulting tract-level estimates match census demographics closely possible. Key properties: Source conservation: column sums exactly 1 Non-negative: weights non-negative Deterministic: iterative procedure, just single division Unreachable tracts (-zero rows) remain zero flagged","code":"# Using the toy example from Section 11 # W_raw is already defined: 5 tracts, 3 stations W_col <- t(t(W_raw) / colSums(W_raw))  cat(\"Column sums (should be 1 — source conservation):\\n\") #> Column sums (should be 1 — source conservation): round(colSums(W_col), 4) #> [1] 1 1 1  cat(\"\\nRow sums (governed by alpha — not explicitly constrained):\\n\") #>  #> Row sums (governed by alpha — not explicitly constrained): round(rowSums(W_col), 4) #> [1] 0.9751 0.9300 0.1439 0.6594 0.2917  cat(\"\\nWeight matrix:\\n\") #>  #> Weight matrix: print(round(W_col, 4)) #>        [,1]   [,2]   [,3] #> [1,] 0.9087 0.0528 0.0136 #> [2,] 0.0676 0.8448 0.0176 #> [3,] 0.0121 0.0800 0.0518 #> [4,] 0.0085 0.0161 0.6348 #> [5,] 0.0031 0.0064 0.2821"},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-problem-age-groups-have-different-geographies","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 12. Column Normalization: Source Conservation > 12.3 Per-Bracket Column Normalization","what":"The problem: age groups have different geographies","title":"Methodology","text":"Think spatial distribution voters age. Young adults (18–24) cluster near universities, cheap rental apartments, transit corridors. Elderly voters (60–69) concentrate established neighborhoods, retirement communities, areas healthcare facilities. spatial patterns differ substantially — yet single weight matrix must allocate age groups simultaneously. aggregate column normalization, weight matrix one set weights age brackets. optimizer must find one set weights simultaneously matches multiple different demographic distributions. inherent compromise: weights correctly distribute 18–20 year-olds may systematically misallocate 60–69 year-olds, vice versa.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-per-bracket-extension","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 12. Column Normalization: Source Conservation > 12.3 Per-Bracket Column Normalization","what":"The per-bracket extension","title":"Methodology","text":"Per-bracket column normalization addresses building separate column-normalized weight matrix demographic bracket k=1,…,Kk = 1, \\ldots, K. Instead one weight matrix WW, build KK bracket-specific matrices W(1),…,W(K)W^{(1)}, \\ldots, W^{(K)}, column-normalized independently: bracket kk: Compute IDW kernel: Kij(k)=(tij+1)−αiK^{(k)}_{ij} = (t_{ij} + 1)^{-\\alpha_{}} (kernel brackets, since alpha shared) Column-normalize: Wij(k)=Kij(k)/∑iKij(k)W^{(k)}_{ij} = K^{(k)}_{ij} / \\sum_i K^{(k)}_{ij} Aggregate: Wtotal=1K∑k=1KW(k)W_{\\text{total}} = \\frac{1}{K} \\sum_{k=1}^{K} W^{(k)} followed final column normalization enforce source conservation (station distributes exactly 100% data).","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"why-this-works","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 12. Column Normalization: Source Conservation > 12.3 Per-Bracket Column Normalization","what":"Why this works","title":"Methodology","text":"bracket’s column-normalized weights distribute bracket’s station-level data across tracts proportionally IDW kernel. alpha optimization (Section 13) adjusts decay parameters resulting interpolated demographics match census demographics across brackets simultaneously. per-bracket structure allows loss function separately account age group’s spatial pattern. alpha optimization reduces SSE finding per-tract decay parameters best match demographic distributions.","code":"# Bracket 1 (\"young\"): concentrated near station 1 # Bracket 2 (\"old\"): concentrated near station 3 pop_young <- c(60, 100, 50, 30, 20)   # young pop per tract pop_old   <- c(40, 200, 100, 170, 230) # old pop per tract  src_young <- c(150, 70, 40)  # young voters per station src_old   <- c(100, 330, 310) # old voters per station  # Per-bracket column normalization: each bracket uses the same # column-normalized kernel W_col <- t(t(W_raw) / colSums(W_raw))  # Interpolate both brackets young_hat <- as.numeric(W_col %*% src_young) old_hat   <- as.numeric(W_col %*% src_old)  cat(\"=== Young bracket ===\\n\") #> === Young bracket === cat(\"Census truth:     \", pop_young, \"\\n\") #> Census truth:      60 100 50 30 20 cat(\"Column-normalized:\", round(young_hat), \"\\n\") #> Column-normalized: 141 70 9 28 12 cat(\"SSE:             \", round(sum((young_hat - pop_young)^2)), \"\\n\") #> SSE:              9095  cat(\"\\n=== Old bracket ===\\n\") #>  #> === Old bracket === cat(\"Census truth:     \", pop_old, \"\\n\") #> Census truth:      40 200 100 170 230 cat(\"Column-normalized:\", round(old_hat), \"\\n\") #> Column-normalized: 113 291 44 203 90 cat(\"SSE:             \", round(sum((old_hat - pop_old)^2)), \"\\n\") #> SSE:              37428 # Visual comparison: census truth vs column-normalized estimate pop_mat_toy <- cbind(young = pop_young, old = pop_old) comparison_df <- data.frame(   tract = rep(1:5, 4),   value = c(pop_young, pop_old, young_hat, old_hat),   bracket = rep(c(\"Young\", \"Old\", \"Young\", \"Old\"), each = 5),   source = rep(c(\"Census truth\", \"Census truth\",                   \"Column-normalized estimate\",                   \"Column-normalized estimate\"),                each = 5) )  ggplot(comparison_df,        aes(x = factor(tract), y = value, fill = source)) +   geom_col(position = \"dodge\", width = 0.7) +   facet_wrap(~bracket, scales = \"free_y\") +   scale_fill_manual(values = c(\"Census truth\" = \"#4575b4\",                                 \"Column-normalized estimate\" = \"#fdae61\")) +   labs(title = \"Per-Bracket Column Normalization: Recovery of Age-Group Profiles\",        x = \"Tract\", y = \"Population\", fill = \"\") +   theme_minimal() +   theme(plot.title = element_text(face = \"bold\"),         legend.position = \"bottom\")"},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"connection-to-the-optimizer","dir":"Articles","previous_headings":"Part IV: The Weight Matrix > 12. Column Normalization: Source Conservation > 12.3 Per-Bracket Column Normalization","what":"Connection to the optimizer","title":"Methodology","text":"optimization (Section 14), per-bracket column normalization performed 3D tensors shape [ka x n x m], ka number active demographic brackets. vectorizes KK separate normalization operations single batched computation GPU CPU. optimization, weight matrix WW returned directly optimize_alpha() result$W. can also recomputed pre-existing alpha values using compute_weight_matrix(): pop_matrix source_matrix provided, function automatically uses per-bracket mode.","code":"# W is already in the optimization result W <- optim_result$W  # Or recompute from alpha W <- compute_weight_matrix(time_matrix, alpha,   pop_matrix = pop_matrix,   source_matrix = source_matrix)"},{"path":[]},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-key-insight","dir":"Articles","previous_headings":"Part V: Calibration and Optimization > 13. The Calibration Objective","what":"13.1 The key insight","title":"Methodology","text":"ingredients: travel times, IDW kernel parametrized α\\alpha, column normalization enforce source conservation. Now need find right α\\alpha. calibration logic: weights correct, interpolating voter age profiles stations recover census age profiles tract. Consider concrete example. Census data says tract X 200 people aged 30–39. weights good, multiplying weight row tract X station-level voter counts 30–39 age bracket give us approximately 200. gives 150 300, weights wrong — geographic allocation biased. optimization finds α\\alpha values minimize mismatch across tracts age brackets simultaneously.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-iterative-procedure","dir":"Articles","previous_headings":"Part V: Calibration and Optimization > 13. The Calibration Objective","what":"13.2 The iterative procedure","title":"Methodology","text":"optimization loop:  words: Initialize: set αi=1\\alpha_i = 1 tracts (moderate decay) Build IDW kernel: compute raw weights travel times current α\\alpha Column-normalize: enforce source conservation (column sums = 1) Interpolate demographics: multiply normalized weights station-level age profiles Compare census: compute squared error interpolated census age profiles Adjust α\\alpha: use gradient (via automatic differentiation) nudge α\\alpha direction reduces error Repeat error stops decreasing iteration loop evaluates complete forward pass: α→kernel→column-normalize→interpolation→error\\alpha \\\\text{kernel} \\\\text{column-normalize} \\\\text{interpolation} \\\\text{error}.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-formal-objective","dir":"Articles","previous_headings":"Part V: Calibration and Optimization > 13. The Calibration Objective","what":"13.3 The formal objective","title":"Methodology","text":"f(α)=∑∑k(V̂ik−Pik)2f(\\alpha) = \\sum_i \\sum_k \\left( \\hat{V}_{ik} - P_{ik} \\right)^2 : V̂=W(α)×S\\hat{V} = W(\\alpha) \\times S — interpolated voter demographics per tract, WW built via per-bracket column normalization (Section 12.3) PP — census demographics per tract kk = demographic bracket index (K=7K = 7 age-calibration, K=14K = 14 full gender × age calibration) weight matrix W(α)W(\\alpha) aggregation per-bracket column-normalized matrices W(k)W^{(k)}, followed final column normalization pass.  landscape clear minimum. practice, tract alpha, creating high-dimensional optimization problem.","code":"# Simplified case: all tracts share the same alpha tt_adj <- tt_toy + 1 pop_matrix_toy <- matrix(pop_toy, ncol = 1) src_matrix_toy <- matrix(c(250, 400, 350), ncol = 1)  alpha_range <- seq(0.1, 8, by = 0.1) sse_values <- sapply(alpha_range, function(a) {   # Compute column-normalized weights and SSE   K <- tt_adj ^ (-a)   K[!is.finite(K)] <- 0   W <- t(t(K) / colSums(K))  # column-normalize   v_hat <- W %*% src_matrix_toy   sum((v_hat - pop_matrix_toy)^2) })  ggplot(data.frame(alpha = alpha_range, sse = sse_values),        aes(x = alpha, y = sse)) +   geom_line(color = \"#4575b4\", linewidth = 0.8) +   geom_vline(xintercept = alpha_range[which.min(sse_values)],              linetype = \"dashed\", color = \"#d73027\") +   labs(title = \"Objective Function Landscape\",        subtitle = sprintf(          \"Minimum at alpha = %.1f (shared across all tracts)\",          alpha_range[which.min(sse_values)]),        x = expression(alpha), y = \"SSE\") +   theme_minimal() +   theme(plot.title = element_text(face = \"bold\"))"},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"why-automatic-differentiation","dir":"Articles","previous_headings":"Part V: Calibration and Optimization > 14. Optimization: Per-Bracket Gradient Descent with Column Normalization","what":"14.1 Why automatic differentiation?","title":"Methodology","text":"objective function involves column normalization IDW kernel, followed matrix multiplication squared-error loss. Writing analytical gradient hand straightforward simple column normalization, becomes tedious combined per-bracket structure exponential reparameterization. Torch’s automatic differentiation handles : define forward pass (kernel -> column-normalize -> interpolation -> loss), torch computes gradient loss respect α\\alpha automatically recording every operation applying chain rule backward.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"log-domain-computation-for-numerical-stability","dir":"Articles","previous_headings":"Part V: Calibration and Optimization > 14. Optimization: Per-Bracket Gradient Descent with Column Normalization","what":"14.2 Log-domain computation for numerical stability","title":"Methodology","text":"α\\alpha large travel times vary widely, weights become astronomically small: 32-bit floating point (standard GPU computation), numbers smaller 1.2×10−381.2 \\times 10^{-38} underflow zero. weight becomes exactly zero, column normalization produces 0/0=NaN0/0 = \\text{NaN}, optimization collapses. log-domain solution: IDW kernel computed log space logKij=−αi⋅log(tij+1)\\log K_{ij} = -\\alpha_i \\cdot \\log(t_{ij} + 1), column normalization uses logsumexp trick numerical stability. logsumexp function log(∑jexp(xj))\\log(\\sum_j \\exp(x_j)) numerically stable primitive available torch.","code":"# Demonstrate the underflow problem tt_demo <- c(5, 20, 60, 120, 200)  # travel times (minutes) alpha_high <- 8  raw <- (tt_demo + 1)^(-alpha_high) cat(\"Raw weights at alpha = 8:\\n\") #> Raw weights at alpha = 8: cat(formatC(raw, format = \"e\", digits = 2), \"\\n\") #> 5.95e-07 2.64e-11 5.22e-15 2.18e-17 3.75e-19 cat(\"\\nIn float32, values below ~1.2e-38 become exactly 0\\n\") #>  #> In float32, values below ~1.2e-38 become exactly 0 cat(\"Zero weights cause division by zero in column normalization\\n\") #> Zero weights cause division by zero in column normalization"},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-column-normalization-algorithm","dir":"Articles","previous_headings":"Part V: Calibration and Optimization > 14. Optimization: Per-Bracket Gradient Descent with Column Normalization","what":"14.3 The column normalization algorithm","title":"Methodology","text":"optimizer performs per-bracket column normalization 3D tensors. tensor shapes involved: first dimension (kak_a) indexes demographic brackets. kak_a brackets share kernel — column normalization applied independently bracket slice. Every operation — log, exp, logsumexp, matrix multiply, subtraction, squaring — defined backward pass torch. gradient ∇αf\\nabla_\\alpha f flows backward column normalization automatically.","code":"Input: log_t[n,m], alpha[n], P[n,ka], V[m,ka]  # Log-kernel (same for all brackets) log_K[i,j] = -alpha[i] * log_t[i, j]                  # [n x m]  # Column normalization in log domain (per bracket) log_colsum[j] = logsumexp_i(log_K[i,j])               # [m] W[i,j] = exp(log_K[i,j] - log_colsum[j])              # [n x m]  # Per-bracket: broadcast W to [ka x n x m], then interpolate V_hat = W @ V                                          # [n x ka] loss = sum((V_hat - P)^2)"},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"adam-optimization-with-per-bracket-weights","dir":"Articles","previous_headings":"Part V: Calibration and Optimization > 14. Optimization: Per-Bracket Gradient Descent with Column Normalization","what":"14.4 ADAM optimization with per-bracket weights","title":"Methodology","text":"use ADAM (Adaptive Moment Estimation) underlying optimizer, per-bracket column normalization. gradient step: Build IDW kernel current alpha values Per-bracket column normalization: demographic column uses column-normalized kernel Compute loss: SSE interpolated observed values Backward + Adam step unconstrained theta parameters end epoch, true objective evaluated full dataset (gradient) used convergence monitoring logging. Exponential reparameterization: alpha optimized directly. Instead optimize theta (unconstrained) alpha = exp(theta), initialized theta = log(alpha_init). ensures: Alpha always strictly positive — clamping projection needed Gradient d(alpha)/d(theta) = alpha — saturation boundary Corner solutions due hard boundary constraints occur learning rate reduced half epoch loss plateaus (ReduceLROnPlateau patience = 2 x early-stop patience).  epoch loss curve shows true objective evaluated tracts end epoch. package tracks best epoch loss returns corresponding alpha values. Key tuning parameters: Tuning parameters grouped optim_control():","code":"optim_result <- optimize_alpha(   time_matrix   = time_matrix,   pop_matrix    = pop_matrix,   source_matrix = source_matrix,   row_targets   = row_targets,   optim = optim_control(     max_epochs = 200,      # maximum epochs     lr_init    = 0.05,     # initial learning rate (auto-reduced on plateau)     use_gpu    = FALSE     # CPU for small problems   ) )"},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-effect-of-alpha-spatial-interpretation","dir":"Articles","previous_headings":"Part VI: Results and Validation","what":"15. The Effect of Alpha: Spatial Interpretation","title":"Methodology","text":"alphas cluster moderate range, tails extending toward 0 (uniform allocation) large values (nearest-station-).  Low alpha (blue, urban core): weight spread across many nearby stations. Multiple stations overlap, optimizer distributes influence broadly. High alpha (red, periphery): weight concentrated nearest station. Isolated tracts one dominant station.  α=1\\alpha = 1, weights nearly uniform. α=10\\alpha = 10, nearest station dominates ~85% weight. Interpretation guide: α<1\\alpha < 1: draws information almost equally stations. Unusual — check data issues. α∈[1,3]\\alpha \\[1, 3]: several nearby stations contribute. Typical dense urban areas. α∈[3,6]\\alpha \\[3, 6]: stations dominate. Typical suburban areas. α>6\\alpha > 6: one station dominates almost entirely. Typical isolated tracts.","code":"# How alpha changes the weight distribution for a fixed tract tt_one_tract <- c(3, 8, 15, 25, 40) alphas_demo <- c(1, 3, 5, 10) wt_df <- do.call(rbind, lapply(alphas_demo, function(a) {   w <- (tt_one_tract + 1)^(-a)   w <- w / sum(w)   data.frame(station = 1:5, weight = w,              alpha = paste0(\"alpha = \", a)) })) wt_df$alpha <- factor(wt_df$alpha,                         levels = paste0(\"alpha = \", alphas_demo))  ggplot(wt_df, aes(x = factor(station), y = weight, fill = alpha)) +   geom_col(position = \"dodge\") +   labs(title = \"Weight Distribution as Alpha Increases\",        subtitle = \"Fixed tract, 5 stations at 3, 8, 15, 25, 40 min\",        x = \"Station (sorted by distance)\",        y = \"Normalized weight\", fill = \"\") +   theme_minimal() +   theme(plot.title = element_text(face = \"bold\"))"},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"the-interpolation-from-weights-to-tract-level-estimates","dir":"Articles","previous_headings":"Part VI: Results and Validation","what":"16. The Interpolation: From Weights to Tract-Level Estimates","title":"Methodology","text":"weight matrix WW encodes geographic relationship tracts stations. Multiplying station-level variable produces tract-level estimates: X̂=W×V\\hat{X} = W \\times V WW [N × M], VV [M × 1], X̂\\hat{X} [N × 1]. multiple variables: X̂=W×Vmatrix\\hat{X} = W \\times V_{\\text{matrix}} VmatrixV_{\\text{matrix}} [M × P].   Geographic polarization becomes visible tract level — spatial pattern previously impossible observe station-level data alone. Calibration validation: interpolated demographics match census demographics (optimization objective).  Points cluster tightly around 45-degree line, confirming optimization found good weights. reuse principle: weight matrix WW property geography calibration. computed, can interpolate variable measured polling stations — candidates, parties, turnout, gender composition, education level — without re-optimizing alpha.","code":"# W is returned directly from optimization W <- optim_result$W  electoral_data <- as.matrix(   sources[, c(\"CAND_13\", \"CAND_22\", \"QT_COMPARECIMENTO\")] ) interpolated <- W %*% electoral_data  pct_lula <- interpolated[, \"CAND_13\"] /   interpolated[, \"QT_COMPARECIMENTO\"] * 100"},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"conservation-properties","dir":"Articles","previous_headings":"Part VI: Results and Validation > 17. Validation: How Well Did We Recover the Age Structure?","what":"17.1 Conservation properties","title":"Methodology","text":"Column conservation (source conservation): ∑iWij=1∀j\\sum_i W_{ij} = 1 \\quad \\forall j station distributes exactly 100% data. Municipal totals preserved exactly. Calibration residuals:  Residuals centered near zero small magnitude. Outliers may indicate boundary effects (voters crossing municipality borders) data quality issues.","code":"votes <- c(500, 800, 700) interpolated_votes <- as.numeric(W_col %*% votes)  cat(\"Source total:\", sum(votes), \"\\n\") #> Source total: 2000 cat(\"Interpolated total:\", round(sum(interpolated_votes)), \"\\n\") #> Interpolated total: 2000 cat(\"Per-tract:\", round(interpolated_votes), \"\\n\") #> Per-tract: 506 722 106 461 204"},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"age-pyramid-recovery-rocinha-and-copacabana-revisited","dir":"Articles","previous_headings":"Part VI: Results and Validation > 17. Validation: How Well Did We Recover the Age Structure?","what":"17.2 Age pyramid recovery: Rocinha and Copacabana revisited","title":"Methodology","text":"Section 1, showed Rocinha Copacabana strikingly different age structures. interpolation recover patterns?  blue bars show census truth (population age bracket) yellow bars show IDW-interpolated voter profiles. interpolation closely recovers distinctive age patterns neighborhoods: Rocinha’s young skew Copacabana’s aging profile. demanding test. method know anything Rocinha Copacabana neighborhoods — sees census tracts polling stations. Yet calibration age brackets produces weights correctly recover neighborhood-level demographic signatures.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"comparison-with-voronoi-assignment","dir":"Articles","previous_headings":"Part VI: Results and Validation > 17. Validation: How Well Did We Recover the Age Structure?","what":"17.3 Comparison with Voronoi assignment","title":"Methodology","text":"simplest alternative method Voronoi assignment: assign tract nearest polling station use station’s data directly. equivalent constructing Voronoi (Thiessen) polygons around station assigning tract 100% weight one station. compare methods across four Brazilian state capitals diverse urban morphologies: Palmas (), Cuiabá (MT), Manaus (), Natal (RN).  Voronoi approach, tract inherits complete demographic electoral profile single station. ignores many--many structure: tract near boundary two Voronoi cells gets none influence station just across boundary. well two methods recover census age structure? following figure compares predicted versus observed demographic profiles across four cities: IDW points cluster tightly around 45-degree line every city. Voronoi points show much scatter — many tracts large prediction errors assigned station different demographic composition. residual boxplots confirm pattern across four cities: IDW residuals tightly centered around zero, Voronoi residuals much larger spread. aggregate SSE ratio quantifies advantage:  every city, IDW method achieves dramatically lower squared error Voronoi assignment — factor 275x (Cuiaba) 1,624x (Manaus), Palmas 601x Natal 639x. advantage consistent across cities different sizes urban layouts, confirming smooth, calibrated weighting fundamentally superior hard nearest-station assignment.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"ecological-correlation-lula-vote-share-and-household-income","dir":"Articles","previous_headings":"Part VI: Results and Validation > 17. Validation: How Well Did We Recover the Age Structure?","what":"17.4 Ecological correlation: Lula vote share and household income","title":"Methodology","text":"final validation exercise, examine whether interpolated voting patterns exhibit expected ecological correlations. spatial weights correct, interpolated vote shares correlate tract-level socioeconomic indicators independent data sources. correlate interpolated percentage votes Lula (PT) census tract average monthly income household heads, obtained 2022 Census (via censobr::read_tracts(2022, \"ResponsavelRenda\")). show correlation four cities different socioeconomic profiles: São Paulo (SP), Salvador (BA), Porto Alegre (RS), Cuiabá (MT).  negative correlation consistent across four cities well-established patterns Brazilian electoral geography: lower-income areas tend vote heavily PT candidates, higher-income areas lean toward parties. fact interpolated tract-level estimates reproduce pattern — using vote data originally measured polling stations, tracts — provides external validation spatial weights geographically meaningful. income data log-transformed (log(x+1)\\log(x+1)) reduce influence extreme values improve linearity.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"performance-and-tuning","dir":"Articles","previous_headings":"Part VII: Practical","what":"18. Performance and Tuning","title":"Methodology","text":"timings assume default optimization parameters: max_epochs = 200, dtype = \"float32\". Practical runtimes (optimization step , actual runs): Igrejinha (85 tracts, 17 stations): ~24s CPU Varginha (279 tracts, 37 stations): ~52s CPU Palmas (660 tracts, 71 stations): ~135s CPU Niterói (1,169 tracts, 135 stations): ~17s GPU Belo Horizonte (5,113 tracts, 407 stations): ~105s GPU Rio de Janeiro (13,370 tracts, 1,392 stations): ~10 min GPU Note total wall-clock time interpolate_election_br() also includes data downloads, travel time computation (via r5r), weight matrix construction, can dominate larger cities. Memory estimation. GPU memory optimization two main components: Full kernel matrix (always memory): n×m×bytesn \\times m \\times \\text{bytes} — e.g., 5,100 x 407 x 4 = 8 MB Belo Horizonte float32. Per-bracket weight tensors: ka×n×m×bytesk_a \\times n \\times m \\times \\text{bytes} — torch must store intermediate tensors backpropagation column normalization. ka=14k_a = 14 (gender × 7 age brackets) bytes 4 (float32) 8 (float64). actual values reported optimizer precomputation. large cities GPU, consider using dtype = \"float32\" (default) rather \"float64\" halve memory usage. RStudio: torch inside RStudio IDE requires subprocess execution via callr (automatic transparent user). Standalone R scripts run directly.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"setup-torch-java-and-r5r","dir":"Articles","previous_headings":"Part VII: Practical","what":"19. Setup: Torch, Java, and r5r","title":"Methodology","text":"Torch (required optimization): GPU support: Windows (CUDA), macOS (MPS Apple Silicon), Linux (CUDA). CPU always works fallback. Java + r5r (required travel time computation): Memory: options(java.parameters = \"-Xmx8g\") loading r5r large municipalities. Cache management:","code":"setup_torch()    # installs torch + libtorch/lantern binaries use_gpu(TRUE)    # enable GPU globally setup_java()     # downloads and installs Java 21 interpElections_cache()                             # list cached files interpElections_cache(\"dir\")                        # cache directory path interpElections_cache(\"clean\", category = \"votes\")  # clear by category"},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"notation","dir":"Articles","previous_headings":"Part VII: Practical > 20. Mathematical Appendix","what":"Notation","title":"Methodology","text":"NN = number census tracts, MM = number polling stations KK = number calibration brackets (7 age-, 14 full) t∈ℝN×Mt \\\\mathbb{R}^{N \\times M}: travel time matrix (minutes) α∈ℝN\\alpha \\\\mathbb{R}^N: per-tract decay parameters P∈ℝN×KP \\\\mathbb{R}^{N \\times K}: census population age bracket S∈ℝM×KS \\\\mathbb{R}^{M \\times K}: voter counts age bracket stations c∈ℝMc \\\\mathbb{R}^M: column targets (cj=1c_j = 1, enforced column normalization)","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"idw-kernel","dir":"Articles","previous_headings":"Part VII: Practical > 20. Mathematical Appendix","what":"IDW kernel","title":"Methodology","text":"Kij=(tij+1)−αiK_{ij} = (t_{ij} + 1)^{-\\alpha_i}","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"log-domain-kernel","dir":"Articles","previous_headings":"Part VII: Practical > 20. Mathematical Appendix","what":"Log-domain kernel","title":"Methodology","text":"logKij=−αi⋅log(tij+1)\\log K_{ij} = -\\alpha_i \\cdot \\log(t_{ij} + 1)","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"column-normalization","dir":"Articles","previous_headings":"Part VII: Practical > 20. Mathematical Appendix","what":"Column normalization","title":"Methodology","text":"Wij=Kij∑′Ki′jW_{ij} = \\frac{K_{ij}}{\\sum_{'} K_{'j}} log domain (numerical stability): Wij=exp(logKij−logsumexpi(logKij))W_{ij} = \\exp\\!\\left(\\log K_{ij} - \\text{logsumexp}_i(\\log K_{ij})\\right)","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"per-bracket-column-normalization-1","dir":"Articles","previous_headings":"Part VII: Practical > 20. Mathematical Appendix","what":"Per-bracket column normalization","title":"Methodology","text":"demographic bracket k=1,…,Kk = 1, \\ldots, K: Compute kernel: Kij=(tij+1)−αiK_{ij} = (t_{ij} + 1)^{-\\alpha_i} Column-normalize: Wij(k)=Kij/∑′Ki′jW^{(k)}_{ij} = K_{ij} / \\sum_{'} K_{'j} Aggregate column-normalize: Wtotal=∑k=1KW(k)W_{\\text{total}} = \\sum_{k=1}^{K} W^{(k)}Wij=Wtotal,ij/∑′Wtotal,′jW_{ij} = W_{\\text{total},ij} \\bigg/ \\sum_{'} W_{\\text{total},'j}","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"objective-function-full-data","dir":"Articles","previous_headings":"Part VII: Practical > 20. Mathematical Appendix","what":"Objective function (full data)","title":"Methodology","text":"f(α)=∥W(α)⋅S−P∥F2=∑=1N∑k=1K(∑j=1MWijSjk−Pik)2f(\\alpha) = \\| W(\\alpha) \\cdot S - P \\|_F^2 = \\sum_{=1}^N \\sum_{k=1}^K \\left( \\sum_{j=1}^M W_{ij} S_{jk} - P_{ik} \\right)^2 W(α)∈ℝN×MW(\\alpha) \\\\mathbb{R}^{N \\times M} per-bracket column-normalized weight matrix.","code":""},{"path":"https://antrologos.github.io/interpElections/articles/methodology.html","id":"gradient","dir":"Articles","previous_headings":"Part VII: Practical > 20. Mathematical Appendix","what":"Gradient","title":"Methodology","text":"Computed torch autograd column normalization. operation (log, exp, logsumexp, matrix multiply, subtraction, squaring) defined backward pass torch: ∇αf=∂∂α∥colnorm(kernel(α))⋅S−P∥F2\\nabla_\\alpha f = \\frac{\\partial}{\\partial \\alpha} \\| \\text{colnorm}(\\text{kernel}(\\alpha)) \\cdot S - P \\|_F^2","code":""},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"loading-results","dir":"Articles","previous_headings":"","what":"Loading Results","title":"Working with Results","text":"","code":"# Run the pipeline (these were computed with GPU) result_nit <- interpolate_election_br(   \"Niteroi\", year = 2022, cargo = \"presidente\",   what = c(\"candidates\", \"parties\", \"turnout\", \"demographics\"),   keep = \"electoral_sf\",   optim = optim_control(use_gpu = TRUE) )  result_bh <- interpolate_election_br(   \"Belo Horizonte\", year = 2022, cargo = \"presidente\",   what = c(\"candidates\", \"turnout\"),   keep = \"electoral_sf\",   optim = optim_control(use_gpu = TRUE) )"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"print-and-summary","dir":"Articles","previous_headings":"","what":"Print and Summary","title":"Working with Results","text":"print() method gives compact overview: summary() method adds per-variable statistics grouped type: dictionary groups columns type (candidate, party, turnout, demographics, calibration) metadata like candidate name, party abbreviation, ballot number:","code":"result_nit interpElections result -- Brazilian election   Municipality: NITERÓI (RJ)   IBGE: 3303302 | TSE: 58653 | Election: 2022 | Census: 2022   Census tracts: 1169 | Sources: 135    Variables: 63     Candidates:    13 (CAND_27, CAND_14, CAND_30, CAND_13, ...)     Parties:       11 (PARTY_27, PARTY_14, PARTY_30, PARTY_13, ...)     Turnout:       1 (QT_COMPARECIMENTO)     Demographics:  10 (GENERO_FEMININO, GENERO_MASCULINO, ...)     Calibration:   gender x 7 age brackets    Optimizer: pb_sgd_colnorm_cuda (obj = 1265038.68)   Alpha:     [0.010, 17.623] (mean 2.507) summary(result_nit) View(result_nit$dictionary)"},{"path":[]},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"single-variable","dir":"Articles","previous_headings":"Plotting","what":"Single variable","title":"Working with Results","text":"Variables can referenced : Column name: \"CAND_13\", \"PARTY_PT\", \"QT_COMPARECIMENTO\" Ballot number: 13, 22 Candidate name (substring, case-insensitive): \"Lula\", \"Bolsonaro\" Party abbreviation: \"PT\", \"PL\"","code":"plot(result_nit, variable = \"Lula\")"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"absolute-counts","dir":"Articles","previous_headings":"Plotting","what":"Absolute counts","title":"Working with Results","text":"","code":"plot(result_nit, variable = \"Lula\", type = \"absolute\")"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"faceted-comparison","dir":"Articles","previous_headings":"Plotting","what":"Faceted comparison","title":"Working with Results","text":"","code":"plot(result_nit, variable = c(\"Lula\", \"Bolsonaro\"), type = \"pct_tract\")"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"plot-types","dir":"Articles","previous_headings":"Plotting","what":"Plot types","title":"Working with Results","text":"type parameter controls quantity mapped:","code":""},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"break-methods","dir":"Articles","previous_headings":"Plotting","what":"Break methods","title":"Working with Results","text":"breaks parameter controls color scale: \"quantile\" (default): equal-count bins \"continuous\": smooth gradient \"jenks\": natural breaks (requires classInt package) Custom numeric vector: breaks = c(0, 20, 40, 60, 80, 100)","code":"plot(result_nit, variable = \"Lula\", breaks = \"continuous\") plot(result_nit, variable = \"Lula\", breaks = \"jenks\")"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"additional-options","dir":"Articles","previous_headings":"Plotting","what":"Additional options","title":"Working with Results","text":"","code":"# Overlay polling stations plot(result_nit, variable = \"Lula\", show_sources = TRUE)  # Zoom into a region (lon/lat bounding box) plot(result_nit, variable = \"Lula\",      limits = c(-43.15, -43.05, -22.92, -22.86))  # Custom palette plot(result_nit, variable = \"Lula\", palette = \"viridis\") plot(result_nit, variable = \"Lula\", palette = \"Spectral\")  # Composable with ggplot2 library(ggplot2) plot(result_nit, variable = \"Lula\") + theme_dark()"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"interactive-maps","dir":"Articles","previous_headings":"Plotting","what":"Interactive maps","title":"Working with Results","text":"","code":"# Opens in browser with hover tooltips and zoom plot_interactive(result_nit, variable = \"Lula\")"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"large-scale-example-belo-horizonte","dir":"Articles","previous_headings":"Plotting","what":"Large-scale example (Belo Horizonte)","title":"Working with Results","text":"","code":"plot(result_bh, variable = \"Lula\")"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"extracting-alpha","dir":"Articles","previous_headings":"","what":"Extracting Alpha","title":"Working with Results","text":"coef() method returns optimized decay parameters:  Map alpha values spatially see urban/peripheral gradient:  Interpretation: Low alpha (blue) = weight spread across many stations (dense urban areas). High alpha (red) = weight concentrated nearest station (periphery).","code":"alpha <- coef(result_nit) summary(alpha) result_nit$tracts_sf$alpha <- coef(result_nit) ggplot(result_nit$tracts_sf) +   geom_sf(aes(fill = alpha), color = \"white\", linewidth = 0.05) +   scale_fill_distiller(palette = \"RdYlBu\", direction = -1) +   theme_void()"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"residual-analysis","dir":"Articles","previous_headings":"","what":"Residual Analysis","title":"Working with Results","text":"residuals() method computes calibration residuals (fitted minus observed) tract age bracket.  Residuals centered near zero. Large residuals may indicate boundary effects (voters crossing municipality borders), data quality issues, census/election year mismatches.","code":"resid <- residuals(result_nit) str(resid) #> num [1:1169, 1:14] ...  # Per-bracket summary colMeans(resid)                        # mean residual per bracket sqrt(colMeans(resid^2))                # RMSE per bracket"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"validation-checklist","dir":"Articles","previous_headings":"","what":"Validation Checklist","title":"Working with Results","text":"Five checks apply result:","code":"# 1. Total conservation: interpolated totals match source totals colSums(result_nit$interpolated)[1:3] colSums(result_nit$sources[, result_nit$interp_cols[1:3]])  # 2. Residual magnitude resid <- residuals(result_nit) sqrt(mean(resid^2))   # overall RMSE  # 3. Alpha distribution (no extreme piling at bounds) summary(coef(result_nit))  # 4. Non-negative values all(result_nit$interpolated >= -1e-10)  # 5. Convergence result_nit$optimization$convergence   # 0 = success"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"exporting-results","dir":"Articles","previous_headings":"","what":"Exporting Results","title":"Working with Results","text":"","code":"# Plain data frame (no geometry) df <- as.data.frame(result_nit) write.csv(df, \"niteroi_2022.csv\", row.names = FALSE)  # GeoPackage with geometry (for GIS) sf::st_write(result_nit$tracts_sf, \"niteroi_2022.gpkg\")  # Column metadata result_nit$dictionary  # Source-level data (without geometry) head(result_nit$sources)"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"areal-aggregation-from-tracts-to-neighborhoods","dir":"Articles","previous_headings":"","what":"Areal Aggregation: From Tracts to Neighborhoods","title":"Working with Results","text":"Tract-level results can reaggregated larger zones (neighborhoods, administrative regions, custom polygons) using areal_weights() areal_interpolate(). Example: Belo Horizonte tracts neighborhoods weight matrix W_areal [n_neighborhoods x n_tracts]. column sums 1 (tract’s data distributed proportionally area overlap). areal_interpolate() simply W_areal %*% data. approach preserves total conservation: neighborhood-level totals equal tract-level totals, equal original municipality totals.","code":"library(sf) library(geobr)  # Download BH neighborhood boundaries bairros <- read_neighborhood(year = 2010) bairros <- bairros[bairros$code_muni == 3106200, ]  # Compute area-weighted intersection matrix W_areal <- areal_weights(   target_sf = bairros,   source_sf = result_bh$tracts_sf,   target_id = \"code_neighborhood\",   source_id = \"code_tract\" )  # Aggregate interpolated data vote_data <- result_bh$interpolated aggregated <- areal_interpolate(vote_data, W_areal)  # Conservation check colSums(aggregated)[1:3] colSums(vote_data)[1:3]   # should match"},{"path":"https://antrologos.github.io/interpElections/articles/working-with-results.html","id":"the-keep-parameter","dir":"Articles","previous_headings":"","what":"The keep Parameter","title":"Working with Results","text":"Control intermediate objects retained result: weights time_matrix always kept default (needed residuals() reinterpolate()). Use keep additional objects: also includes source point geometries overlay plots.","code":"result <- interpolate_election_br(\"Niteroi\", year = 2022,   keep = \"electoral_sf\")"},{"path":"https://antrologos.github.io/interpElections/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Rogerio Barbosa. Author, maintainer. Lucas Gelape. Author.","code":""},{"path":"https://antrologos.github.io/interpElections/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Barbosa R, Gelape L (2026). interpElections: Spatial Interpolation Electoral Data via Inverse Distance Weighting. R package version 0.1.0, https://antrologos.github.io/interpElections/.","code":"@Manual{,   title = {interpElections: Spatial Interpolation of Electoral Data via Inverse Distance Weighting},   author = {Rogerio Barbosa and Lucas Gelape},   year = {2026},   note = {R package version 0.1.0},   url = {https://antrologos.github.io/interpElections/}, }"},{"path":"https://antrologos.github.io/interpElections/index.html","id":"interpelections","dir":"","previous_headings":"","what":"Spatial Interpolation of Electoral Data via Inverse Distance Weighting","title":"Spatial Interpolation of Electoral Data via Inverse Distance Weighting","text":"Spatial interpolation electoral data via column-normalized inverse distance weighting. Disaggregates point-level data (e.g., polling station vote counts) polygon-level estimates (e.g., census tracts) using travel-time-based IDW per-zone decay parameters calibrated demographic totals. Column normalization ensures source conservation (source distributes exactly 100% data).","code":""},{"path":"https://antrologos.github.io/interpElections/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Spatial Interpolation of Electoral Data via Inverse Distance Weighting","text":"Optional: setup_torch() GPU optimization, setup_java() r5r travel-time routing.","code":"# install.packages(\"remotes\") remotes::install_github(\"antrologos/interpElections\")"},{"path":"https://antrologos.github.io/interpElections/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick start","title":"Spatial Interpolation of Electoral Data via Inverse Distance Weighting","text":"Three lines: downloads census data, electoral results, road networks; computes travel times; optimizes per-tract decay; interpolates variables census tracts.","code":"library(interpElections)  result <- interpolate_election_br(3550308, 2022) plot(result)"},{"path":"https://antrologos.github.io/interpElections/index.html","id":"advanced-usage","dir":"","previous_headings":"","what":"Advanced usage","title":"Spatial Interpolation of Electoral Data via Inverse Distance Weighting","text":"Control objects group tuning parameters optimization routing:","code":"result <- interpolate_election_br(3550308, 2022,   optim = optim_control(use_gpu = TRUE, max_epochs = 1000),   routing = routing_control(mode = c(\"WALK\", \"TRANSIT\"),                             gtfs_zip_path = \"sptrans.zip\") )"},{"path":"https://antrologos.github.io/interpElections/index.html","id":"custom-data","dir":"","previous_headings":"","what":"Custom data","title":"Spatial Interpolation of Electoral Data via Inverse Distance Weighting","text":"","code":"result <- interpolate_election(   tracts_sf     = my_zones,   electoral_sf  = my_sources,   tract_id      = \"zone_id\",   point_id      = \"source_id\",   calib_tracts  = c(\"pop_young\", \"pop_old\"),   calib_sources = c(\"count_young\", \"count_old\"),   time_matrix   = my_travel_times )"},{"path":"https://antrologos.github.io/interpElections/index.html","id":"how-it-works","dir":"","previous_headings":"","what":"How it works","title":"Spatial Interpolation of Electoral Data via Inverse Distance Weighting","text":"tract source j, IDW kernel : Wij=(tij+1)−αiW_{ij} = (t_{ij} + 1)^{-\\alpha_i} Weights column-normalized column sums equal 1 (source distributes exactly 100% data). optimal alpha found minimizing Poisson deviance interpolated census demographics via torch ADAM log-barrier penalty.","code":""},{"path":[]},{"path":[]},{"path":"https://antrologos.github.io/interpElections/index.html","id":"gpu-acceleration","dir":"","previous_headings":"","what":"GPU acceleration","title":"Spatial Interpolation of Electoral Data via Inverse Distance Weighting","text":"GPU (CUDA/MPS) recommended municipalities >1,000 census tracts. CPU works problem sizes.","code":"setup_torch()     # one-time installation use_gpu(TRUE)     # enable globally  # Or per-call via control objects: result <- interpolate_election_br(3550308, 2022,   optim = optim_control(use_gpu = TRUE))"},{"path":"https://antrologos.github.io/interpElections/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Spatial Interpolation of Electoral Data via Inverse Distance Weighting","text":"Barbosa, R. & Gelape, L. (2025). interpElections: Spatial Interpolation Electoral Data via Inverse Distance Weighting. R package version 0.1.0. https://github.com/antrologos/interpElections","code":""},{"path":"https://antrologos.github.io/interpElections/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Spatial Interpolation of Electoral Data via Inverse Distance Weighting","text":"MIT","code":""},{"path":"https://antrologos.github.io/interpElections/reference/areal_interpolate.html","id":null,"dir":"Reference","previous_headings":"","what":"Aggregate data from source zones to target polygons using areal weights — areal_interpolate","title":"Aggregate data from source zones to target polygons using areal weights — areal_interpolate","text":"Applies precomputed areal weight matrix (areal_weights()) transfer data source zones target polygons.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/areal_interpolate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Aggregate data from source zones to target polygons using areal weights — areal_interpolate","text":"","code":"areal_interpolate(data, weights)"},{"path":"https://antrologos.github.io/interpElections/reference/areal_interpolate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Aggregate data from source zones to target polygons using areal weights — areal_interpolate","text":"data Numeric matrix data.frame [n_source x p]. Data source zones. Rows must correspond columns weights. weights Numeric matrix [n_target x n_source]. Output areal_weights().","code":""},{"path":"https://antrologos.github.io/interpElections/reference/areal_interpolate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Aggregate data from source zones to target polygons using areal weights — areal_interpolate","text":"Numeric matrix [n_target x p]. Aggregated values target polygons.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/areal_interpolate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Aggregate data from source zones to target polygons using areal weights — areal_interpolate","text":"","code":"W <- matrix(c(0.7, 0.3, 0.2, 0.8), nrow = 2)  # 2 targets x 2 sources src_data <- matrix(c(100, 200), nrow = 2)        # 2 sources x 1 variable areal_interpolate(src_data, W) #>      [,1] #> [1,]  110 #> [2,]  190"},{"path":"https://antrologos.github.io/interpElections/reference/areal_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute area-weighted intersection matrix between two polygon layers — areal_weights","title":"Compute area-weighted intersection matrix between two polygon layers — areal_weights","text":"Builds weight matrix maps values source polygons (e.g., census tracts) target polygons (e.g., custom analysis zones) based fraction area shared .","code":""},{"path":"https://antrologos.github.io/interpElections/reference/areal_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute area-weighted intersection matrix between two polygon layers — areal_weights","text":"","code":"areal_weights(target_sf, source_sf, target_id = \"id\", source_id = \"id\")"},{"path":"https://antrologos.github.io/interpElections/reference/areal_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute area-weighted intersection matrix between two polygon layers — areal_weights","text":"target_sf sf object polygon geometries. target zones aggregate . source_sf sf object polygon geometries. source zones (e.g., census tracts interpolated data). target_id Character. Name ID column target_sf. source_id Character. Name ID column source_sf.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/areal_weights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute area-weighted intersection matrix between two polygon layers — areal_weights","text":"numeric matrix [n_target x n_source]. column standardized weights target zones sum 1 (0 source zone overlap). Row names = target IDs, column names = source IDs.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/areal_weights.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute area-weighted intersection matrix between two polygon layers — areal_weights","text":"Requires sf package. Geometries made valid sf::st_make_valid() computing intersections.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/as.data.frame.interpElections_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert result to data frame — as.data.frame.interpElections_result","title":"Convert result to data frame — as.data.frame.interpElections_result","text":"Drops geometry tracts_sf returns plain data frame census tract IDs interpolated values.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/as.data.frame.interpElections_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert result to data frame — as.data.frame.interpElections_result","text":"","code":"# S3 method for class 'interpElections_result' as.data.frame(x, ...)"},{"path":"https://antrologos.github.io/interpElections/reference/as.data.frame.interpElections_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert result to data frame — as.data.frame.interpElections_result","text":"x interpElections_result object. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/as.data.frame.interpElections_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert result to data frame — as.data.frame.interpElections_result","text":"data frame.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_geocode.html","id":null,"dir":"Reference","previous_headings":"","what":"Download geocoded polling station data from TSE — br_download_geocode","title":"Download geocoded polling station data from TSE — br_download_geocode","text":"Downloads official polling station location data (eleitorado por local de votação) TSE open data portal. file includes geographic coordinates (NR_LATITUDE, NR_LONGITUDE) polling locations, along voter counts addresses.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_geocode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download geocoded polling station data from TSE — br_download_geocode","text":"","code":"br_download_geocode(   year,   uf = NULL,   code_muni_tse = NULL,   force = FALSE,   cache = TRUE,   verbose = TRUE )"},{"path":"https://antrologos.github.io/interpElections/reference/br_download_geocode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download geocoded polling station data from TSE — br_download_geocode","text":"year Integer. Election year (e.g., 2010, 2012, 2016, 2020). uf Character NULL. Two-letter state abbreviation. provided, filters results state. code_muni_tse Character NULL. 5-digit TSE municipality code. provided, filters results municipality . force Logical. Re-download even cached file exists. Default: FALSE. cache Logical. TRUE (default), downloaded files stored persistently. See interpElections_cache(). verbose Logical. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_geocode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download geocoded polling station data from TSE — br_download_geocode","text":"data frame one row per section per round, using original TSE column names. Returns NULL data available given year (e.g., 2010). Key columns: CD_MUNICIPIO TSE municipality code (5-digit) NR_ZONA Electoral zone number NR_LOCAL_VOTACAO Polling location number NR_SECAO Section number NR_LATITUDE Latitude polling location (-1 missing) NR_LONGITUDE Longitude polling location (-1 missing) NM_LOCAL_VOTACAO Name polling location DS_ENDERECO Address polling location","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_geocode.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Download geocoded polling station data from TSE — br_download_geocode","text":"TSE data available 2010 onward. years 2010 (e.g., 2008), function returns NULL caller can fall back alternative sources. Data downloaded https://cdn.tse.jus.br/estatistica/sead/odsele/eleitorado_locais_votacao/. Files cached persistently default reused subsequent calls unless force = TRUE. Use interpElections_cache() manage cached files. CSV files use semicolon (;) delimiter Latin-1 encoding. Missing coordinates stored -1 TSE data.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/br_download_party_legends.html","id":null,"dir":"Reference","previous_headings":"","what":"Download party legends from TSE — br_download_party_legends","title":"Download party legends from TSE — br_download_party_legends","text":"Downloads official party legend data (consulta de legendas) TSE open data portal given election year. file maps party numbers (NR_PARTIDO) abbreviations (SG_PARTIDO) full names (NM_PARTIDO).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_party_legends.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download party legends from TSE — br_download_party_legends","text":"","code":"br_download_party_legends(year, force = FALSE, cache = TRUE, verbose = TRUE)"},{"path":"https://antrologos.github.io/interpElections/reference/br_download_party_legends.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download party legends from TSE — br_download_party_legends","text":"year Integer. Election year (e.g., 2008, 2012, 2016, 2020, 2022). force Logical. Re-download even cached file exists. Default: FALSE. cache Logical. TRUE (default), downloaded files stored persistently. See interpElections_cache(). verbose Logical. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_party_legends.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download party legends from TSE — br_download_party_legends","text":"data frame TSE party/coalition data. Key columns: NR_PARTIDO Party number (2-digit) SG_PARTIDO Party abbreviation (e.g., \"PT\", \"MDB\") NM_PARTIDO Full party name","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_party_legends.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Download party legends from TSE — br_download_party_legends","text":"Data downloaded https://cdn.tse.jus.br/estatistica/sead/odsele/consulta_coligacao/. file contains coalition/party records election year, unique party number--abbreviation mapping extracted. Files cached persistently default reused subsequent calls unless force = TRUE.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/br_download_turnout.html","id":null,"dir":"Reference","previous_headings":"","what":"Download turnout/attendance data from TSE — br_download_turnout","title":"Download turnout/attendance data from TSE — br_download_turnout","text":"Downloads official turnout detail data (detalhe da votação por seção) TSE open data portal. file provides attendance counts, abstentions, vote type breakdowns per polling section.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_turnout.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download turnout/attendance data from TSE — br_download_turnout","text":"","code":"br_download_turnout(   year,   uf = NULL,   code_muni_tse = NULL,   cargo = NULL,   turno = 1L,   force = FALSE,   cache = TRUE,   verbose = TRUE )"},{"path":"https://antrologos.github.io/interpElections/reference/br_download_turnout.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download turnout/attendance data from TSE — br_download_turnout","text":"year Integer. Election year (e.g., 2008, 2012, 2016, 2020). uf Character NULL. Two-letter state abbreviation. Used filter nationwide file single state. code_muni_tse Character NULL. 5-digit TSE municipality code. provided, filters results municipality . cargo Integer NULL. Electoral office code filter. NULL, uses office (turnout across offices). turno Integer. Election round (1 2). Default: 1. force Logical. Re-download even cached file exists. Default: FALSE. cache Logical. TRUE (default), downloaded files stored persistently. See interpElections_cache(). verbose Logical. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_turnout.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download turnout/attendance data from TSE — br_download_turnout","text":"data frame one row per section per office, using original TSE column names. Key columns: ANO_ELEICAO Election year CD_MUNICIPIO TSE municipality code (5-digit) NR_ZONA Electoral zone number NR_SECAO Section number CD_CARGO Office code QT_COMPARECIMENTO Number voters attended QT_APTOS Number eligible voters QT_ABSTENCOES Number abstentions","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_turnout.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Download turnout/attendance data from TSE — br_download_turnout","text":"TSE publishes data single nationwide file https://cdn.tse.jus.br/estatistica/sead/odsele/detalhe_votacao_secao/. file can large (hundreds MB). Results filtered municipality /state immediately reading.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/br_download_votes.html","id":null,"dir":"Reference","previous_headings":"","what":"Download candidate vote data from TSE — br_download_votes","title":"Download candidate vote data from TSE — br_download_votes","text":"Downloads official candidate vote data (votação por seção eleitoral) TSE open data portal given election year state. data downloaded ZIP file containing semicolon-delimited CSV.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_votes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download candidate vote data from TSE — br_download_votes","text":"","code":"br_download_votes(   year,   uf,   code_muni_tse = NULL,   cargo = NULL,   turno = 1L,   force = FALSE,   cache = TRUE,   verbose = TRUE )"},{"path":"https://antrologos.github.io/interpElections/reference/br_download_votes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download candidate vote data from TSE — br_download_votes","text":"year Integer. Election year (e.g., 2008, 2012, 2016, 2020). uf Character. Two-letter state abbreviation (e.g., \"SP\", \"RJ\"), \"BR\" download national file (used presidential data). code_muni_tse Character NULL. 5-digit TSE municipality code. provided, filters results municipality . cargo Integer NULL. Electoral office code filter (e.g., 13 = Vereador, 11 = Prefeito). NULL, returns offices. turno Integer. Election round (1 2). Default: 1. force Logical. Re-download even cached file exists. Default: FALSE. cache Logical. TRUE (default), downloaded files stored persistent cross-session cache directory (see interpElections_cache()). FALSE, files stored temporary directory lost R restarts. verbose Logical. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_votes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download candidate vote data from TSE — br_download_votes","text":"data frame one row per candidate per polling section, using original TSE column names. Key columns: ANO_ELEICAO Election year CD_MUNICIPIO TSE municipality code (5-digit) NR_ZONA Electoral zone number NR_SECAO Section number NR_LOCAL_VOTACAO Polling location number CD_CARGO Office code NR_VOTAVEL Candidate number (95 = blank, 96 = null) NM_VOTAVEL Candidate name QT_VOTOS Number votes","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_download_votes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Download candidate vote data from TSE — br_download_votes","text":"Data downloaded https://cdn.tse.jus.br/estatistica/sead/odsele/votacao_secao/. Files cached persistently default reused subsequent calls unless force = TRUE. Use interpElections_cache() manage cached files. CSV files use semicolon (;) delimiter Latin-1 encoding. Note: general elections, presidential vote data (cargo 1) published national file (uf = \"BR\") rather per-state files. br_prepare_electoral() handles automatically.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/br_election_dates.html","id":null,"dir":"Reference","previous_headings":"","what":"Brazilian election dates — br_election_dates","title":"Brazilian election dates — br_election_dates","text":"Election dates turno 1 (first round) turno 2 (runoff) Brazilian elections 2000 2024. Used internally auto-deriving departure datetime GTFS transit routing enabled.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_election_dates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Brazilian election dates — br_election_dates","text":"","code":"br_election_dates"},{"path":"https://antrologos.github.io/interpElections/reference/br_election_dates.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Brazilian election dates — br_election_dates","text":"data frame 26 rows 3 columns: year Integer. Election year. turno Integer. 1 = first round, 2 = runoff. date Date. Election date.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_election_dates.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Brazilian election dates — br_election_dates","text":"TSE (Tribunal Superior Eleitoral)","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_electoral.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare Brazilian electoral data at the polling-location level — br_prepare_electoral","title":"Prepare Brazilian electoral data at the polling-location level — br_prepare_electoral","text":"Downloads TSE voter profile, attendance, candidate vote data, merges geocoded polling station coordinates, aggregates voting-location level. Returns data frame ready interpolation.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_electoral.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare Brazilian electoral data at the polling-location level — br_prepare_electoral","text":"","code":"br_prepare_electoral(   code_muni_ibge,   code_muni_tse,   uf,   year,   cargo = NULL,   turno = 1L,   what = \"candidates\",   candidates = NULL,   parties = NULL,   perfil_path = NULL,   comparecimento_path = NULL,   votacao_path = NULL,   geocode_path = NULL,   cache = TRUE,   force = FALSE,   verbose = TRUE )"},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_electoral.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare Brazilian electoral data at the polling-location level — br_prepare_electoral","text":"code_muni_ibge Character. 7-digit IBGE municipality code (e.g., \"3550308\" Sao Paulo). code_muni_tse Character. 5-digit TSE municipality code (e.g., \"71072\" Sao Paulo). Typically obtained via interpolate_election_br(), resolves automatically. uf Character. Two-letter state abbreviation (e.g., \"SP\", \"RJ\", \"MG\"). year Integer. Election year. See interpolate_election_br() distinction municipal general election years. cargo Integer, character, NULL. electoral office(s) include. Accepts human-readable aliases (case-insensitive), TSE numeric codes, vector either: NULL (default), offices present data file included. general election years, automatically downloads national file presidential data. multiple cargos selected, output columns prefixed (e.g., PREFEITO_CAND_*, VEREADOR_CAND_*). turno Integer. Election round: 1 (first round, default) 2 (runoff). runoff exists presidente, governador, prefeito (cities >200k voters), candidate wins outright first round. Character vector. Controls data columns produced output. One : \"candidates\" (default): One column per candidate vote counts, named CAND_<ballot_number>. Also includes QT_COMPARECIMENTO (total turnout). Special ballot numbers: 95 = blank votes (em branco), 96 = null votes (nulo). \"parties\": One column per party total votes, named PARTY_<abbreviation> (e.g., PARTY_PT, PARTY_MDB). Also includes QT_COMPARECIMENTO. \"turnout\": Turnout statistics: QT_COMPARECIMENTO (voters showed ), QT_APTOS (eligible voters), QT_ABSTENCOES (abstentions), available data. \"demographics\": Voter profile gender (GENERO_FEMININO, GENERO_MASCULINO, GENERO_NAO_INFORMADO) education level (EDUC_ANALFABETO, EDUC_LE_ESCREVE, EDUC_FUND_INCOMP, EDUC_FUND_COMP, EDUC_MEDIO_INCOMP, EDUC_MEDIO_COMP, EDUC_SUP_INCOMP, EDUC_SUP_COMP, EDUC_NAO_INFORMADO). Note: demographics come voter registration profile, vote data, cargo filter applies. Values can combined: = c(\"candidates\", \"parties\", \"turnout\", \"demographics\"). candidates Character numeric vector, NULL. Filter specific candidates (applies \"candidates\" %% ): Numeric values match candidate's ballot number exactly. Example: candidates = c(13, 22). Character values perform accent-normalized, case-insensitive substring matching candidate's registered name. Example: candidates = \"LULA\" matches \"LUIZ INACIO LULA DA SILVA\". NULL (default): candidates kept. parties Character vector NULL. Filter specific parties (applies \"parties\" %% ). Uses official TSE party abbreviations, matched case-insensitively. Example: parties = c(\"PT\", \"PL\", \"MDB\"). NULL (default): parties kept. perfil_path Character NULL. Path local voter profile CSV file. NULL (default), downloads TSE. comparecimento_path Character NULL. Path attendance parquet file. NULL (default), turnout computed vote data . votacao_path Character NULL. Path candidate votes parquet file. NULL (default), downloads TSE. geocode_path Character NULL. Path CSV geocoded polling station coordinates (columns: nr_zona, nr_local_votacao, lat, long). NULL, coordinates obtained TSE Danny Hidalgo's geocoding project. cache Logical. TRUE (default), downloaded files stored persistently. See interpElections_cache(). force Logical. Re-download even cached file exists. Default: FALSE. verbose Logical. Print progress messages. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_electoral.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare Brazilian electoral data at the polling-location level — br_prepare_electoral","text":"data frame one row per voting location (per polling section). Contains following column groups: Always present: lat, long: Coordinates voting location. id: Sequential integer ID. votantes_18_20, ..., votantes_65_69: Registered voters per age bracket location (used calibration data). vot_hom_*, vot_mul_*: Registered voters gender age bracket (7 brackets , 14 columns total). Used calibration data interpolation. Conditional : \"candidates\": CAND_<number> columns + QT_COMPARECIMENTO. \"parties\": PARTY_<abbrev> columns + QT_COMPARECIMENTO. \"turnout\": QT_COMPARECIMENTO, QT_APTOS, QT_ABSTENCOES. \"demographics\": GENERO_* EDUC_* columns. multiple cargo values selected, candidate party columns prefixed (e.g., PREFEITO_CAND_45, VEREADOR_PARTY_PT).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_electoral.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare Brazilian electoral data at the polling-location level — br_prepare_electoral","text":"users use interpolate_election_br() instead, calls function internally runs full interpolation pipeline. Use br_prepare_electoral() directly need raw polling-location data without interpolation. votacao_path comparecimento_path NULL, data auto-downloaded official TSE open data portal using br_download_votes() br_download_turnout().","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_electoral.html","id":"data-sources","dir":"Reference","previous_headings":"","what":"Data sources","title":"Prepare Brazilian electoral data at the polling-location level — br_prepare_electoral","text":"data downloaded TSE open data portal https://cdn.tse.jus.br/estatistica/sead/odsele/. Presidential vote data (cargo 1) published separate national file (votacao_secao_<year>_BR.zip, ~250 MB) rather per-state files. function detects presidential data needed downloads national file automatically. Geocoded polling station coordinates come two sources: official TSE data (available ~2020 onwards, missing coordinates) Danny Hidalgo's geocoding project (https://github.com/fdhidalgo/geocode_br_polling_stations), covers earlier years. TSE coordinates take priority available.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_electoral.html","id":"dependencies","dir":"Reference","previous_headings":"","what":"Dependencies","title":"Prepare Brazilian electoral data at the polling-location level — br_prepare_electoral","text":"Requires dplyr, tidyr, data.table, stringr packages. reading local parquet files, arrow package also required.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_electoral.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare Brazilian electoral data at the polling-location level — br_prepare_electoral","text":"","code":"if (FALSE) { # \\dontrun{ # ── Basic usage ──────────────────────────────────────────────── # All candidates in the 2020 municipal election for Boa Vista elec <- br_prepare_electoral(   code_muni_ibge = \"1400100\",   code_muni_tse  = \"01120\",   uf = \"RR\",   year = 2020,   what = c(\"candidates\", \"turnout\") )  # ── Specific cargo ───────────────────────────────────────────── # Only the presidential race in 2022 elec <- br_prepare_electoral(   code_muni_ibge = \"3170701\",   code_muni_tse  = \"54135\",   uf = \"MG\",   year = 2022,   cargo = \"presidente\" )  # ── Filter specific candidates ───────────────────────────────── # Only Lula and Bolsonaro in the 2022 presidential race elec <- br_prepare_electoral(   code_muni_ibge = \"3170701\",   code_muni_tse  = \"54135\",   uf = \"MG\",   year = 2022,   cargo = \"presidente\",   candidates = c(13, 22) )  # ── Party vote totals ────────────────────────────────────────── elec <- br_prepare_electoral(   code_muni_ibge = \"3170701\",   code_muni_tse  = \"54135\",   uf = \"MG\",   year = 2020,   cargo = \"vereador\",   what = \"parties\",   parties = c(\"PT\", \"MDB\", \"PL\") )  # ── Voter demographics ───────────────────────────────────────── elec <- br_prepare_electoral(   code_muni_ibge = \"3170701\",   code_muni_tse  = \"54135\",   uf = \"MG\",   year = 2022,   what = \"demographics\" ) # -> GENERO_FEMININO, GENERO_MASCULINO, EDUC_SUP_COMP, ... } # }"},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_population.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare Brazilian census population data by age bracket per census tract — br_prepare_population","title":"Prepare Brazilian census population data by age bracket per census tract — br_prepare_population","text":"Downloads census population data IBGE (via censobr package), groups ages brackets, returns data frame one row per census tract. Supports census years 2000, 2010, 2022.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_population.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare Brazilian census population data by age bracket per census tract — br_prepare_population","text":"","code":"br_prepare_population(code_muni, year = 2010)"},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_population.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare Brazilian census population data by age bracket per census tract — br_prepare_population","text":"code_muni Numeric character vector. IBGE municipality codes. year Integer. Census year: 2000, 2010, 2022. Default: 2010.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_population.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare Brazilian census population data by age bracket per census tract — br_prepare_population","text":"data frame columns: code_muni, code_tract, population bracket columns (pop_*). exact brackets depend census year (see Details).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_population.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare Brazilian census population data by age bracket per census tract — br_prepare_population","text":"Requires censobr, dplyr, tidyr, data.table packages. Census 2000 2010 produce following voting-age brackets: pop_18_20, pop_21_24, pop_25_29, pop_30_39, pop_40_49, pop_50_59, pop_60_69. Census 2022 produces: pop_15_19, pop_20_24, pop_25_29, pop_30_39, pop_40_49, pop_50_59, pop_60_69. years also produce: pop_00_04, pop_05_09, pop_10_14, pop_15_17 (pop_15_19 2022), pop_70mais. Additionally, years produce gender × age columns used calibration: pop_hom_* pop_mul_* (7 age brackets , 14 columns total).","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_population.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare Brazilian census population data by age bracket per census tract — br_prepare_population","text":"","code":"if (FALSE) { # \\dontrun{ # Census 2010 population for Sao Paulo pop <- br_prepare_population(code_muni = \"3550308\", year = 2010) head(pop) } # }"},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_tracts.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare census tract shapefiles with population data for a Brazilian municipality — br_prepare_tracts","title":"Prepare census tract shapefiles with population data for a Brazilian municipality — br_prepare_tracts","text":"Downloads census tract geometries via geobr, joins population data br_prepare_population(), optionally clips urban area mask, removes unpopulated tracts.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_tracts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare census tract shapefiles with population data for a Brazilian municipality — br_prepare_tracts","text":"","code":"br_prepare_tracts(   code_muni,   pop_data,   clip_sf = NULL,   year = 2010,   crs = \"EPSG:5880\",   verbose = TRUE )"},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_tracts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare census tract shapefiles with population data for a Brazilian municipality — br_prepare_tracts","text":"code_muni Numeric character. IBGE municipality code. pop_data Data frame. Output br_prepare_population(). Must contain code_tract population bracket columns. clip_sf Optional sf polygon object. provided, census tracts clipped geometry (e.g., remove non-urban areas like parks, forests, water bodies). Population proportionally adjusted based fraction area retained. year Integer. Census tract geometry year. Default: 2010. crs Character integer. CRS output. Default: SIRGAS 2000 / Brazil Polyconic (EPSG:5880). verbose Logical. Print progress messages. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_tracts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare census tract shapefiles with population data for a Brazilian municipality — br_prepare_tracts","text":"sf object census tract polygons columns: code_tract, pop_* bracket columns pop_data, pop_total (sum brackets).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_tracts.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare census tract shapefiles with population data for a Brazilian municipality — br_prepare_tracts","text":"Requires geobr, sf, dplyr packages.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/br_prepare_tracts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare census tract shapefiles with population data for a Brazilian municipality — br_prepare_tracts","text":"","code":"if (FALSE) { # \\dontrun{ pop <- br_prepare_population(\"3550308\", year = 2010) tracts <- br_prepare_tracts(\"3550308\", pop) } # }"},{"path":"https://antrologos.github.io/interpElections/reference/check_r5r.html","id":null,"dir":"Reference","previous_headings":"","what":"Check r5r and Java 21 setup — check_r5r","title":"Check r5r and Java 21 setup — check_r5r","text":"Runs diagnostic check r5r dependency chain: whether r5r package installed whether suitable Java/JDK (version 21) available system.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/check_r5r.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check r5r and Java 21 setup — check_r5r","text":"","code":"check_r5r()"},{"path":"https://antrologos.github.io/interpElections/reference/check_r5r.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check r5r and Java 21 setup — check_r5r","text":"Invisibly, list components: r5r_installed Logical. java_found Logical. java_version Integer major version, NA. java_sufficient Logical. TRUE version exactly 21. java_memory Character NULL. Configured JVM max heap (e.g. \"4g\"). system_ram Character NULL. Total system RAM (e.g. \"16 GB\"). ready Logical. TRUE checks pass.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/check_r5r.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check r5r and Java 21 setup — check_r5r","text":"","code":"if (FALSE) { # \\dontrun{ check_r5r() } # }"},{"path":"https://antrologos.github.io/interpElections/reference/check_torch.html","id":null,"dir":"Reference","previous_headings":"","what":"Check torch and GPU setup — check_torch","title":"Check torch and GPU setup — check_torch","text":"Runs comprehensive diagnostic torch dependency chain: whether torch R package installed, whether libtorch/lantern binaries present, GPU hardware available, whether CUDA MPS acceleration actually working.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/check_torch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check torch and GPU setup — check_torch","text":"","code":"check_torch(verbose = TRUE)"},{"path":"https://antrologos.github.io/interpElections/reference/check_torch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check torch and GPU setup — check_torch","text":"verbose Logical. Print diagnostic messages. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/check_torch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check torch and GPU setup — check_torch","text":"Invisibly, list components: torch_installed Logical. torch R package installed? torch_version Character NA. torch package version. binaries_installed Logical. libtorch/lantern binaries present? gpu_hardware Character. \"nvidia\", \"apple_silicon\", \"none\". gpu_name Character NA. GPU name hardware detection. gpu_vram Character NA. VRAM MB (NVIDIA ). cuda_available Logical. torch report CUDA available? cuda_runtime Character NA. CUDA runtime version. cuda_compute Character NA. GPU compute capability. cudnn_available Logical. mps_available Logical. MPS available (Apple Silicon)? tensor_test Logical. Can tensor created GPU? device Character. Best available device: \"cuda\", \"mps\", \"cpu\". ready Logical. TRUE GPU acceleration fully working.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/check_torch.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Check torch and GPU setup — check_torch","text":"","code":"if (FALSE) { # \\dontrun{ check_torch() } # }"},{"path":"https://antrologos.github.io/interpElections/reference/coef.interpElections_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract alpha coefficients — coef.interpElections_result","title":"Extract alpha coefficients — coef.interpElections_result","text":"Returns alpha decay parameter vector, plays role \"coefficients\" IDW model.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/coef.interpElections_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract alpha coefficients — coef.interpElections_result","text":"","code":"# S3 method for class 'interpElections_result' coef(object, ...)"},{"path":"https://antrologos.github.io/interpElections/reference/coef.interpElections_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract alpha coefficients — coef.interpElections_result","text":"object interpElections_result object. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/coef.interpElections_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract alpha coefficients — coef.interpElections_result","text":"Numeric vector length n (one alpha per census tract).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compare_baselines.html","id":null,"dir":"Reference","previous_headings":"","what":"Compare interpolation against baseline methods — compare_baselines","title":"Compare interpolation against baseline methods — compare_baselines","text":"Recomputes calibration residuals naive weight matrices reports comparison table showing value added optimization.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compare_baselines.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compare interpolation against baseline methods — compare_baselines","text":"","code":"compare_baselines(result, methods = c(\"nearest\", \"uniform\", \"areal\"), ...)"},{"path":"https://antrologos.github.io/interpElections/reference/compare_baselines.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compare interpolation against baseline methods — compare_baselines","text":"result interpElections_result object. methods Character vector. Baseline methods compare: \"nearest\" (assign nearest station), \"uniform\" (equal weights), \"areal\" (area-based interpolation). Default: three. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compare_baselines.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compare interpolation against baseline methods — compare_baselines","text":"data frame columns: method, rmse, poisson_deviance, relative_improvement. Prints table. Returns invisibly.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compute_representative_points.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute representative points for census tracts — compute_representative_points","title":"Compute representative points for census tracts — compute_representative_points","text":"Computes single representative point census tract polygon. Three methods available: geometric point--surface (default), centroid, population-density-weighted using WorldPop raster data.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compute_representative_points.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute representative points for census tracts — compute_representative_points","text":"","code":"compute_representative_points(   tracts_sf,   method = c(\"point_on_surface\", \"centroid\", \"pop_weighted\"),   pop_raster = NULL,   min_area_for_pop_weight = 1,   tract_id = \"id\",   verbose = TRUE )"},{"path":"https://antrologos.github.io/interpElections/reference/compute_representative_points.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute representative points for census tracts — compute_representative_points","text":"tracts_sf sf polygon object containing census tract geometries. method Character. Method computing representative points: \"point_on_surface\" (Default) Uses sf::st_point_on_surface(). Guarantees point falls inside polygon, unlike centroids can fall outside concave shapes. \"centroid\" Uses sf::st_centroid(). Classic geometric centroid. May fall outside concave polygons. \"pop_weighted\" Uses population density raster (WorldPop Constrained 2020 default) find populated cell within tract. applied tracts area >= min_area_for_pop_weight; smaller tracts use point_on_surface. Requires terra package. pop_raster terra::SpatRaster object, file path GeoTIFF, NULL. Population density raster method = \"pop_weighted\". NULL (default), WorldPop Brazil Constrained 2020 raster (~48 MB) downloaded automatically cached. Ignored methods. min_area_for_pop_weight Numeric. Minimum tract area km² applying population-weighted method. Tracts smaller threshold use point_on_surface instead. Default: 1 (km²). used method = \"pop_weighted\". tract_id Character. Name ID column tracts_sf. Default: \"id\". verbose Logical. Print progress messages? Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compute_representative_points.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute representative points for census tracts — compute_representative_points","text":"sf POINT object WGS84 (EPSG:4326) one row per tract, preserving tract_id column. Carries attribute \"point_method\" recording method used.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compute_representative_points.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute representative points for census tracts — compute_representative_points","text":"","code":"if (FALSE) { # \\dontrun{ tracts <- br_prepare_tracts(code_muni = 3170701) tracts$id <- tracts$code_tract  # Default: point on surface pts <- compute_representative_points(tracts)  # Population-weighted for large tracts pts_pop <- compute_representative_points(tracts, method = \"pop_weighted\") } # }"},{"path":"https://antrologos.github.io/interpElections/reference/compute_travel_times.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute a travel-time matrix from census tract representative points to source points — compute_travel_times","title":"Compute a travel-time matrix from census tract representative points to source points — compute_travel_times","text":"Builds travel-time matrix using r5r routing engine. Computes travel times representative points target census tracts geolocated source points (e.g., polling locations).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compute_travel_times.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute a travel-time matrix from census tract representative points to source points — compute_travel_times","text":"","code":"compute_travel_times(   tracts_sf,   points_sf,   network_path,   tract_id = \"id\",   point_id = \"id\",   routing = routing_control(),   verbose = TRUE,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/compute_travel_times.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute a travel-time matrix from census tract representative points to source points — compute_travel_times","text":"tracts_sf sf object polygon geometries. Target census tracts. points_sf sf object point geometries. Source points. network_path Character. Path directory containing OSM .pbf file building r5r network. tract_id Character. Name ID column tracts_sf. Default: \"id\". point_id Character. Name ID column points_sf. Default: \"id\". routing routing_control() object routing parameters (mode, point_method, max_trip_duration, n_threads, gtfs_zip_path, departure_datetime, pop_raster, min_area_for_pop_weight, osm_buffer_km, fill_missing). Default: routing_control(). verbose Logical. Default: TRUE. ... Deprecated. Old-style individual parameters (point_method, pop_raster, min_area_for_pop_weight, mode, max_trip_duration, fill_missing, n_threads, departure_datetime, gtfs_zip_path) still accepted via ... backward compatibility removed future release. Use routing = routing_control(...) instead.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compute_travel_times.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute a travel-time matrix from census tract representative points to source points — compute_travel_times","text":"numeric matrix [n_tracts x n_points]. Travel times minutes. Row names = census tract IDs, column names = point IDs. Unreachable pairs filled fill_missing.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compute_travel_times.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute a travel-time matrix from census tract representative points to source points — compute_travel_times","text":"Requires r5r sf packages. r5r requires exactly Java/JDK 21. Use download_r5r_data() obtain OSM data needed network_path.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/compute_travel_times.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute a travel-time matrix from census tract representative points to source points — compute_travel_times","text":"","code":"if (FALSE) { # \\dontrun{ tt <- compute_travel_times(   tracts_sf = tracts, points_sf = stations,   network_path = \"path/to/osm_data\",   tract_id = \"code_tract\", point_id = \"id\" )  # Transit mode with GTFS tt <- compute_travel_times(   tracts_sf = tracts, points_sf = stations,   network_path = \"path/to/osm_data\",   routing = routing_control(     mode = c(\"WALK\", \"TRANSIT\"),     gtfs_zip_path = \"sptrans.zip\",     departure_datetime = as.POSIXct(\"2022-10-02 10:00:00\")   ) ) } # }"},{"path":"https://antrologos.github.io/interpElections/reference/compute_weight_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the weight matrix — compute_weight_matrix","title":"Compute the weight matrix — compute_weight_matrix","text":"Builds weight matrix \\(W\\) per-tract-per-bracket decay parameters using column normalization. Uses torch computation (CPU GPU).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compute_weight_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the weight matrix — compute_weight_matrix","text":"","code":"compute_weight_matrix(   time_matrix,   alpha,   pop_matrix,   source_matrix,   offset = 1,   use_gpu = NULL,   verbose = FALSE )"},{"path":"https://antrologos.github.io/interpElections/reference/compute_weight_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the weight matrix — compute_weight_matrix","text":"time_matrix Numeric matrix [n x m]. Travel times distances zone (row) source point (column). alpha Numeric scalar, vector length n, matrix [n x k]. Per-tract-per-bracket decay parameters. scalar n-vector recycled across k brackets. Typically optimize_alpha()$alpha. pop_matrix Numeric matrix [n x k]. Known population counts per zone demographic bracket. source_matrix Numeric matrix [m x k]. Known counts source points per demographic bracket. offset Numeric scalar. Added time_matrix exponentiation: \\(K^b_{ij} = (t_{ij} + \\text{offset})^{-\\alpha_{ib}}\\). Default: 1. use_gpu Logical NULL. TRUE, use GPU; FALSE, use CPU; NULL (default), respect global setting use_gpu(). verbose Logical. Print progress? Default: FALSE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compute_weight_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the weight matrix — compute_weight_matrix","text":"Numeric matrix [n x m]. Column-normalized weight matrix column sums approximately 1. Use W \\%*\\% data interpolate source-level variable zones.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/compute_weight_matrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute the weight matrix — compute_weight_matrix","text":"function performs column normalization used internally optimize_alpha() epoch evaluation. useful pre-computed alpha values need build weight matrix without running optimization. Column normalization ensures voter conservation: source-bracket pair distributes full count across zones.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/compute_weight_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the weight matrix — compute_weight_matrix","text":"","code":"if (FALSE) { # \\dontrun{ # After optimization result <- optimize_alpha(tt, pop, src) W <- result$W   # weight matrix already computed  # Or build W from pre-existing alpha W <- compute_weight_matrix(tt, alpha, pop, src) interpolated <- W %*% electoral_data } # }"},{"path":"https://antrologos.github.io/interpElections/reference/diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Run diagnostic checks on an interpolation result — diagnostics","title":"Run diagnostic checks on an interpolation result — diagnostics","text":"Performs automated validation interpElections result. Prints checklist PASS/WARN/FAIL results. includes checks whose outcome guaranteed construction.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run diagnostic checks on an interpolation result — diagnostics","text":"","code":"diagnostics(result, verbose = TRUE)"},{"path":"https://antrologos.github.io/interpElections/reference/diagnostics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run diagnostic checks on an interpolation result — diagnostics","text":"result interpElections_result object. verbose Logical. Print checklist? Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/diagnostics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run diagnostic checks on an interpolation result — diagnostics","text":"Invisibly, list class \"interpElections_diagnostics\" checks element containing computed values.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/download_r5r_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Download OSM and elevation data for r5r routing — download_r5r_data","title":"Download OSM and elevation data for r5r routing — download_r5r_data","text":"Downloads OpenStreetMap road network (.pbf file) optionally satellite elevation data needed build r5r routing network. output directory can passed directly compute_travel_times() network_path.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/download_r5r_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download OSM and elevation data for r5r routing — download_r5r_data","text":"","code":"download_r5r_data(   area_sf,   output_dir,   osm = TRUE,   elevation = FALSE,   osm_provider = \"geofabrik\",   osm_url = NULL,   force = FALSE,   verbose = TRUE )"},{"path":"https://antrologos.github.io/interpElections/reference/download_r5r_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download OSM and elevation data for r5r routing — download_r5r_data","text":"area_sf sf object defining area interest. bounding box used select appropriate OSM extract clip downloaded file. output_dir Character. Directory save downloaded files. Created exist. osm Logical. Download OpenStreetMap road network. Default: TRUE. elevation Logical. Download elevation raster accurate walking/cycling routing hilly terrain. Default: FALSE. osm_provider Character. OSM extract provider osmextract. Default: \"geofabrik\". Alternatives: \"bbbike\", \"openstreetmap_fr\". osm_url Character NULL. Direct URL OSM .pbf extract. provided, skips automatic osmextract::oe_match() step downloads URL directly. useful oe_match() selects overly broad extract (e.g., country-level instead state-level). Default: NULL (auto-detect via oe_match()). force Logical. Re-download even files already exist. Default: FALSE. verbose Logical. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/download_r5r_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download OSM and elevation data for r5r routing — download_r5r_data","text":"list paths downloaded files: osm_pbf Character. Path OSM .pbf file (NULL osm = FALSE). elevation_tif Character. Path elevation .tif file (NULL elevation = FALSE). output_dir Character. output directory path.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/download_r5r_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Download OSM and elevation data for r5r routing — download_r5r_data","text":"downloading provider extract (may cover whole state), .pbf file clipped bounding box area_sf using osmium osmconvert (available system). avoids r5r's geographic extent limit (~975,000 km2). Requires osmextract package OSM downloads optionally elevatr package elevation data. suggested dependencies package. clipping large OSM extracts, osmium-tool (recommended) osmconvert must installed. neither found, function interactively offer install one via setup_osmium() proceeding. non-interactive mode, stops actionable error message. dependency checks (R packages clipping tools) run start, downloads begin.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/get_interpElections_cache_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Get the interpElections cache directory — get_interpElections_cache_dir","title":"Get the interpElections cache directory — get_interpElections_cache_dir","text":"Returns path directory interpElections stores cached downloaded files (TSE data, Hidalgo geocoding, travel time matrices, etc.). default location OS-appropriate (via tools::R_user_dir()).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/get_interpElections_cache_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get the interpElections cache directory — get_interpElections_cache_dir","text":"","code":"get_interpElections_cache_dir()"},{"path":"https://antrologos.github.io/interpElections/reference/get_interpElections_cache_dir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get the interpElections cache directory — get_interpElections_cache_dir","text":"Character. Path cache directory.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/interpElections-package.html","id":null,"dir":"Reference","previous_headings":"","what":"interpElections: Spatial Interpolation of Electoral Data via Inverse Distance Weighting — interpElections-package","title":"interpElections: Spatial Interpolation of Electoral Data via Inverse Distance Weighting — interpElections-package","text":"Spatial interpolation electoral data via inverse distance weighting column-normalized weights per-census-tract optimized decay parameters. Designed disaggregating voting results polling locations census tracts using travel-time-based IDW. Optimization uses torch autograd (ADAM) CPU GPU.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/interpElections-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"interpElections: Spatial Interpolation of Electoral Data via Inverse Distance Weighting — interpElections-package","text":"Maintainer: Rogerio Barbosa rogerio.barbosa@iesp.uerj.br Authors: Lucas Gelape","code":""},{"path":"https://antrologos.github.io/interpElections/reference/interpElections_cache.html","id":null,"dir":"Reference","previous_headings":"","what":"Manage the interpElections download cache — interpElections_cache","title":"Manage the interpElections download cache — interpElections_cache","text":"Unified interface cache management. action parameter selects one four operations: list contents (\"list\", default), clean category (\"clean\"), query cache directory path (\"dir\"), set custom cache directory (\"set_dir\").","code":""},{"path":"https://antrologos.github.io/interpElections/reference/interpElections_cache.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Manage the interpElections download cache — interpElections_cache","text":"","code":"interpElections_cache(   action = c(\"list\", \"clean\", \"dir\", \"set_dir\"),   category = NULL,   path = NULL,   delete_file = NULL,   details = FALSE,   verbose = TRUE )"},{"path":"https://antrologos.github.io/interpElections/reference/interpElections_cache.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Manage the interpElections download cache — interpElections_cache","text":"action Character. One : \"list\" (Default) Print per-category size breakdown return cached file paths. Supports delete_file details. \"clean\" Delete cached files category. \"dir\" Return current cache directory path. \"set_dir\" Set custom cache directory via path. Pass path = NULL reset OS default. category Character (action = \"clean\"). category clear. One : \"\", \"downloads\", \"processed\", \"networks\", \"travel_times\", \"pop_raster\", \"votes\", \"turnout\", \"geocode\", \"profile\", \"hidalgo\", \"osm\", \"electoral\", \"tracts\", \"r5r\". Default: \"\". path Character NULL (action = \"set_dir\"). Directory path cached files. Created exist. NULL resets default. delete_file Character NULL (action = \"list\"). pattern match files deletion (via grepl()), \"\" delete entire cache. details Logical (action = \"list\"). TRUE, also prints individual filenames within category. Default: FALSE. verbose Logical. Print messages. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/interpElections_cache.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Manage the interpElections download cache — interpElections_cache","text":"Depends action: \"list\" Invisibly returns character vector cached file paths (deletion). \"clean\" Invisibly returns path(s) deleted. \"dir\" Character string: path cache directory. \"set_dir\" Invisibly returns (new) cache directory path.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/interpElections_cache.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Manage the interpElections download cache — interpElections_cache","text":"","code":"if (FALSE) { # \\dontrun{ # Per-category summary (default action) interpElections_cache()  # Detailed listing (every file) interpElections_cache(details = TRUE)  # Delete files matching a pattern interpElections_cache(delete_file = \"2020\")  # Delete everything interpElections_cache(delete_file = \"all\")  # Get cache directory interpElections_cache(\"dir\")  # Set custom cache directory interpElections_cache(\"set_dir\", path = \"/tmp/my_cache\")  # Reset to default directory interpElections_cache(\"set_dir\", path = NULL)  # Clean by category interpElections_cache(\"clean\", category = \"votes\")  # Clean everything interpElections_cache(\"clean\", category = \"all\") } # }"},{"path":"https://antrologos.github.io/interpElections/reference/interpElections_cache_clean.html","id":null,"dir":"Reference","previous_headings":"","what":"Delete cached files by category — interpElections_cache_clean","title":"Delete cached files by category — interpElections_cache_clean","text":"Internal workhorse interpElections_cache(\"clean\", ...). Use interpElections_cache(\"clean\", category = \"votes\") instead calling directly.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/interpElections_cache_clean.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Delete cached files by category — interpElections_cache_clean","text":"","code":"interpElections_cache_clean(   category = c(\"all\", \"downloads\", \"processed\", \"networks\", \"travel_times\", \"pop_raster\",     \"votes\", \"turnout\", \"geocode\", \"profile\", \"hidalgo\", \"osm\", \"electoral\", \"tracts\",     \"r5r\"),   verbose = TRUE )"},{"path":"https://antrologos.github.io/interpElections/reference/interpElections_cache_clean.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Delete cached files by category — interpElections_cache_clean","text":"category Character. category clear. verbose Logical. Print messages. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/interpElections_cache_clean.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Delete cached files by category — interpElections_cache_clean","text":"Invisibly returns path(s) deleted.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election.html","id":null,"dir":"Reference","previous_headings":"","what":"One-step IDW interpolation from source points to census tracts — interpolate_election","title":"One-step IDW interpolation from source points to census tracts — interpolate_election","text":"General-purpose wrapper combines travel-time computation (optional), alpha optimization, interpolation single call. Accepts R objects (sf data frames) directly. travel time matrix provided, OSM road network data automatically downloaded travel times computed via r5r.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"One-step IDW interpolation from source points to census tracts — interpolate_election","text":"","code":"interpolate_election(   tracts_sf,   electoral_sf,   calib_tracts,   calib_sources,   interp_sources = NULL,   tract_id = \"id\",   point_id = \"id\",   time_matrix = NULL,   optim = optim_control(),   routing = routing_control(),   min_tract_pop = 1,   offset = 1,   keep = NULL,   verbose = TRUE,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"One-step IDW interpolation from source points to census tracts — interpolate_election","text":"tracts_sf sf polygon object. Target census tracts. electoral_sf sf point object. Source points (e.g., voting locations). calib_tracts Character vector. Column names tracts_sf use calibration population matrix. Must match calib_sources length. calib_sources Character vector. Column names electoral_sf use source calibration matrix. Must match calib_tracts length. interp_sources Character vector NULL. Column names electoral_sf interpolate. Default NULL means numeric columns calib_sources. tract_id Character. Name ID column tracts_sf. Default: \"id\". point_id Character. Name ID column electoral_sf. Default: \"id\". time_matrix Numeric matrix [n x m] NULL. Pre-computed travel times. provided, skips travel time computation. optim optim_control() object optimization parameters. Default: optim_control(). routing routing_control() object routing parameters. Default: routing_control(). min_tract_pop Numeric. Minimum total population calib_tracts census tract included. Default: 1. offset Numeric. Travel time offset. Default: 1. keep Character vector NULL. Names extra intermediate objects include result. weights time_matrix always kept. Options: \"electoral_sf\", \"pop_raster\", \"rep_points\". verbose Logical. Print progress. Default: TRUE. ... Advanced arguments. network_path (character) pre-downloaded OSM data, elevation_path (character) elevation GeoTIFF. Also accepts deprecated old-style parameters (max_epochs, alpha_min, use_gpu, mode, gtfs_zip_path, etc.) backward compatibility.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"One-step IDW interpolation from source points to census tracts — interpolate_election","text":"list class \"interpElections_result\" components: interpolated Numeric matrix [n x p]. Interpolated values. alpha Decay parameters used. tracts_sf sf object interpolated columns joined. sources Data frame (geometry) source point data. optimization interpElections_optim object. offset Numeric. Offset value used. call matched call. tract_id, point_id ID column names. interp_cols Character vector. Interpolated column names. calib_cols List $tracts $sources. weights Weight matrix NULL (opt-via keep). time_matrix Travel time matrix NULL (opt-via keep). electoral_sf sf point object NULL (opt-via keep). pop_raster Population raster NULL (opt-via keep). rep_points Representative points NULL (opt-via keep).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"One-step IDW interpolation from source points to census tracts — interpolate_election","text":"Brazilian elections, use interpolate_election_br() auto-downloads required data.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"One-step IDW interpolation from source points to census tracts — interpolate_election","text":"","code":"if (FALSE) { # \\dontrun{ # Minimal: sf objects + column names (auto-downloads OSM) result <- interpolate_election(   tracts_sf    = census_tracts,   electoral_sf = voting_stations,   calib_tracts  = c(\"pop_18_24\", \"pop_25_34\"),   calib_sources = c(\"voters_18_24\", \"voters_25_34\") )  # With pre-computed travel times (skip r5r) result <- interpolate_election(   tracts_sf    = census_tracts,   electoral_sf = voting_stations,   calib_tracts  = c(\"pop_young\", \"pop_old\"),   calib_sources = c(\"voters_young\", \"voters_old\"),   time_matrix  = my_tt_matrix )  # GPU optimization with custom routing result <- interpolate_election(   tracts_sf    = census_tracts,   electoral_sf = voting_stations,   calib_tracts  = c(\"pop_young\", \"pop_old\"),   calib_sources = c(\"voters_young\", \"voters_old\"),   optim   = optim_control(use_gpu = TRUE),   routing = routing_control(mode = c(\"WALK\", \"TRANSIT\")) ) } # }"},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election_br.html","id":null,"dir":"Reference","previous_headings":"","what":"Interpolate Brazilian election data into census tracts — interpolate_election_br","title":"Interpolate Brazilian election data into census tracts — interpolate_election_br","text":"Downloads census data, electoral results, tract geometries, road networks automatically. requires municipality identifier election year. Internally calls interpolate_election() preparing inputs.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election_br.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interpolate Brazilian election data into census tracts — interpolate_election_br","text":"","code":"interpolate_election_br(   municipality,   year,   cargo = NULL,   turno = 1L,   what = \"candidates\",   candidates = NULL,   parties = NULL,   uf = NULL,   census_year = NULL,   clip_tracts_sf = NULL,   min_tract_pop = 1,   time_matrix = NULL,   optim = optim_control(),   routing = routing_control(),   offset = 1,   force = FALSE,   keep = NULL,   verbose = TRUE,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election_br.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interpolate Brazilian election data into census tracts — interpolate_election_br","text":"municipality Numeric character. Either 7-digit IBGE municipality code (e.g., 3550308 Sao Paulo) municipality name (e.g., \"Sao Paulo\", \"São Paulo\"). Name matching case/accent-insensitive. Use uf disambiguate name exists multiple states. year Integer. Election year (even integer). cargo Integer, character, NULL. Electoral office(s). Accepts aliases like \"presidente\", \"vereador\" TSE codes. NULL = offices year. See Details. turno Integer. Election round: 1 (default) 2 (runoff). Character vector. interpolate: \"candidates\" (default), \"parties\", \"turnout\", \"demographics\". Multiple values can combined. candidates Character numeric vector, NULL. Filter candidates ballot number name substring. Default: . parties Character vector NULL. Filter parties TSE abbreviation (e.g., c(\"PT\", \"PL\")). Default: . uf Two-letter state abbreviation disambiguation municipality name. Default: NULL. census_year Integer NULL. Census year (2000, 2010, 2022). NULL = auto-selected election year. clip_tracts_sf sf polygon NULL. Clip tracts geometry interpolation. min_tract_pop Minimum total population tract include . Tracts dropped. Default: 1. time_matrix Pre-computed travel time matrix [n x m], NULL. provided, skips routing (r5r, OSM download). optim optim_control() object optimization parameters. Default: optim_control(). routing routing_control() object routing parameters. Default: routing_control(). gtfs_zip_path set departure_datetime NULL, departure auto-set election day 10 . offset Numeric. Travel time offset. Default: 1. force Re-download cached data. Default: FALSE. keep Character vector extra objects include result. weights time_matrix always kept. Options: \"electoral_sf\", \"pop_raster\", \"rep_points\". verbose Print progress messages. Default: TRUE. ... Advanced arguments. network_path (character), cache (logical, default TRUE), osm_provider (character), comparecimento_path, votacao_path, geocode_path, interp_sources. Also accepts deprecated old-style parameters backward compatibility.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election_br.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interpolate Brazilian election data into census tracts — interpolate_election_br","text":"interpElections_result list. Key fields: $tracts_sf (sf interpolated columns), $interpolated (matrix [n x p]), $alpha (decay parameters), $optimization (optimizer details).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election_br.html","id":"quick-start","dir":"Reference","previous_headings":"","what":"Quick start","title":"Interpolate Brazilian election data into census tracts — interpolate_election_br","text":"","code":"result <- interpolate_election_br(3550308, 2022) plot(result)"},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election_br.html","id":"re-interpolation","dir":"Reference","previous_headings":"","what":"Re-interpolation","title":"Interpolate Brazilian election data into census tracts — interpolate_election_br","text":"Use reinterpolate() re-run different candidates/parties without recomputing travel times:","code":"result <- interpolate_election_br(3550308, 2022) result2 <- reinterpolate(result, what = \"parties\")"},{"path":"https://antrologos.github.io/interpElections/reference/interpolate_election_br.html","id":"advanced-tuning","dir":"Reference","previous_headings":"","what":"Advanced tuning","title":"Interpolate Brazilian election data into census tracts — interpolate_election_br","text":"Use optim_control() adjust optimization parameters (epochs, learning rate, GPU, etc.) routing_control() travel-time computation (mode, GTFS, representative points, etc.).","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/leave_one_out.html","id":null,"dir":"Reference","previous_headings":"","what":"Leave-one-out pseudo cross-validation — leave_one_out","title":"Leave-one-out pseudo cross-validation — leave_one_out","text":"polling station (random sample), removes source data, re-optimizes alpha remaining stations, predicts removed station's demographics. form --sample validation available.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/leave_one_out.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Leave-one-out pseudo cross-validation — leave_one_out","text":"","code":"leave_one_out(result, max_stations = 30L, verbose = TRUE, ...)"},{"path":"https://antrologos.github.io/interpElections/reference/leave_one_out.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Leave-one-out pseudo cross-validation — leave_one_out","text":"result interpElections_result object. max_stations Integer. Maximum stations evaluate. municipality stations, random sample used. Default: 30. verbose Logical. Print progress? Default: TRUE. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/leave_one_out.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Leave-one-out pseudo cross-validation — leave_one_out","text":"data frame one row per evaluated station, containing prediction errors. Returns NULL required data missing.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/muni_crosswalk.html","id":null,"dir":"Reference","previous_headings":"","what":"IBGE-TSE Municipality Code Crosswalk — muni_crosswalk","title":"IBGE-TSE Municipality Code Crosswalk — muni_crosswalk","text":"Official crosswalk table mapping IBGE 7-digit municipality codes TSE 5-digit electoral codes 5,710 Brazilian municipalities. Sourced GV-CEPESP.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/muni_crosswalk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IBGE-TSE Municipality Code Crosswalk — muni_crosswalk","text":"","code":"muni_crosswalk"},{"path":"https://antrologos.github.io/interpElections/reference/muni_crosswalk.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"IBGE-TSE Municipality Code Crosswalk — muni_crosswalk","text":"data frame 5,710 rows 4 columns: code_ibge Character. IBGE 7-digit municipality code. code_tse Character. TSE 5-digit municipality code. uf Character. Two-letter state abbreviation (e.g., \"SP\", \"RJ\"). nome Character. Municipality name uppercase.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/muni_crosswalk.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"IBGE-TSE Municipality Code Crosswalk — muni_crosswalk","text":"GV-CEPESP, FGV: https://github.com/GV-CEPESP/cepespdata/blob/main/tabelas_auxiliares/dados/codigo_municipio_ibge_tse.csv","code":""},{"path":"https://antrologos.github.io/interpElections/reference/muni_crosswalk.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"IBGE-TSE Municipality Code Crosswalk — muni_crosswalk","text":"","code":"data(muni_crosswalk) # Look up TSE code for Sao Paulo (IBGE 3550308) muni_crosswalk[muni_crosswalk$code_ibge == \"3550308\", ] #>      code_ibge code_tse uf      nome #> 5360   3550308    71072 SP SÃO PAULO"},{"path":"https://antrologos.github.io/interpElections/reference/optimize_alpha.html","id":null,"dir":"Reference","previous_headings":"","what":"Find optimal decay parameters (alpha) for spatial interpolation — optimize_alpha","title":"Find optimal decay parameters (alpha) for spatial interpolation — optimize_alpha","text":"Optimizes per-tract-per-bracket decay parameters minimize error interpolated values known population counts. Uses per-bracket SGD column normalization log-barrier penalty inside torch autograd. demographic bracket gets per-tract kernel; gradients flow computations. Works CPU GPU (CUDA/MPS).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/optimize_alpha.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find optimal decay parameters (alpha) for spatial interpolation — optimize_alpha","text":"","code":"optimize_alpha(   time_matrix,   pop_matrix,   source_matrix,   row_targets = NULL,   optim = optim_control(),   offset = 1,   verbose = TRUE,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/optimize_alpha.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find optimal decay parameters (alpha) for spatial interpolation — optimize_alpha","text":"time_matrix Numeric matrix [n x m]. Raw travel times. Rows = target zones, columns = source points. pop_matrix Numeric matrix [n x k]. Known population per zone, k demographic groups columns. source_matrix Numeric matrix [m x k]. Known counts source points (e.g., registered voters age group). row_targets Numeric vector length n, NULL. Target row sums balancing. element specifies much weight zone attract, proportional share total population. NULL (default), auto-computed rowSums(pop_matrix) / sum(pop_matrix) * m. optim optim_control() object optimization parameters (max_epochs, lr_init, convergence_tol, patience, barrier_mu, alpha_init, alpha_min, use_gpu, device, dtype). Default: optim_control(). offset Numeric. Value added travel times exponentiation. Default: 1. verbose Logical. Print progress messages? Default: TRUE. ... Deprecated. Old-style individual parameters (alpha_init, max_epochs, lr_init, use_gpu, device, dtype, convergence_tol, patience, barrier_mu, alpha_min) still accepted via ... backward compatibility, removed future release. Use optim = optim_control(...) instead.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/optimize_alpha.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find optimal decay parameters (alpha) for spatial interpolation — optimize_alpha","text":"list class \"interpElections_optim\" components: alpha Numeric matrix [n x k]. Optimal per-tract-per-bracket decay parameters. row census tract, column demographic bracket. Inactive brackets (zero population voters) filled 1. value Numeric. Objective function value optimum (Poisson deviance). W Numeric matrix [n x m]. Column-normalized weight matrix best-epoch. Use directly interpolation via W \\%*\\% data. Column sums approximately 1. method Character. Method used (e.g., \"pb_sgd_colnorm_cpu\", \"pb_sgd_colnorm_cuda\"). convergence Integer. 0 = early-stopped (improvement plateau detected); 1 = stopped max_epochs. epochs Integer. Number epochs completed. steps Integer. Total number SGD gradient steps. elapsed difftime object. Wall-clock time. message Character. Additional information. history Numeric vector. Full-dataset loss epoch. grad_norm_final Numeric. Final gradient norm (theta-space). grad_history Numeric vector. Gradient norm (theta-space) epoch. lr_history Numeric vector. Learning rate epoch.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/optimize_alpha.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Find optimal decay parameters (alpha) for spatial interpolation — optimize_alpha","text":"optimization requires torch R package. Install setup_torch() already available. Parameterization: alpha[,b] reparameterized alpha = alpha_min + softplus(theta) theta unconstrained, softplus(x) = log(1 + exp(x)). default alpha_min = 1, alpha always least 1 (inverse-distance decay steeper). Set alpha_min = 0 unconstrained optimization (similar legacy exp(theta)). Epoch structure: epoch one full-data gradient step exact gradients (column sums require tracts). loss reported epoch true objective evaluated full dataset. Two execution paths: CPU (default): use_gpu = FALSE NULL. Uses torch CPU device. Fast small/medium problems (< 2000 tracts). GPU: use_gpu = TRUE. Uses CUDA MPS. Faster large problems (> 2000 tracts). GPU memory usage bounded 2 * ka * n * m * bytes_per_elem.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/optimize_alpha.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find optimal decay parameters (alpha) for spatial interpolation — optimize_alpha","text":"","code":"if (FALSE) { # \\dontrun{ tt <- matrix(c(2, 5, 3, 4, 6, 2), nrow = 2) pop <- matrix(c(100, 200), nrow = 2) src <- matrix(c(80, 120, 100), nrow = 3) result <- optimize_alpha(tt, pop, src, verbose = FALSE) result$alpha  # With custom control result <- optimize_alpha(tt, pop, src,   optim = optim_control(use_gpu = TRUE, max_epochs = 5000),   verbose = FALSE) } # }"},{"path":"https://antrologos.github.io/interpElections/reference/optim_control.html","id":null,"dir":"Reference","previous_headings":"","what":"Optimization control parameters — optim_control","title":"Optimization control parameters — optim_control","text":"Creates control object SGD optimizer optimize_alpha(). parameters sensible defaults; override need.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/optim_control.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Optimization control parameters — optim_control","text":"","code":"optim_control(   max_epochs = 2000L,   lr_init = 0.05,   convergence_tol = 1e-04,   patience = 50L,   barrier_mu = 10,   alpha_init = 2,   alpha_min = 1,   use_gpu = NULL,   device = NULL,   dtype = \"float32\" )"},{"path":"https://antrologos.github.io/interpElections/reference/optim_control.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Optimization control parameters — optim_control","text":"max_epochs Integer. Maximum number epochs (full passes tracts). optimizer may stop earlier convergence detected. Default: 2000. lr_init Numeric. Initial ADAM learning rate. Reduced automatically via ReduceLROnPlateau epoch loss plateaus. Default: 0.05. convergence_tol Numeric. Relative change epoch loss optimizer considers solution converged. Default: 1e-4. patience Integer. Number consecutive epochs improvement (minimum learning rate) early stopping. LR scheduler uses 2 * patience patience. Default: 50. barrier_mu Numeric. Strength log-barrier penalty prevents census tract receiving zero predicted voters. Set 0 disable. Default: 10. alpha_init Numeric scalar, vector length n, matrix [n x k]. Initial guess alpha. scalar recycled tracts brackets. Default: 2. alpha_min Numeric. Lower bound alpha values. reparameterization becomes alpha = alpha_min + softplus(theta). Default: 1, restricts decay linear steeper. use_gpu Logical NULL. TRUE, use GPU (CUDA MPS). FALSE, use CPU. NULL (default), reads package option interpElections.use_gpu (set via use_gpu()). device Character NULL. Torch device: \"cuda\", \"mps\", \"cpu\". used GPU enabled. Default: NULL (auto-detect). dtype Character. Torch dtype: \"float32\" \"float64\". Default: \"float32\". Float32 halves memory usage negligible precision loss.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/optim_control.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Optimization control parameters — optim_control","text":"list class \"interpElections_optim_control\" one element per parameter.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/optim_control.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Optimization control parameters — optim_control","text":"","code":"# Default settings optim_control() #> interpElections optimization control: #>   max_epochs: 2000  #>   lr_init: 0.05  #>   convergence_tol: 1e-04  #>   patience: 50  #>   barrier_mu: 10  #>   alpha_init: 2  #>   alpha_min: 1  #>   use_gpu: NULL (auto)  #>   device: auto  #>   dtype: float32   # Use GPU with more epochs optim_control(use_gpu = TRUE, max_epochs = 5000) #> interpElections optimization control: #>   max_epochs: 5000  #>   lr_init: 0.05  #>   convergence_tol: 1e-04  #>   patience: 50  #>   barrier_mu: 10  #>   alpha_init: 2  #>   alpha_min: 1  #>   use_gpu: TRUE  #>   device: auto  #>   dtype: float32   # Stricter convergence optim_control(convergence_tol = 1e-6, patience = 100) #> interpElections optimization control: #>   max_epochs: 2000  #>   lr_init: 0.05  #>   convergence_tol: 1e-06  #>   patience: 100  #>   barrier_mu: 10  #>   alpha_init: 2  #>   alpha_min: 1  #>   use_gpu: NULL (auto)  #>   device: auto  #>   dtype: float32"},{"path":"https://antrologos.github.io/interpElections/reference/plot.interpElections_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot an interpolated variable as a choropleth map — plot.interpElections_result","title":"Plot an interpolated variable as a choropleth map — plot.interpElections_result","text":"Produces ggplot2 choropleth map interpolated variable. Variables can referenced column name, ballot number, candidate name, party abbreviation.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot.interpElections_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot an interpolated variable as a choropleth map — plot.interpElections_result","text":"","code":"# S3 method for class 'interpElections_result' plot(   x,   variable = NULL,   type = \"pct_tract\",   palette = \"RdYlBu\",   breaks = \"quantile\",   n_breaks = 5L,   title = NULL,   subtitle = NULL,   legend_title = NULL,   caption = NULL,   show_sources = FALSE,   border_color = \"white\",   border_width = 0.05,   limits = NULL,   scale_bar = TRUE,   ... )  # S3 method for class 'interpElections_result' autoplot(object, ...)"},{"path":"https://antrologos.github.io/interpElections/reference/plot.interpElections_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot an interpolated variable as a choropleth map — plot.interpElections_result","text":"x interpElections_result object. variable Variable plot. Accepts column name (e.g., \"CAND_13\"), ballot number (numeric, e.g. 13), candidate name substring (e.g., \"Lula\"), party abbreviation (e.g., \"PT\"). Multiple values produce faceted comparison. NULL, auto-selects first candidate variable. type Quantity map: \"pct_tract\" (default), \"absolute\", \"pct_muni\", \"pct_valid\", \"pct_eligible\", \"density\". palette Color palette name. RColorBrewer palettes (e.g., \"RdYlBu\", \"YlGnBu\", \"Spectral\") viridis palettes (e.g., \"viridis\", \"magma\", \"plasma\"). Default: \"RdYlBu\" (diverging, colorblind-friendly). breaks Scale breaks: \"quantile\" (default), \"continuous\", \"jenks\" (requires classInt), numeric vector custom break points. n_breaks Number breaks \"quantile\" \"jenks\". Default: 5. title Plot title. NULL = auto-generated dictionary (title-cased candidate name party). subtitle Plot subtitle. NULL = auto-generated municipality/year/quantity metadata. legend_title Legend title. NULL = auto-generated quantity type. caption Plot caption. NULL = auto-generated source note. Use \"\" suppress. show_sources Overlay source points (polling stations) map. Requires electoral_sf result (use keep = \"electoral_sf\" interpolating). Default: FALSE. border_color Tract border color. Default: \"white\". border_width Tract border width. Default: 0.05. limits Bounding box map extent c(xmin, xmax, ymin, ymax) CRS data (typically longitude/latitude). NULL (default) shows full extent. Use zoom region interest. scale_bar Add scale bar (requires ggspatial). Default: TRUE. ... Ignored. object interpElections_result object.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot.interpElections_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot an interpolated variable as a choropleth map — plot.interpElections_result","text":"ggplot object (invisibly). Can customized ggplot2 + syntax.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot.interpElections_result.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot an interpolated variable as a choropleth map — plot.interpElections_result","text":"","code":"if (FALSE) { # \\dontrun{ result <- interpolate_election_br(3304557, 2020, 2022)  # By candidate name (default: % of tract votes, quantile breaks) plot(result, variable = \"Lula\")  # By ballot number plot(result, variable = 13)  # Absolute counts with continuous scale plot(result, variable = \"PT\", type = \"absolute\",      breaks = \"continuous\")  # Faceted comparison plot(result, variable = c(\"Lula\", \"Bolsonaro\"))  # Zoom into a region plot(result, variable = \"Lula\",      limits = c(-43.2, -43.1, -22.95, -22.85))  # Composable with ggplot2 library(ggplot2) plot(result, variable = \"PT\") + theme_dark() } # }"},{"path":"https://antrologos.github.io/interpElections/reference/plot_alpha.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot alpha decay parameter diagnostics — plot_alpha","title":"Plot alpha decay parameter diagnostics — plot_alpha","text":"Visualize spatial distribution bracket variation optimized alpha decay parameters.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_alpha.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot alpha decay parameter diagnostics — plot_alpha","text":"","code":"plot_alpha(   result,   type = c(\"map\", \"histogram\", \"bracket\"),   summary_fn = \"median\",   brackets = NULL,   palette = \"YlOrRd\",   breaks = \"quantile\",   n_breaks = 5L,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/plot_alpha.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot alpha decay parameter diagnostics — plot_alpha","text":"result interpElections_result object. type Character. Plot type: \"map\", \"histogram\", \"bracket\". summary_fn Summary function collapsing alpha across brackets type = \"map\". One \"median\" (default), \"mean\", \"pop_weighted\", \"min\", \"max\", \"range\", integer bracket index. brackets Integer vector. Bracket indices include. NULL = . palette Character. Color palette. Default: \"YlOrRd\". breaks Break method: \"quantile\", \"continuous\", \"jenks\", numeric vector. n_breaks Integer. Number breaks. Default: 5. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_alpha.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot alpha decay parameter diagnostics — plot_alpha","text":"ggplot object (invisibly). Prints plot.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_connections.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot tract-station connections — plot_connections","title":"Plot tract-station connections — plot_connections","text":"Draws lines tract centroids assigned stations, width alpha proportional weight.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_connections.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot tract-station connections — plot_connections","text":"","code":"plot_connections(   result,   tract = NULL,   top_k = NULL,   threshold = 0.01,   show_all_tracts = TRUE,   palette = \"viridis\",   interactive = FALSE,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/plot_connections.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot tract-station connections — plot_connections","text":"result interpElections_result object. tract Tract ID(s) index(es). NULL overview. top_k Max connections per tract. threshold Min weight connection. show_all_tracts Logical. Show tract polygons background. palette Color palette. interactive Logical. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_connections.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot tract-station connections — plot_connections","text":"ggplot object (invisibly).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_convergence.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot optimization convergence diagnostics — plot_convergence","title":"Plot optimization convergence diagnostics — plot_convergence","text":"Multi-panel plot showing loss history, gradient norm, learning rate per epoch.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_convergence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot optimization convergence diagnostics — plot_convergence","text":"","code":"plot_convergence(   result,   which = c(\"loss\", \"gradient\", \"lr\"),   log_y = TRUE,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/plot_convergence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot optimization convergence diagnostics — plot_convergence","text":"result interpElections_result object. Character vector. panels show: combination \"loss\", \"gradient\", \"lr\". Default: three. log_y Logical. Use log scale y-axis? Default: TRUE. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_convergence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot optimization convergence diagnostics — plot_convergence","text":"ggplot object (invisibly). Prints plot.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_ecological.html","id":null,"dir":"Reference","previous_headings":"","what":"Cross-election consistency check — plot_ecological","title":"Cross-election consistency check — plot_ecological","text":"Compares tract-level results two election years check whether spatial patterns consistent.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_ecological.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cross-election consistency check — plot_ecological","text":"","code":"plot_ecological(   result,   result2,   variable = NULL,   type = c(\"scatter\", \"map\"),   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/plot_ecological.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cross-election consistency check — plot_ecological","text":"result interpElections_result object. result2 second interpElections_result object (different year). variable Variable name compare. NULL auto-matches party. type Character. \"scatter\" \"map\". Default: \"scatter\". ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_ecological.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cross-election consistency check — plot_ecological","text":"ggplot object (invisibly).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_income.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot income-vote ecological correlation — plot_income","title":"Plot income-vote ecological correlation — plot_income","text":"Downloads tract-level household head income via censobr produces scatter plot side--side map income vs. vote share.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_income.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot income-vote ecological correlation — plot_income","text":"","code":"plot_income(   result,   variable = NULL,   census_year = NULL,   type = c(\"scatter\", \"map\"),   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/plot_income.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot income-vote ecological correlation — plot_income","text":"result interpElections_result object (Brazilian). variable Variable correlate income. Accepts column name, ballot number, candidate name, party abbreviation. census_year Census year income data. NULL auto-detects result$census_year. Must 2000, 2010, 2022. type Character. \"scatter\" (default) \"map\". ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_income.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot income-vote ecological correlation — plot_income","text":"ggplot object (invisibly). Prints plot.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_income.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot income-vote ecological correlation — plot_income","text":"Income data downloaded IBGE via censobr package. deflation applied — values used -within-year correlation analysis. Variable sources census year: 2000: censobr::read_tracts(2000, \"Basico\"), variable VAR06 2010: censobr::read_tracts(2010, \"ResponsavelRenda\"), computed V022 / V020 2022: censobr::read_tracts(2022, \"ResponsavelRenda\"), variable V06004","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_interactive.html","id":null,"dir":"Reference","previous_headings":"","what":"Interactive map of interpolated results — plot_interactive","title":"Interactive map of interpolated results — plot_interactive","text":"Creates interactive leaflet/mapview map interpolated variable. Variables can referenced column name, ballot number, candidate name, party abbreviation. multiple variables provided, creates synchronized side--side panels via leafsync::sync().","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_interactive.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Interactive map of interpolated results — plot_interactive","text":"","code":"plot_interactive(   result,   variable = NULL,   type = \"pct_tract\",   palette = \"RdYlBu\",   breaks = \"quantile\",   n_breaks = 5L,   popup_vars = NULL,   alpha = 0.7,   legend = TRUE,   layer_name = NULL,   basemap = \"OpenStreetMap\",   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/plot_interactive.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Interactive map of interpolated results — plot_interactive","text":"result interpElections_result object. variable Variable map. Accepts column name, ballot number (numeric), candidate name substring, party abbreviation. Multiple values create synchronized comparison panels. NULL, auto-selects first candidate variable. type Quantity map: \"pct_tract\" (default), \"absolute\", \"pct_muni\", \"pct_valid\", \"pct_eligible\", \"density\". palette Color palette name. Default: \"RdYlBu\" (diverging, colorblind-friendly). breaks Scale breaks: \"quantile\" (default), \"continuous\", \"jenks\" (requires classInt), numeric vector custom break points. n_breaks Number breaks \"quantile\" \"jenks\". Default: 5. popup_vars Character vector column names show click popups. NULL, auto-selects census tract ID, plotted variable, turnout, calibration columns (capped 8). alpha Fill opacity (0 1). Default: 0.7. legend Show legend. Default: TRUE. layer_name Layer name map. NULL = auto-generated dictionary metadata. basemap Base map tile provider. Default: \"OpenStreetMap\". ... Additional arguments passed mapview::mapview().","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_interactive.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Interactive map of interpolated results — plot_interactive","text":"mapview object (single variable) leafsync object (multiple variables synchronized panels).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_interactive.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Interactive map of interpolated results — plot_interactive","text":"","code":"if (FALSE) { # \\dontrun{ result <- interpolate_election_br(3304557, 2022,                                    keep = \"electoral_sf\")  # Interactive map by candidate name plot_interactive(result, variable = \"Lula\", type = \"pct_tract\")  # Side-by-side comparison (synced panels) plot_interactive(result, variable = c(\"Lula\", \"Bolsonaro\"),                  type = \"pct_tract\")  # Custom popup plot_interactive(result, variable = \"PT\",                  popup_vars = c(\"code_tract\", \"PARTY_PT\",                                 \"QT_COMPARECIMENTO\")) } # }"},{"path":"https://antrologos.github.io/interpElections/reference/plot_moran.html","id":null,"dir":"Reference","previous_headings":"","what":"Moran's I and LISA cluster map for an interpolated variable — plot_moran","title":"Moran's I and LISA cluster map for an interpolated variable — plot_moran","text":"Computes global Moran's optionally maps Local Indicators Spatial Association (LISA) clusters interpolated variable.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_moran.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Moran's I and LISA cluster map for an interpolated variable — plot_moran","text":"","code":"plot_moran(   result,   variable = NULL,   type = c(\"lisa\", \"moran\"),   significance = 0.05,   nsim = 999L,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/plot_moran.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Moran's I and LISA cluster map for an interpolated variable — plot_moran","text":"result interpElections_result object. variable Variable analyze. Accepts column name, ballot number, candidate name, party abbreviation. type Character. \"moran\" Moran scatterplot, \"lisa\" LISA cluster map. Default: \"lisa\". significance Significance level LISA. Default: 0.05. nsim Number permutations. Default: 999. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_moran.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Moran's I and LISA cluster map for an interpolated variable — plot_moran","text":"ggplot object (invisibly).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_residuals.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot calibration residual diagnostics — plot_residuals","title":"Plot calibration residual diagnostics — plot_residuals","text":"Plot calibration residual diagnostics","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_residuals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot calibration residual diagnostics — plot_residuals","text":"","code":"plot_residuals(   result,   type = c(\"map\", \"histogram\", \"bracket\", \"scatter\"),   residual_type = c(\"raw\", \"pearson\", \"deviance\"),   summary_fn = \"rmse\",   brackets = NULL,   palette = \"RdBu\",   breaks = \"quantile\",   n_breaks = 5L,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/plot_residuals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot calibration residual diagnostics — plot_residuals","text":"result interpElections_result object. type Character. Plot type: \"map\", \"histogram\", \"bracket\", \"scatter\". residual_type Character. \"raw\", \"pearson\", \"deviance\". summary_fn Summary collapsing across brackets map mode. One \"rmse\" (default), \"mean_abs\", \"max_abs\", \"mean\", integer bracket index. brackets Integer vector bracket indices. NULL = . palette Color palette. Default: \"RdBu\". breaks Break method. n_breaks Integer. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_residuals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot calibration residual diagnostics — plot_residuals","text":"ggplot object (invisibly).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_residual_autocorrelation.html","id":null,"dir":"Reference","previous_headings":"","what":"Test residuals for spatial autocorrelation — plot_residual_autocorrelation","title":"Test residuals for spatial autocorrelation — plot_residual_autocorrelation","text":"Computes Moran's test spatial autocorrelation calibration residuals. Significant spatial autocorrelation suggests model misspecification — IDW kernel may missing spatial structure.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_residual_autocorrelation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test residuals for spatial autocorrelation — plot_residual_autocorrelation","text":"","code":"plot_residual_autocorrelation(   result,   summary_fn = \"rmse\",   residual_type = c(\"raw\", \"pearson\", \"deviance\"),   nsim = 999L,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/plot_residual_autocorrelation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test residuals for spatial autocorrelation — plot_residual_autocorrelation","text":"result interpElections_result object. summary_fn Summary function collapsing residuals across brackets: \"rmse\" (default), \"mean\", \"mean_abs\", \"max_abs\". residual_type Residual type: \"raw\", \"pearson\", \"deviance\". Default: \"raw\". nsim Integer. Number permutations test. Default: 999. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_residual_autocorrelation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test residuals for spatial autocorrelation — plot_residual_autocorrelation","text":"ggplot object (invisibly). Prints Moran scatterplot test result. Returns NULL message spdep installed.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_travel_times.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot travel time matrix diagnostics — plot_travel_times","title":"Plot travel time matrix diagnostics — plot_travel_times","text":"Visualize distribution spatial structure travel times census tracts polling stations.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_travel_times.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot travel time matrix diagnostics — plot_travel_times","text":"","code":"plot_travel_times(   result,   type = c(\"histogram\", \"heatmap\", \"map\"),   tract = NULL,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/plot_travel_times.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot travel time matrix diagnostics — plot_travel_times","text":"result interpElections_result object. type Character. Plot type: \"histogram\", \"heatmap\", \"map\". Default: \"histogram\". tract Tract ID index type = \"map\". NULL picks random tract. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_travel_times.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot travel time matrix diagnostics — plot_travel_times","text":"ggplot object (invisibly). Prints plot.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_travel_times.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot travel time matrix diagnostics — plot_travel_times","text":"\"histogram\": Distribution travel time values. Annotates maximum value (potential fill value unreachable pairs). \"heatmap\": Travel time matrix tile plot, tracts ordered latitude centroid. Reveals spatial locality. \"map\": selected tract, overlays station points colored travel time tract.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_turnout_rates.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot implied turnout rates by demographic bracket — plot_turnout_rates","title":"Plot implied turnout rates by demographic bracket — plot_turnout_rates","text":"Computes implied turnout rate per tract bracket ratio interpolated voters census population. Rates exceeding 100% indicate boundary effects registration mismatches.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_turnout_rates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot implied turnout rates by demographic bracket — plot_turnout_rates","text":"","code":"plot_turnout_rates(   result,   type = c(\"bracket\", \"map\", \"histogram\"),   summary_fn = \"mean\",   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/plot_turnout_rates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot implied turnout rates by demographic bracket — plot_turnout_rates","text":"result interpElections_result object. type Character. \"bracket\" (boxplot), \"map\", \"histogram\". Default: \"bracket\". summary_fn Summary map mode. Default: \"mean\". ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_turnout_rates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot implied turnout rates by demographic bracket — plot_turnout_rates","text":"ggplot object (invisibly).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_weights.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot weight matrix diagnostics — plot_weights","title":"Plot weight matrix diagnostics — plot_weights","text":"Produces choropleth maps weight matrix properties: entropy (effective number sources), dominant station assignment, catchment view showing weight distribution specific tract.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_weights.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot weight matrix diagnostics — plot_weights","text":"","code":"plot_weights(   result,   tract = NULL,   type = c(\"catchment\", \"dominant\", \"entropy\"),   top_k = 5L,   threshold = 0.01,   palette = \"YlOrRd\",   breaks = \"quantile\",   n_breaks = 5L,   interactive = FALSE,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/plot_weights.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot weight matrix diagnostics — plot_weights","text":"result interpElections_result object. tract Tract ID index catchment mode. NULL overview. type Character. \"catchment\", \"dominant\", \"entropy\". top_k Integer. Max stations show catchment. threshold Numeric. Min weight show connection. palette Color palette. breaks Break method. n_breaks Number breaks. interactive Logical. Use leaflet instead ggplot2. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/plot_weights.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot weight matrix diagnostics — plot_weights","text":"ggplot object (invisibly).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/print.interpElections_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for interpElections_diagnostics — print.interpElections_diagnostics","title":"Print method for interpElections_diagnostics — print.interpElections_diagnostics","text":"Print method interpElections_diagnostics","code":""},{"path":"https://antrologos.github.io/interpElections/reference/print.interpElections_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for interpElections_diagnostics — print.interpElections_diagnostics","text":"","code":"# S3 method for class 'interpElections_diagnostics' print(x, ...)"},{"path":"https://antrologos.github.io/interpElections/reference/print.interpElections_diagnostics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for interpElections_diagnostics — print.interpElections_diagnostics","text":"x interpElections_diagnostics object. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/reinterpolate.html","id":null,"dir":"Reference","previous_headings":"","what":"Re-interpolate with different electoral variables — reinterpolate","title":"Re-interpolate with different electoral variables — reinterpolate","text":"Takes previous interpolate_election_br() result re-runs interpolation pipeline using stored travel time matrix, skipping expensive routing step. Useful switching different candidates, parties, types, election rounds without recomputing travel times.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/reinterpolate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Re-interpolate with different electoral variables — reinterpolate","text":"","code":"reinterpolate(   result,   what = NULL,   candidates = NULL,   parties = NULL,   cargo = NULL,   turno = NULL,   optim = optim_control(),   keep = NULL,   verbose = TRUE,   ... )"},{"path":"https://antrologos.github.io/interpElections/reference/reinterpolate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Re-interpolate with different electoral variables — reinterpolate","text":"result interpElections_result object interpolate_election_br(). Character vector. Controls information interpolated. See interpolate_election_br(). NULL (default), reuses original. candidates Character numeric vector, NULL. Filter candidates. See interpolate_election_br(). parties Character vector NULL. Filter parties. See interpolate_election_br(). cargo Integer, character, NULL. Override electoral office. See interpolate_election_br(). turno Integer NULL. Override election round (1 2). optim optim_control() object optimization parameters. Default: optim_control(). keep Character vector NULL. Heavy objects include result. See interpolate_election_br(). verbose Logical. Print progress messages. Default: TRUE. ... Additional arguments forwarded interpolate_election_br().","code":""},{"path":"https://antrologos.github.io/interpElections/reference/reinterpolate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Re-interpolate with different electoral variables — reinterpolate","text":"interpElections_result object (structure original, updated interpolation).","code":""},{"path":"https://antrologos.github.io/interpElections/reference/reinterpolate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Re-interpolate with different electoral variables — reinterpolate","text":"previous result must contain time_matrix (always kept default since v0.2). Note: Alpha re-optimized (can take minutes). travel-time computation skipped.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/reinterpolate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Re-interpolate with different electoral variables — reinterpolate","text":"","code":"if (FALSE) { # \\dontrun{ # First run (time_matrix is kept by default) result <- interpolate_election_br(   3550308, 2022,   cargo = \"presidente\" )  # Re-interpolate for parties instead of candidates result2 <- reinterpolate(result, what = \"parties\")  # Re-interpolate for a different cargo result3 <- reinterpolate(result, cargo = \"governador\")  # Re-interpolate for turno 2 (runoff) result4 <- reinterpolate(result, turno = 2) } # }"},{"path":"https://antrologos.github.io/interpElections/reference/residuals.interpElections_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute calibration residuals — residuals.interpElections_result","title":"Compute calibration residuals — residuals.interpElections_result","text":"Returns matrix calibration residuals (fitted minus observed) census tract calibration bracket. weight matrix travel time matrix kept default.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/residuals.interpElections_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute calibration residuals — residuals.interpElections_result","text":"","code":"# S3 method for class 'interpElections_result' residuals(object, ...)"},{"path":"https://antrologos.github.io/interpElections/reference/residuals.interpElections_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute calibration residuals — residuals.interpElections_result","text":"object interpElections_result object. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/residuals.interpElections_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute calibration residuals — residuals.interpElections_result","text":"Numeric matrix [n x k] residuals (fitted - observed), k number calibration brackets. Returns NULL (message) required data available.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/residual_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Tabular residual summary — residual_summary","title":"Tabular residual summary — residual_summary","text":"Computes per-bracket, per-tract, overall residual summary statistics.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/residual_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tabular residual summary — residual_summary","text":"","code":"residual_summary(result, type = c(\"raw\", \"pearson\", \"deviance\"))"},{"path":"https://antrologos.github.io/interpElections/reference/residual_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tabular residual summary — residual_summary","text":"result interpElections_result object. type Residual type: \"raw\", \"pearson\", \"deviance\".","code":""},{"path":"https://antrologos.github.io/interpElections/reference/residual_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tabular residual summary — residual_summary","text":"list three elements: per_bracket Data frame columns: bracket, mean, rmse, max_abs, pct_gt_2sd. per_tract Data frame columns: tract_id, mean, rmse, worst_bracket. overall List rmse, mean_bias, total_deviance.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/routing_control.html","id":null,"dir":"Reference","previous_headings":"","what":"Routing control parameters — routing_control","title":"Routing control parameters — routing_control","text":"Creates control object travel-time computation compute_travel_times(). parameters sensible defaults; override need.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/routing_control.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Routing control parameters — routing_control","text":"","code":"routing_control(   mode = \"WALK\",   point_method = \"pop_weighted\",   min_area_for_pop_weight = 1,   max_trip_duration = 300L,   n_threads = 4L,   gtfs_zip_path = NULL,   departure_datetime = NULL,   pop_raster = NULL,   osm_buffer_km = 10,   fill_missing = NULL )"},{"path":"https://antrologos.github.io/interpElections/reference/routing_control.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Routing control parameters — routing_control","text":"mode Character. Routing mode, using r5r convention: \"WALK\" (default), \"BICYCLE\", \"CAR\", \"TRANSIT\", combinations like c(\"WALK\", \"TRANSIT\"). Passed directly r5r::travel_time_matrix(). point_method Character. Method computing representative points census tracts. One \"pop_weighted\" (default, uses WorldPop raster), \"point_on_surface\", \"centroid\". See compute_representative_points(). min_area_for_pop_weight Numeric. Minimum tract area km2 applying pop_weighted method. Smaller tracts fall back point_on_surface. Default: 1. max_trip_duration Integer. Maximum trip duration minutes. Also used fill value unreachable pairs (unless fill_missing set). Default: 300 (5 hours walking). n_threads Integer. Number parallel threads r5r routing engine. Default: 4. gtfs_zip_path Character NULL. Path GTFS .zip file transit routing. Copied network directory r5r can auto-detect . Default: NULL. departure_datetime POSIXct NULL. Departure time transit-based routing. Required mode includes transit. Default: NULL. pop_raster terra::SpatRaster, file path GeoTIFF, NULL. Population raster point_method = \"pop_weighted\". NULL, WorldPop data auto-downloaded. Default: NULL. osm_buffer_km Numeric. Buffer km around combined bounding box tracts points clipping OSM data. Default: 10. fill_missing Numeric NULL. Value unreachable OD pairs. NULL (default) uses max_trip_duration.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/routing_control.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Routing control parameters — routing_control","text":"list class \"interpElections_routing_control\" one element per parameter.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/routing_control.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Routing control parameters — routing_control","text":"","code":"# Default settings (walking, 5h max) routing_control() #> interpElections routing control: #>   mode: WALK  #>   point_method: pop_weighted  #>   min_area_for_pop_weight: 1  #>   max_trip_duration: 300 min #>   n_threads: 4  #>   gtfs_zip_path: NULL  #>   departure_datetime: NULL  #>   pop_raster: NULL (auto-download)  #>   osm_buffer_km: 10  #>   fill_missing: 300   # Transit mode with GTFS routing_control(   mode = c(\"WALK\", \"TRANSIT\"),   gtfs_zip_path = \"sptrans.zip\",   departure_datetime = as.POSIXct(\"2022-10-02 10:00:00\") ) #> interpElections routing control: #>   mode: WALK;TRANSIT  #>   point_method: pop_weighted  #>   min_area_for_pop_weight: 1  #>   max_trip_duration: 300 min #>   n_threads: 4  #>   gtfs_zip_path: sptrans.zip  #>   departure_datetime: 2022-10-02 10:00:00  #>   pop_raster: NULL (auto-download)  #>   osm_buffer_km: 10  #>   fill_missing: 300   # Bicycle with centroid-based points routing_control(mode = \"BICYCLE\", point_method = \"centroid\") #> interpElections routing control: #>   mode: BICYCLE  #>   point_method: centroid  #>   min_area_for_pop_weight: 1  #>   max_trip_duration: 300 min #>   n_threads: 4  #>   gtfs_zip_path: NULL  #>   departure_datetime: NULL  #>   pop_raster: NULL (auto-download)  #>   osm_buffer_km: 10  #>   fill_missing: 300"},{"path":"https://antrologos.github.io/interpElections/reference/setup_java.html","id":null,"dir":"Reference","previous_headings":"","what":"Download and configure Java 21 for r5r — setup_java","title":"Download and configure Java 21 for r5r — setup_java","text":"One-call setup detects existing Java installations, downloads JDK 21 needed, configures environment variables R session OS level, optionally installs configures rJava, verifies setup.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/setup_java.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download and configure Java 21 for r5r — setup_java","text":"","code":"setup_java(   install_dir = file.path(tools::R_user_dir(\"interpElections\", \"data\"), \"java\"),   persist = interactive(),   setup_rjava = TRUE,   verbose = TRUE )"},{"path":"https://antrologos.github.io/interpElections/reference/setup_java.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download and configure Java 21 for r5r — setup_java","text":"install_dir Character. install Java downloading. Default uses tools::R_user_dir(). persist Logical. Write JAVA_HOME ~/.Renviron set OS-level environment variables. Default: TRUE interactive sessions. setup_rjava Logical. Whether install/configure rJava. Default: TRUE. verbose Logical. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/setup_java.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download and configure Java 21 for r5r — setup_java","text":"Invisibly, path JDK home directory.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/setup_java.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Download and configure Java 21 for r5r — setup_java","text":"function performs following steps: Scans existing Java installations system Warns non-Java-21 versions may conflict Uses existing Java 21 found, downloads Adoptium JDK 21 Configures JAVA_HOME PATH current R session Persists JAVA_HOME ~/.Renviron Sets JAVA_HOME OS level (Windows User env / shell config) Adds JDK bin/ system PATH Optionally installs configures rJava Runs final verification Even Java 21 already installed, calling setup_java() ensures configuration (env vars, PATH, rJava) correctly wired . function idempotent: can always call fix broken configuration without re-downloading.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/setup_java.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download and configure Java 21 for r5r — setup_java","text":"","code":"if (FALSE) { # \\dontrun{ setup_java() setup_java(setup_rjava = FALSE) } # }"},{"path":"https://antrologos.github.io/interpElections/reference/setup_osmium.html","id":null,"dir":"Reference","previous_headings":"","what":"Install osmium-tool for OSM file clipping — setup_osmium","title":"Install osmium-tool for OSM file clipping — setup_osmium","text":"Attempts install osmium-tool (osmconvert fallback) using system package manager. required clip large state-level OSM extracts municipality-level bounding boxes r5r routing.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/setup_osmium.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Install osmium-tool for OSM file clipping — setup_osmium","text":"","code":"setup_osmium(method = NULL, verbose = TRUE)"},{"path":"https://antrologos.github.io/interpElections/reference/setup_osmium.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Install osmium-tool for OSM file clipping — setup_osmium","text":"method Character NULL. Installation method use. NULL (default), auto-detects. Options: \"conda\": conda install (platforms) \"brew\": Homebrew (macOS) \"apt\": apt-get (Debian/Ubuntu) \"dnf\": dnf (Fedora/RHEL) \"download\": Download osmconvert binary (Windows ) verbose Logical. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/setup_osmium.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Install osmium-tool for OSM file clipping — setup_osmium","text":"Invisibly, path installed tool, NULL installation failed.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/setup_osmium.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Install osmium-tool for OSM file clipping — setup_osmium","text":"preferred tool osmium-tool, faster reliable. osmconvert used fallback osmium available. Windows, \"download\" method fetches pre-compiled osmconvert.exe binary saves interpElections cache. require conda package manager.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/setup_osmium.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Install osmium-tool for OSM file clipping — setup_osmium","text":"","code":"if (FALSE) { # \\dontrun{ setup_osmium() setup_osmium(method = \"conda\") setup_osmium(method = \"download\")  # Windows only } # }"},{"path":"https://antrologos.github.io/interpElections/reference/setup_torch.html","id":null,"dir":"Reference","previous_headings":"","what":"Install and configure torch with GPU support — setup_torch","title":"Install and configure torch with GPU support — setup_torch","text":"Installs torch R package (missing) downloads platform-appropriate libtorch + lantern binaries GPU support. installation, verifies GPU acceleration works via check_torch().","code":""},{"path":"https://antrologos.github.io/interpElections/reference/setup_torch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Install and configure torch with GPU support — setup_torch","text":"","code":"setup_torch(reinstall = FALSE, type = NULL, verbose = TRUE)"},{"path":"https://antrologos.github.io/interpElections/reference/setup_torch.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Install and configure torch with GPU support — setup_torch","text":"reinstall Logical. Force re-download libtorch/lantern binaries even already exist. Use fix broken CUDA installations (e.g., CPU-lantern accidentally installed). Default: FALSE. type Character NULL. Installation type, passed torch::install_torch(). Common values: NULL (auto-detect), \"cuda\" (force CUDA Windows/Linux), \"cpu\" (force CPU-). Default: NULL (auto-detect based available GPU). verbose Logical. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/setup_torch.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Install and configure torch with GPU support — setup_torch","text":"Invisibly, result check_torch() installation, partial list needs_restart = TRUE R must restarted.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/setup_torch.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Install and configure torch with GPU support — setup_torch","text":"installation proceeds stages: torch R package installed, installed CRAN. torch::install_torch() downloads libtorch lantern binaries. Windows/Linux NVIDIA GPU CUDA toolkit, automatically selects CUDA-enabled binaries. verification step runs check_torch() confirm GPU works. Important: torch package already loaded current R session calling setup_torch(), must restart R new binaries take effect. function detects warns accordingly.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/setup_torch.html","id":"cuda-auto-detection","dir":"Reference","previous_headings":"","what":"CUDA auto-detection","title":"Install and configure torch with GPU support — setup_torch","text":"torch::install_torch() detects CUDA version : CUDA environment variable (set, forces version) CUDA_PATH (Windows) CUDA_HOME (Linux) nvcc --version PATH","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/setup_torch.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Install and configure torch with GPU support — setup_torch","text":"","code":"if (FALSE) { # \\dontrun{ setup_torch()                    # auto-detect GPU setup_torch(type = \"cuda\")       # force CUDA setup_torch(reinstall = TRUE)    # fix broken install } # }"},{"path":"https://antrologos.github.io/interpElections/reference/set_interpElections_cache_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Set a custom interpElections cache directory — set_interpElections_cache_dir","title":"Set a custom interpElections cache directory — set_interpElections_cache_dir","text":"Persists custom cache directory path across R sessions. path NULL, resets default OS-appropriate location.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/set_interpElections_cache_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set a custom interpElections cache directory — set_interpElections_cache_dir","text":"","code":"set_interpElections_cache_dir(path = NULL, verbose = TRUE)"},{"path":"https://antrologos.github.io/interpElections/reference/set_interpElections_cache_dir.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set a custom interpElections cache directory — set_interpElections_cache_dir","text":"path Character NULL. Directory path cached files. Created exist. NULL resets default. verbose Logical. Print confirmation. Default: TRUE.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/set_interpElections_cache_dir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set a custom interpElections cache directory — set_interpElections_cache_dir","text":"Invisibly returns cache directory path.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/set_java_memory.html","id":null,"dir":"Reference","previous_headings":"","what":"Set Java heap memory for r5r — set_java_memory","title":"Set Java heap memory for r5r — set_java_memory","text":"Configures maximum heap size Java Virtual Machine used r5r. Large travel-time matrices can require several gigabytes JVM heap.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/set_java_memory.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Set Java heap memory for r5r — set_java_memory","text":"","code":"set_java_memory(size, persist = interactive())"},{"path":"https://antrologos.github.io/interpElections/reference/set_java_memory.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Set Java heap memory for r5r — set_java_memory","text":"size Character. Memory size unit suffix, e.g. \"4g\" 4 GB, \"512m\" 512 MB, \"8g\" 8 GB. persist Logical. Also write ~/.Renviron setting persists across R sessions. Default: TRUE interactive sessions.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/set_java_memory.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Set Java heap memory for r5r — set_java_memory","text":"Invisibly, previous value getOption(\"java.parameters\").","code":""},{"path":"https://antrologos.github.io/interpElections/reference/set_java_memory.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Set Java heap memory for r5r — set_java_memory","text":"sets options(java.parameters = \"-Xmx{size}\"). must called r5r (rJava) loaded — JVM starts, heap size changed without restarting R. rule thumb: allocate \\(\\ge 2\\) GB per million OD pairs expect travel-time matrix. municipality 5,000 census tracts 200 polling locations, 1 million pairs — 2-4 GB usually enough. Larger cities (e.g. Sao Paulo) may need 8-16 GB.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/set_java_memory.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Set Java heap memory for r5r — set_java_memory","text":"","code":"if (FALSE) { # \\dontrun{ set_java_memory(\"4g\") set_java_memory(\"8g\", persist = TRUE) } # }"},{"path":"https://antrologos.github.io/interpElections/reference/summary.interpElections_result.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize an interpElections result — summary.interpElections_result","title":"Summarize an interpElections result — summary.interpElections_result","text":"Prints detailed summary including calibration information, optimization details, per-variable statistics.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/summary.interpElections_result.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize an interpElections result — summary.interpElections_result","text":"","code":"# S3 method for class 'interpElections_result' summary(object, ...)"},{"path":"https://antrologos.github.io/interpElections/reference/summary.interpElections_result.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize an interpElections result — summary.interpElections_result","text":"object interpElections_result object. ... Ignored.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/summary.interpElections_result.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize an interpElections result — summary.interpElections_result","text":"Invisibly returns object.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/use_gpu.html","id":null,"dir":"Reference","previous_headings":"","what":"Enable or disable GPU acceleration — use_gpu","title":"Enable or disable GPU acceleration — use_gpu","text":"Sets package-wide options controlling whether optimize_alpha() uses GPU-accelerated optimization (PB-SGD) CPU-methods.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/use_gpu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Enable or disable GPU acceleration — use_gpu","text":"","code":"use_gpu(enable = TRUE, device = NULL, dtype = \"float32\")"},{"path":"https://antrologos.github.io/interpElections/reference/use_gpu.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Enable or disable GPU acceleration — use_gpu","text":"enable Logical. TRUE enable GPU, FALSE CPU . device Character NULL. Torch device: \"cuda\", \"mps\", \"cpu\". NULL = auto-detect. dtype Character. \"float32\" \"float64\". Default: \"float32\".","code":""},{"path":"https://antrologos.github.io/interpElections/reference/use_gpu.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Enable or disable GPU acceleration — use_gpu","text":"Invisibly returns previous settings list.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/use_gpu.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Enable or disable GPU acceleration — use_gpu","text":"GPU enabled, optimize_alpha() uses torch-based PB-SGD (per-bracket stochastic gradient descent). requires torch package installed working GPU backend (CUDA NVIDIA, MPS Apple Silicon). per-call use_gpu parameter optimize_alpha() always overrides global setting.","code":""},{"path":[]},{"path":"https://antrologos.github.io/interpElections/reference/use_gpu.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Enable or disable GPU acceleration — use_gpu","text":"","code":"use_gpu(FALSE) # ensure CPU mode #> GPU disabled. Using CPU optimization."},{"path":"https://antrologos.github.io/interpElections/reference/weight_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize weight matrix properties per tract — weight_summary","title":"Summarize weight matrix properties per tract — weight_summary","text":"Computes per-tract statistics weight matrix, including concentration measures (Herfindahl, entropy), effective number sources, optionally travel-time-weighted means.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/weight_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize weight matrix properties per tract — weight_summary","text":"","code":"weight_summary(result)"},{"path":"https://antrologos.github.io/interpElections/reference/weight_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize weight matrix properties per tract — weight_summary","text":"result interpElections_result object.","code":""},{"path":"https://antrologos.github.io/interpElections/reference/weight_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize weight matrix properties per tract — weight_summary","text":"data frame one row per tract.","code":""}]
